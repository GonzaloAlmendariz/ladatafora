{
  "hash": "3598047f90b689ae84a85d9e5ca70d8d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Manual de Aplicación del Paquete INCORER\"\nsubtitle: \"Índice de Competitividad Regional (IPE)\"\nauthor: \"Gonzalo Almendariz Villanueva\"\nlang: es\n\nformat:\n  html:\n    toc: true\n    toc-depth: 2\n    number-sections: true\n    fig-width: 10\n    fig-height: 8\n\nwarning: false\n---\n\n\n\n\n\\newpage\n\n# Introducción\n\nEl **Índice de Competitividad Regional (INCORE)**, elaborado por el Instituto Peruano de Economía (IPE), surge como una herramienta para comprender cómo distintos pilares (económicos, sociales e institucionales) interactúan en un proceso dinámico que busca elevar el bienestar de la población. El índice parte de la premisa de que la competitividad regional es un **círculo virtuoso**: el fortalecimiento de las capacidades de las regiones mejora la productividad, lo que incrementa los estándares de vida y, a su vez, refuerza dichas capacidades en el tiempo.\n\nEn ese marco, el INCORE organiza información heterogénea en una escala común de 0 a 10, permitiendo comparar regiones y evaluar la relación de la competitividad con variables clave como el producto per cápita o la pobreza monetaria. Esta mirada integra el desempeño económico, la calidad de las instituciones, el acceso a infraestructura, la salud y educación, entre otros factores.\n\nEl paquete **INCOREr** no está afiliado institucionalmente al IPE, pero surge inspirado en esta iniciativa. Su desarrollo responde a la necesidad de contar con una herramienta práctica en R que facilite **integrar, manipular y explorar la base de datos oficial del INCORE** sin depender de procesos manuales. Así, académicos, estudiantes e investigadores pueden trabajar con los resultados de manera reproducible, confiable y flexible, incorporándolos directamente en sus flujos de análisis cuantitativo o en la construcción de reportes dinámicos.\n\nEl paquete busca ser una **interfaz activa** entre la información publicada por el IPE y las necesidades de la investigación aplicada. Esto se traduce en funciones que estandarizan la lectura de archivos, permiten filtrar por ediciones, pilares o indicadores, y ofrecen salidas listas para ser graficadas o tabuladas. Asimismo, el paquete organiza las diferentes unidades de medida, diferencia puntajes estandarizados de valores originales y provee utilitarios que simplifican tareas comunes como la selección de regiones, la comparación temporal o la exportación de resultados.\n\nEn esencia, el paquete organiza toda la información del INCORE, ediciones, pilares, indicadores, regiones y unidades, en funciones que permiten:\n\n1.  **Importar y estructurar datos**\n    -   `leer_incore()`: lee la base central del índice para una edición específica.\\\n    -   `leer_total()`: carga la base completa con todas las ediciones y valores originales.\\\n        Estas funciones devuelven los datos en formato *tibble*, listos para ser procesados en R.\n2.  **Navegar catálogos**\n    -   Funciones como `catalogo_regiones()`, `catalogo_pilar()`, `catalogo_indicador()` y `catalogo_unidad()` devuelven los diccionarios oficiales de referencia, permitiendo traducir entre nombres y códigos.\n3.  **Explorar resultados generales**\n    -   La familia `general_` genera gráficos y tablas del índice en su dimensión más agregada: el **puntaje general por región** o el **general de cada pilar**.\\\n        Ejemplos: `general_tabla()`, `general_barras()`, `general_mapa()`.\n4.  **Analizar indicadores específicos (puntajes)**\n    -   La familia `indc_` trabaja con los indicadores estandarizados a escala 0–10.\\\n        Incluye funciones para dispersión (`indc_dispersion()`), distribución (`indc_distribucion()`), evolución temporal (`indc_largo()`), entre otras.\n5.  **Analizar valores originales**\n    -   La familia `valor_` conserva las unidades originales de cada indicador (porcentaje, número, soles, etc.).\\\n        Esto permite ver los valores “crudos” de los indicadores sin estandarización, útil para interpretación sectorial y comunicación técnica.\\\n        Ejemplos: `valor_dispersion()`, `valor_distribucion()`, `multivalor_ridgeline()`.\n6.  **Comparaciones bivariadas**\n    -   La familia `bivalor_` explora relaciones entre indicadores, mostrando correlaciones, comparaciones y dispersión en pares de variables.\n\nEn conjunto, el paquete busca **integrar datos, catálogos y visualizaciones** en una misma interfaz, de modo que los usuarios puedan pasar sin fricción desde una tabla exploratoria hasta un gráfico final para informes.\n\nLa estructura modular (general\\_, indc\\_, valor\\_, bivalor\\_) facilita entender qué tipo de dato se está utilizando (puntajes normalizados vs valores originales) y qué nivel de análisis corresponde (agregado vs detallado).\n\nEl paquete **INCORE** permite a investigadores, analistas de política y comunicadores disponer de un ecosistema completo para trabajar con el índice, asegurando rigor en los filtros y claridad en las visualizaciones.\n\nEs importante señalar que el paquete INCOREr se encuentra aún en desarrollo. Existen varias funciones por ampliar, funcionalidades que pueden optimizarse y definiciones de grupos regionales que requieren mayor precisión. El aporte de quienes utilicen esta herramienta es fundamental: la retroalimentación continua permitirá refinarla, expandir sus capacidades y consolidarla como un recurso de referencia para trabajar con los datos del INCORE en R.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(incorer)\nlibrary(dplyr)\n```\n:::\n\n\n\n\n# Lectura de los datos\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = leer_incore()\n\ndata |>\n  select(edicion, pilar, region, valor) |>\n  head(10) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n   edicion pilar                                  region       valor\n     <int> <chr>                                  <chr>        <dbl>\n 1    2025 Índice de Competitividad Regional 2025 Amazonas      4.31\n 2    2025 Índice de Competitividad Regional 2025 Áncash        5.40\n 3    2025 Índice de Competitividad Regional 2025 Apurímac      5.10\n 4    2025 Índice de Competitividad Regional 2025 Arequipa      6.91\n 5    2025 Índice de Competitividad Regional 2025 Ayacucho      4.85\n 6    2025 Índice de Competitividad Regional 2025 Cajamarca     4.38\n 7    2025 Índice de Competitividad Regional 2025 Cusco         5.76\n 8    2025 Índice de Competitividad Regional 2025 Huancavelica  4.82\n 9    2025 Índice de Competitividad Regional 2025 Huánuco       4.37\n10    2025 Índice de Competitividad Regional 2025 Ica           6.37\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_19 = leer_incore(edicion = 2019)\n\ndata_19 |>\n  select(edicion, pilar, region, valor) |>\n  head(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n   edicion pilar                                  region       valor\n     <int> <chr>                                  <chr>        <dbl>\n 1    2019 Índice de Competitividad Regional 2019 Amazonas      3.78\n 2    2019 Índice de Competitividad Regional 2019 Áncash        4.73\n 3    2019 Índice de Competitividad Regional 2019 Apurímac      4.31\n 4    2019 Índice de Competitividad Regional 2019 Arequipa      6.82\n 5    2019 Índice de Competitividad Regional 2019 Ayacucho      4.31\n 6    2019 Índice de Competitividad Regional 2019 Cajamarca     3.60\n 7    2019 Índice de Competitividad Regional 2019 Cusco         5.18\n 8    2019 Índice de Competitividad Regional 2019 Huancavelica  3.52\n 9    2019 Índice de Competitividad Regional 2019 Huánuco       3.62\n10    2019 Índice de Competitividad Regional 2019 Ica           6.16\n```\n\n\n:::\n:::\n\n\n\n\n# Catálogos\n\nLos catálogos son funciones auxiliares que devuelven diccionarios con las entidades clave del INCORE: regiones, pilares, indicadores y unidades.\\\nSirven para validar insumos, traducir entre códigos y nombres, y facilitar filtros consistentes en los gráficos y tablas.\n\n## catalogo_regiones\n\nDevuelve la lista oficial de las 25 regiones más la entrada \"Perú\".\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(catalogo_region())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  codigo nombre   \n  <chr>  <chr>    \n1 AMZ    Amazonas \n2 ANC    Áncash   \n3 APC    Apurímac \n4 AQP    Arequipa \n5 AYA    Ayacucho \n6 CJM    Cajamarca\n```\n\n\n:::\n:::\n\n\n\n\n## catalogo_pilar\n\nDevuelve los seis pilares que conforman el INCORE:\n\n-   Entorno Económico\n\n-   Laboral\n\n-   Infraestructura\n\n-   Salud\n\n-   Educación\n\n-   Instituciones\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatalogo_pilar()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n  codigo nombre                           \n  <chr>  <chr>                            \n1 GEN    Índice de Competitividad Regional\n2 ECO    Entorno económico                \n3 LAB    Laboral                          \n4 INF    Infraestructura                  \n5 SAL    Salud                            \n6 EDU    Educación                        \n7 INS    Instituciones                    \n```\n\n\n:::\n:::\n\n\n\n\n## catalogo_indicador\n\nLista todos los indicadores que forman parte de cada pilar, con su código (p.ej. LAB1, SAL4).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(catalogo_indicador())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  codigo nombre                                                        \n  <chr>  <chr>                                                         \n1 GEN    General                                                       \n2 ECO1   1.1 PBI real en logaritmos                                    \n3 ECO2   1.2 Trabajadores en grandes empresas (más de 100 trabajadores)\n4 ECO3   1.3 Gasto real pre cápita mensual                             \n5 ECO4   1.4 Apertura externa                                          \n6 ECO5   1.5 Tenencia de cuentas                                       \n```\n\n\n:::\n:::\n\n\n\n\n# Familia `_general`\n\nLa familia de funciones `general_` trabaja con el **nivel más agregado del INCORE**: el **puntaje general por región**, ya sea para el índice total o para el *general* de un pilar.\n\nEstas funciones son útiles para tener una **visión panorámica de la competitividad regional**, explorando tanto comparaciones en una sola edición como tendencias a lo largo del tiempo.\n\nEn concreto, permiten:\n\n-   **Tablas** (`general_tabla`): ver los puntajes generales en formato tabular, con opción a mostrar en estilo `gt`.\\\n-   **Gráficos de barras** (`general_barras`): comparar regiones en un año específico.\\\n-   **Dispersión entre pilares** (`general_dispersion_pilares`): analizar cómo se relacionan los puntajes generales de distintos pilares.\\\n-   **Distribución** (`general_distribucion`): mostrar la variabilidad de los puntajes generales entre regiones, con boxplots o violines.\\\n-   **Heatmaps** (`general_heatmap`): seguir la evolución de regiones y ediciones en formato de mapa de calor.\\\n-   **Series largas** (`general_largo`): observar la trayectoria de regiones o pilares a lo largo de varias ediciones.\\\n-   **Mapas geográficos** (`general_mapa`): representar en el territorio los puntajes generales por región.\\\n-   **Comparación con el promedio** (`general_media`): contrastar regiones con el promedio nacional o de un grupo seleccionado.\\\n-   **Gráficos radar** (`general_radar`): comparar varias regiones de manera simultánea en forma de radar.\n\n## **general_tabla()**\n\n**Puntaje General por región con ediciones en columnas**\n\nEsta función es la primera de la familia de utilidades general\\_\\* y su objetivo es **construir una tabla “ancha”** con el **puntaje General (0–10)** del INCORE. Las **filas** corresponden a **regiones** y las **columnas** a las **ediciones** solicitadas, con encabezados del tipo puntaje_YYYY. Internamente, filtra únicamente las filas cuyo pilar **empieza** con *“Índice de Competitividad Regional”* (es decir, el índice de portada) y, por diseño, **excluye** la fila “Perú” salvo que se indique lo contrario.\n\n### **Introducción**\n\n`general_tabla()` resuelve una necesidad frecuente en análisis y reporte: **comparar de forma compacta** el desempeño general por **región** a través de **una o varias ediciones**. Frente a un gráfico, la tabla facilita **exportaciones**, **validaciones cruzadas** y **anexos metodológicos**. Además, puede devolver un objeto tibble listo para **manipulación** posterior o, si se solicita, formatear una **tabla gt** con encabezados pulidos para su uso directo en informes y documentos.\n\nLos argumentos usar_codigos e incluir_peru cumplen funciones operativas: el primero armoniza **códigos/nombres** de región antes de filtrar y el segundo decide si se **incluye** la fila “Perú” (promedio nacional). Salvo que tu salida requiera explícitamente a “Perú”, es razonable mantener el valor por defecto (excluido) para centrar la lectura en las **regiones**.\n\n### **Parámetros**\n\nA la hora de utilizar general_tabla(), las decisiones principales son: (i) qué **ediciones** se desean en columnas, (ii) qué **universo de regiones** se incluye (todas, subconjuntos o grupos), y (iii) si la salida debe ser **tibble** (para análisis) o **gt** (para presentación).\n\n-   **ediciones**: determina las **columnas** de la tabla (una o varias ediciones).\n\n    Opciones y formato:\n\n    -   2019:2025 (rango continuo)\n\n    -   c(2018, 2020, 2023, 2025) (conjunto específico)\n\n    -   2025 (una sola edición)\n\n    -   Reglas defensivas: valores dentro de 2016 … 2025\n\n-   **regiones**: controla el **universo** de filas (regiones) a incluir.\n\n    Opciones y formato:\n\n    -   \"ALL\" (por defecto, todas las regiones)\n\n    -   c(\"Arequipa\", \"Cusco\") (por nombre)\n\n    -   c(\"ARE\", \"CUS\") (por código)\n\n    -   **Grupos** \"gr_costa\", \"gr_sierra\", \"gr_selva\" (cuando están disponibles en tu ecosistema)\n\n    -   **Exclusiones** por patrón: \"-Lima\\*\"\n\n    -   Combinaciones: c(\"gr_costa\", \"La Libertad\", \"-Lima\\*\")\n\n-   **gt**: define el **tipo de salida**.\n\n    Opciones y formato:\n\n    -   FALSE (por defecto) ⇒ devuelve un tibble\n\n    -   TRUE ⇒ devuelve un objeto gt con encabezados tipo “Puntaje 2025”, etc.\n\n### **Explicación conceptual**\n\nLa función **lee** las ediciones indicadas, **filtra** únicamente el **índice general de portada** (filas cuyo pilar comienza con *“Índice de Competitividad Regional”*), **incluye o excluye** la fila “Perú” según se solicite y **aplica** el filtrado de regiones con soporte para **grupos** y **exclusiones**.\n\nLuego **prepara** un único valor por combinación region–edicion (redondeo defensivo) y **pivotea** a formato ancho con nombres de columna puntaje_YYYY. En caso de valores duplicados, utiliza una **media** defensiva para consolidar. La salida final es un **tibble** ordenado (por región) o una **tabla gt** con encabezados legibles y formato numérico a **dos decimales**.\n\n### **Ejemplos**\n\n> Se asume el paquete cargado y las dependencias disponibles. Los ejemplos exploran **funcionalidades propias del paquete**: grupos gr\\_\\*, exclusiones por patrón, control de la fila “Perú” y salida gt.\n\n#### Tabla simple para una edición (tibble por defecto)\n\n**Se desea lo siguiente:** obtener la tabla del **puntaje General** por región para la edición 2025, en formato **tibble**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab1 <- general_tabla(\n  ediciones = 2025,\n  regiones  = \"ALL\",\n  gt        = FALSE\n)\ntab1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 2\n   region       puntaje_2025\n   <chr>               <dbl>\n 1 Amazonas             4.31\n 2 Apurímac             5.1 \n 3 Arequipa             6.91\n 4 Ayacucho             4.85\n 5 Cajamarca            4.38\n 6 Cusco                5.76\n 7 Huancavelica         4.82\n 8 Huánuco              4.37\n 9 Ica                  6.37\n10 Junín                5.22\n# ℹ 15 more rows\n```\n\n\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un tibble con columnas region y puntaje_2025, filas ordenadas alfabéticamente, **sin** la fila “Perú” (por defecto).\n\n#### Varias ediciones (2022–2025) y subconjunto por grupo costero\n\n**Se desea lo siguiente:** comparar el bloque **costero** a través de varias ediciones, manteniendo salida en tibble.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab2 <- general_tabla(\n  ediciones = 2022:2025,\n  regiones  = \"gr_costa\",\n  gt        = FALSE\n)\ntab2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 11 × 5\n   region          puntaje_2022 puntaje_2023 puntaje_2024 puntaje_2025\n   <chr>                  <dbl>        <dbl>        <dbl>        <dbl>\n 1 Arequipa                6.48         6.59         6.63         6.91\n 2 Ica                     5.97         6            6.3          6.37\n 3 La Libertad             5.12         5.02         5.24         5.54\n 4 Lambayeque              4.93         5.02         5.21         5.42\n 5 Lima Provincias         5.31         5.52         5.63         6.02\n 6 Lima*                   6.89         6.81         7.05         7.34\n 7 Moquegua                6.95         7.22         7.37         7.38\n 8 Piura                   4.52         4.39         4.59         4.88\n 9 Tacna                   6.01         6.27         6.29         6.43\n10 Tumbes                  4.9          5.05         4.85         5.05\n11 Áncash                  4.89         4.93         5.23         5.4 \n```\n\n\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un tibble con columnas puntaje_2022, …, puntaje_2025 solo para las regiones incluidas en gr_costa, útil para análisis de tendencia tabular.\n\n#### Inclusión de “Perú” y un patrón (costa)\n\n**Se desea lo siguiente:** mostrar el **promedio nacional** en la tabla.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab3 <- general_tabla(\n  ediciones    = 2020:2025,\n  regiones     = c(\"gr_costa\", \"Perú\"),\n  incluir_peru = TRUE,\n  gt           = FALSE\n)\ntab3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 × 7\n   region       puntaje_2020 puntaje_2021 puntaje_2022 puntaje_2023 puntaje_2024\n   <chr>               <dbl>        <dbl>        <dbl>        <dbl>        <dbl>\n 1 Arequipa             6.93         6.25         6.48         6.59         6.63\n 2 Ica                  6.52         5.89         5.97         6            6.3 \n 3 La Libertad          5.34         4.94         5.12         5.02         5.24\n 4 Lambayeque           5.31         4.99         4.93         5.02         5.21\n 5 Lima Provin…         5.34         4.99         5.31         5.52         5.63\n 6 Lima*                7.39         6.68         6.89         6.81         7.05\n 7 Moquegua             7.1          6.66         6.95         7.22         7.37\n 8 Perú                 5.03         4.61         4.79         4.77         5.02\n 9 Piura                4.96         4.36         4.52         4.39         4.59\n10 Tacna                6.41         6.09         6.01         6.27         6.29\n11 Tumbes               5.17         4.51         4.9          5.05         4.85\n12 Áncash               5.21         4.73         4.89         4.93         5.23\n# ℹ 1 more variable: puntaje_2025 <dbl>\n```\n\n\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un tibble con la fila “Perú” y las regiones **costeras** excepto las que coincidan con “Lima\\*”. Útil para contrastar **selección** vs. **promedio país**.\n\n#### Salida gt con encabezados legibles (dos ediciones no contiguas)\n\n**Se desea lo siguiente:** producir una **tabla presentable** para un informe, con dos ediciones específicas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab4 <- general_tabla(\n  ediciones = c(2021, 2025),\n  regiones  = \"ALL\",\n  gt        = TRUE\n)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](tabl1.png){fig-align='center' fig-pos='H' width=90%}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un objeto gt con título y subtítulo automáticos, columnas “Puntaje 2021” y “Puntaje 2025” formateadas a **dos decimales**.\n\n#### **5) Conjunto mixto (grupo + regiones explícitas) y salida gt**\n\n**Se desea lo siguiente:** combinar un **grupo** y **regiones puntuales** en una única tabla de varias ediciones, lista para reporte.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab5 <- general_tabla(\n  ediciones = 2019:2025,\n  regiones  = c(\"gr_sierra\", \"Arequipa\", \"La Libertad\"),\n  gt        = TRUE\n)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](obal.png){fig-align='center' fig-pos='H' width=90%}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Una tabla gt con las regiones de gr_sierra **más** Arequipa y La Libertad, y columnas puntaje_2019 … puntaje_2025. Lista para exportar o incorporar en un documento.\n\n## **general_barras()**\n\n**Visualización del puntaje General por región en una edición del INCORE**\n\n### **Introducción**\n\nLa función `general_barras()` ofrece una representación clara y jerárquica de los puntajes del **Índice de Competitividad Regional (INCORE)** en una edición determinada. Su diseño se centra en el formato de **barras horizontales ordenadas de mayor a menor**, lo que facilita identificar de inmediato las regiones que destacan por su competitividad y aquellas que se encuentran rezagadas. Esta función resulta particularmente valiosa cuando se requiere mostrar un panorama sintético y visualmente contundente del ranking regional, ya sea para fines académicos, informes de política pública o presentaciones institucionales.\n\nEn el marco del INCORE, donde cada región obtiene un puntaje entre 0 y 10 , la función permite elegir entre dos aproximaciones: representar el **índice general total**, que resume el desempeño en los seis pilares (Entorno Económico, Laboral, Infraestructura, Salud, Educación e Instituciones), o enfocarse en el **puntaje General de un pilar específico**, con lo cual se resalta una dimensión particular de la competitividad. Esta flexibilidad convierte a general_barras() en una herramienta versátil, adecuada tanto para un primer acercamiento como para análisis más focalizados.\n\n### **Parámetros**\n\nLa utilización de la función descansa en la combinación de algunos argumentos clave. Cada uno de ellos abre distintas posibilidades de análisis:\n\n-   **edicion**: corresponde al año de análisis del INCORE. Debe indicarse un valor único dentro del rango de disponibilidad.\n\n    Opciones:\n\n    -   2016 … 2025\n\n-   **pilar**: define si se grafica el índice general total o el **General** de un pilar específico.\n\n    Opciones:\n\n    -   NULL (por defecto: índice general total)\n\n    -   \"NOMBRE_DEL_PILAR\" (ejemplo: \"Salud\")\n\n    -   \"CODIGO_PILAR\" (ejemplo: \"SAL\")\n\n-   **regiones**: delimita el conjunto de regiones a mostrar. Se aceptan nombres, códigos o grupos predefinidos.\n\n    Opciones:\n\n    -   \"ALL\" (por defecto: todas las regiones)\n\n    -   c(\"REGION1\", \"REGION2\")\n\n    -   c(\"COD1\", \"COD2\")\n\n    -   c(\"gr_norte\", \"gr_sur\")\n\n    -   Combinaciones mixtas (ejemplo: c(\"gr_norte\", \"Lima\", \"La Libertad\"))\n\n-   **paleta**: establece la paleta cualitativa de colores para distinguir regiones.\n\n    Opciones:\n\n    -   \"ipe\" (por defecto, con la gama institucional del paquete)\n\n    -   \"okabe_ito\" (diseñada para accesibilidad visual)\n\n    -   \"viridis\" (escala perceptualmente uniforme, útil con muchas categorías)\n\n-   **mostrar_leyenda**: determina si se incluye la leyenda en el gráfico.\n\n    Opciones:\n\n    -   FALSE (por defecto)\n\n    -   TRUE\n\nLos parámetros **usar_codigos** e **incluir_peru** son auxiliares: el primero asegura que los códigos regionales o de pilar se traduzcan a nombres oficiales, mientras que el segundo permite incluir el promedio nacional de “Perú” como referencia en el gráfico.\n\n### **Explicación conceptual**\n\nEl proceso interno de la función puede describirse en tres fases:\n\n1.  **Preparación de datos.** Se leen los resultados del INCORE para la edición indicada. Dependiendo de la selección de pilar, se filtra el índice general total o el puntaje General de un pilar específico.\n\n2.  **Ajustes y filtros.** Se excluye “Perú” de manera predeterminada (a menos que se indique lo contrario) y se aplica el filtro de regiones, con soporte para grupos predefinidos. Posteriormente, se consolidan los valores y se asegura que cada región tenga un único puntaje.\n\n3.  **Visualización.** Se construye un gráfico con barras horizontales ordenadas de mayor a menor, etiquetas numéricas con dos decimales y una escala fija entre 0 y 10. El uso de colores diferenciados por región permite reforzar la legibilidad y la comparación.\n\nLa salida final es un objeto ggplot, lo que significa que puede ser modificado, guardado o integrado en flujos de trabajo de visualización más amplios.\n\n### **Ejemplos**\n\n#### **1) Visualización general de la edición 2025**\n\n**Se desea lo siguiente:** generar un ranking completo de las 25 regiones para el índice general total en la edición 2025.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraf1 <- general_barras(edicion = 2025)\ngraf1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un gráfico de barras horizontales que muestra a todas las regiones ordenadas por su puntaje total en 2025.\n\n#### **2) Enfoque por pilar (nombre) con leyenda activada**\n\n**Se desea lo siguiente:** explorar el desempeño de las regiones en el pilar de Salud.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraf2 <- general_barras(\n  edicion = 2025,\n  pilar = \"Salud\",\n  mostrar_leyenda = TRUE\n)\ngraf2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-17-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Ranking regional para el pilar Salud, con la leyenda activada para identificar los colores asociados.\n\n#### **3) Subconjunto de regiones (grupo y nombres)**\n\n**Se desea lo siguiente:** reducir la visualización a un grupo de regiones del norte y dos regiones adicionales.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraf3 <- general_barras(\n  edicion = 2025,\n  regiones = c(\"gr_norte\", \"Lima*\", \"La Libertad\")\n)\ngraf3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un gráfico con solo las regiones especificadas, manteniendo la escala común de 0 a 10.\n\n#### **4) Inclusión de “Perú” y cambio de paleta**\n\n**Se desea lo siguiente:** incluir la referencia nacional y utilizar una paleta perceptualmente uniforme.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraf4 <- general_barras(\n  edicion = 2025,\n  pilar = \"Infraestructura\",\n  incluir_peru = TRUE,\n  paleta = \"viridis\"\n)\ngraf4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Ranking del pilar Infraestructura con la fila “Perú” como punto de comparación y colores adaptados a \"viridis\".\n\n#### **5) Comparación focalizada de regiones líderes y rezagadas**\n\n**Se desea lo siguiente:** destacar únicamente sesis regiones del índice general total en 2025.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraf5 <- general_barras(\n  edicion = 2025,\n  regiones = c(\"Moquegua\", \"Lima*\", \"Arequipa\",\n               \"Loreto\", \"Ucayali\", \"Puno\"),\n  paleta = \"okabe_ito\",\n  mostrar_leyenda = TRUE\n)\ngraf5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Gráfico con seis barras que permiten comparar visualmente el contraste entre los primeros lugares (Moquegua, Lima\\*, Arequipa) y los últimos (Loreto, Ucayali, Puno), siguiendo los resultados oficiales del INCORE .\n\n## **general_dispersion_pilares()**\n\n**Dispersión del puntaje General por pilar (una edición)**\n\nLa función integra la familia de visualizaciones general\\_\\* y su objetivo es representar, para una **edición** del INCORE, la **distribución del puntaje General (0–10)** de las regiones **a lo largo de los pilares**. Cada **pilar** constituye el eje **X** y cada **punto** corresponde al puntaje **General** de una **región** en ese pilar. El resultado es una vista **comparativa y transversal**: permite observar, en un mismo gráfico, cómo se “abren” o “cierran” las dispersiones por pilar, dónde se ubica el **promedio nacional** y qué tan heterogéneo es el desempeño por dimensión.\n\n### **Introducción**\n\ngeneral_dispersion_pilares() aborda un problema típico en informes comparativos: **entender la variabilidad entre regiones por dimensiones** (pilares) dentro de un mismo año. Mientras que un ranking de barras prioriza el orden, esta función prioriza la **distribución**: ¿en qué pilares existe mayor concentración de regiones en torno a valores similares? ¿Dónde se observan colas más pronunciadas? ¿Cómo se ubican las regiones respecto del **promedio nacional**? La lectura simultánea por pilares facilita detectar **asimetrías**: por ejemplo, un pilar con medias similares pero **dispersión alta** frente a otro con **dispersión baja**, o clusters de regiones que tienden a agruparse en determinados pilares.\n\n### **Parámetros**\n\nLa lógica de uso parte de una **edición** y, opcionalmente, filtros de **regiones** y **pilares**. Existen además parámetros de **estética** que permiten aclarar la lectura (jitter para separar puntos, estilo del promedio) y una **paleta cualitativa** para distinguir regiones.\n\n-   **edicion**: fija la **edición (año)** del INCORE a visualizar.\n\n    Opciones y formato:\n\n    -   integer(1)\n\n    -   2016 … 2025\n\n-   **regiones**: delimita el **universo de regiones** a mostrar, admite nombres, códigos, **grupos gr\\_\\***, e **inclusiones/exclusiones** con prefijos como \"-\".\n\n    Opciones y formato:\n\n    -   \"ALL\" (por defecto: todas las regiones)\n\n    -   c(\"REGION1\", \"REGION2\")\n\n    -   c(\"COD1\", \"COD2\")\n\n    -   c(\"gr_costa\", \"gr_sierra\", \"gr_selva\") (según los grupos definidos en el paquete)\n\n    -   Exclusiones: \"-Lima\\*\" (ejemplo de patrón para excluir)\n\n    -   Combinaciones mixtas: c(\"gr_costa\", \"La Libertad\", \"-Lima\\*\")\n\n-   **pilares**: selecciona los **pilares** a incluir, puede mezclar **nombres** y **códigos** (si se cuenta con catálogos activos).\n\n    Opciones y formato:\n\n    -   \"ALL\" (por defecto: \"Entorno económico\", \"Laboral\", \"Infraestructura\", \"Salud\", \"Educación\", \"Instituciones\")\n\n    -   Nombres: c(\"Salud\", \"Educación\")\n\n    -   Códigos: c(\"SAL\", \"EDU\")\n\n    -   Mezcla: c(\"SAL\", \"Educación\", \"INF\")\n\n-   **paleta**: paleta **cualitativa** para colorear **por región** (colores consistentes a través de pilares).\n\n    Opciones y formato:\n\n    -   \"ipe\" (por defecto)\n\n    -   \"okabe_ito\" (accesible para daltonismo)\n\n    -   \"viridis\" (perceptualmente uniforme, recomendable con muchas regiones)\n\n-   **mostrar_promedio**: añade un **marcador del promedio nacional** (promedio entre regiones) por **pilar**.\n\n    Opciones y formato:\n\n    -   TRUE (por defecto)\n\n    -   FALSE\n\n-   **promedio_shape**, **promedio_size**, **promedio_color**, **promedio_fill**: controlan la **estética** del marcador de promedio (forma, tamaño, color de borde y relleno).\n\n    Opciones (típicas):\n\n    -   promedio_shape = 23 (rombo relleno)\n\n    -   promedio_size = 3.5\n\n    -   promedio_color = \"black\"\n\n    -   promedio_fill = \"white\"\n\n-   **jitter_width**, **jitter_height**: amplitud del **jitter** para **separar** puntos que podrían superponerse vertical u horizontalmente.\n\n    Opciones y formato:\n\n    -   jitter_width = 0.08 (por defecto)\n\n    -   jitter_height = 0.0 (por defecto)\n\nEl parámetro **usar_codigos** cumple una función operativa secundaria: si es TRUE, habilita la **traducción** de códigos de región/pilar a nombres oficiales mediante los catálogos del paquete, manteniendo consistencia editorial.\n\n### **Explicación conceptual**\n\nLa función **lee** los datos de la edición indicada, **filtra** las filas correspondientes al **indicador “General”** de cada **pilar canónico** y **excluye** la fila “Perú” para concentrar el análisis en dispersiones **inter-regionales**. Si se especifican pilares, traduce y filtra según nombres/códigos, si se especifican regiones, resuelve **grupos gr\\_\\*** y **exclusiones**. Como salvaguarda, **consolida** un valor por (región, pilar) y prepara una **paleta** cualitativa estable para todas las regiones del subconjunto. La marcación del **promedio nacional** añade un **referente** en cada pilar, útil para identificar pilares por encima/por debajo de la media. La geometría base es un **geom_jitter** con límites fijos **0–10** en y, lo que estandariza la comparación entre pilares y evita interpretaciones sensibles a escalas variables.\n\n### **Ejemplos**\n\n#### **1) Dispersión completa por pilares en una edición**\n\n**Se desea lo siguiente:** visualizar la dispersión del **puntaje General** de todas las regiones en **todos los pilares** para una edición reciente.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- general_dispersion_pilares(\n  edicion = 2025,\n  regiones = \"ALL\",\n  pilares  = \"ALL\"\n)\np1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-21-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Puntos por región en cada pilar, con **promedio nacional** marcado (por defecto). Permite detectar pilares con **dispersión alta/baja** y la posición de la media en cada uno.\n\n#### **2) Subconjunto territorial con grupos y exclusiones**\n\n**Se desea lo siguiente:** revisar la dispersión solo para **costa** y excluir **Lima**\\* para observar la estructura sin el mayor outlier urbano.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- general_dispersion_pilares(\n  edicion = 2025,\n  regiones = c(\"gr_costa\", \"-Lima*\"),\n  pilares  = \"ALL\",\n  paleta   = \"okabe_ito\"\n)\np2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-22-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dispersión enfocada en la **costa** sin Lima\\*, coloreada con una paleta accesible para daltonismo. La comparación por pilar revela si, sin Lima\\*, cambian los pilares con mayor/menor heterogeneidad.\n\n#### **3) Selección de pilares por código**\n\n**Se desea lo siguiente:** comparar únicamente **Salud** e **Infraestructura** utilizando códigos, manteniendo el promedio visible.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- general_dispersion_pilares(\n  edicion = 2025,\n  regiones = \"ALL\",\n  pilares  = c(\"SAL\", \"INF\"),\n  mostrar_promedio = TRUE\n)\np3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-23-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dispersión centrada en **dos pilares** clave, el **promedio nacional** por pilar facilita contrastar si la mediana subjetiva de los puntos coincide o no con la media trazada.\n\n#### **4) Lectura fina en un bloque mixto de regiones**\n\n**Se desea lo siguiente:** inspeccionar un **bloque mixto** (grupo + regiones puntuales) y ajustar el **jitter** para separar puntos muy cercanos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np4 <- general_dispersion_pilares(\n  edicion = 2025,\n  regiones = c(\"gr_costa\", \"Cusco\", \"Arequipa\"),\n  pilares  = c(\"Educación\", \"Instituciones\", \"Laboral\"),\n  jitter_width  = 0.12,\n  jitter_height = 0.02,\n  paleta = \"viridis\"\n)\np4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Mejor separación visual de puntos **muy próximos** dentro de los pilares seleccionados, la paleta \"viridis\" mantiene distinguibilidad cuando hay varias regiones en un mismo rango.\n\n#### **5) Vista focal con mezcla de nombres/códigos y promedio estilizado**\n\n**Se desea lo siguiente:** centrar la lectura en **tres pilares** combinando nombres y códigos, con un **promedio** más visible por forma/tamaño.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np5 <- general_dispersion_pilares(\n  edicion = 2025,\n  regiones = c(\"gr_sierra\", \"La Libertad\", \"-Lima*\"),\n  pilares  = c(\"Salud\", \"EDU\", \"INF\"),\n  mostrar_promedio = TRUE,\n  promedio_shape = 23,\n  promedio_size  = 4.2,\n  promedio_color = \"black\",\n  promedio_fill  = \"white\"\n)\np5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-25-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dispersión para **Salud**, **Educación** (\"EDU\") e **Infraestructura** (\"INF\") en un subconjunto que combina **grupo sierra**, una **región específica** y una **exclusión**. El marcador del **promedio** resalta como **referente** por pilar, mejorando la lectura ejecutiva.\n\n## **general_distribucion()**\n\n**Distribución de puntajes (General o por pilares) en una edición**\n\nOrientada a representar la **variabilidad** de los puntajes del INCORE para **una edición** específica. A diferencia de un ranking, que enfatiza el orden, general_distribucion() enfatiza la **distribución**: permite observar **medianas, rangos intercuartílicos, colas y outliers** a través de **boxplots** o **violines**, ya sea sobre el **índice general** (un único eje) o sobre los **seis pilares** simultáneamente (seis ejes).\n\n### **Introducción**\n\nEl objetivo de general_distribucion() es ofrecer una **lectura estructurada de la dispersión** entre regiones. En contextos donde se requiere comprender **heterogeneidad territorial**, esta visualización ayuda a responder preguntas como: ¿qué tan amplia es la variación entre regiones en cada pilar?, ¿en qué dimensiones los valores se agrupan de forma compacta?, ¿cómo se compara la **media nacional** con la distribución subnacional? La función trabaja **exclusivamente** con filas cuya unidad es Puntaje del 0 al 10 y, de forma consistente con el paquete, usa leer_incore(..., agregar_codigos = TRUE) para asegurar la disponibilidad de **códigos canónicos** de pilar y región cuando correspondan.\n\n### **Parámetros**\n\nLa estrategia de uso se construye a partir de tres decisiones: (i) **qué eje** se desea mostrar (\"general\" vs \"pilares\"), (ii) **qué forma** de distribución se prefiere (\"boxplot\" vs \"violin\"), y (iii) **qué subconjunto** de regiones conviene analizar (por grupos, exclusiones o mezcla de códigos/nombres). Sobre ello, se aplican elecciones de **paleta** y elementos de **lectura** como la **línea de promedio** y el **jitter**.\n\n-   **edicion**: establece la **edición (año)** del INCORE a graficar, es un único valor numérico.\n\n    Opciones y formato:\n\n    -   integer(1)\n\n    -   2016 … 2025\n\n-   **modo**: define si la distribución se visualiza como **un solo eje** (índice general) o **seis ejes** (pilares).\n\n    Opciones y formato:\n\n    -   \"pilares\" (por defecto)\n\n    -   \"general\"\n\n-   **regiones**: delimita el **universo regional**, admite nombres, códigos, **grupos gr\\_\\***, e **inclusiones/exclusiones** con prefijo \"-\".\n\n    Opciones y formato:\n\n    -   \"ALL\" (todas las regiones)\n\n    -   c(\"REGION1\", \"REGION2\")\n\n    -   c(\"COD1\", \"COD2\")\n\n    -   c(\"gr_costa\", \"gr_sierra\", \"gr_selva\")\n\n    -   Exclusiones: \"-Lima\\*\"\n\n    -   Combinaciones mixtas: c(\"gr_costa\", \"La Libertad\", \"-Lima\\*\")\n\n-   **tipo**: el **estimador gráfico** de distribución.\n\n    Opciones y formato:\n\n    -   \"boxplot\" (por defecto, resalta mediana y cuartiles)\n\n    -   \"violin\" (muestra densidad, útil con muchas observaciones)\n\n-   **jitter**: decide si superponer **puntos individuales** para evidenciar masa de datos o outliers locales.\n\n    Opciones y formato:\n\n    -   FALSE (por defecto)\n\n    -   TRUE (añade puntos con alpha suave)\n\n-   **paleta**: paleta **discreta** de relleno, en modo = \"pilares\" se aplica **por pilar**, en modo = \"general\" el relleno es **único**.\n\n    Opciones y formato:\n\n    -   \"blues\" (por defecto)\n\n    -   \"viridis\"\n\n    -   \"cividis\"\n\n-   **linea_promedio**: dibuja una **línea horizontal punteada** en el **promedio nacional** (calculado sobre regiones).\n\n    Opciones y formato:\n\n    -   TRUE (por defecto)\n\n    -   FALSE\n\n-   **mostrar_leyenda**: controla la visibilidad de leyenda (relevante solo en modo = \"pilares\").\n\n    Opciones y formato:\n\n    -   FALSE (por defecto)\n\n    -   TRUE\n\nEl parámetro **usar_codigos** cumple un rol operativo (traducción de códigos a nombres oficiales), normalmente se deja en TRUE para mantener consistencia visual y editorial.\n\n### **Explicación conceptual**\n\nLa función **lee** los datos de la edición solicitada con **códigos** disponibles, **filtra** a Puntaje del 0 al 10 y aplica, si corresponde, **resolución de grupos** y **exclusiones** de regiones. En modo = \"general\", se construye **un único eje** (código GEN) a partir del **índice general**, en modo = \"pilares\", se trabaja con los seis **códigos canónicos** (ECO, LAB, INF, SAL, EDU, INS) y **se ordenan** los ejes por una estadística robusta (p. ej., mediana) para favorecer la lectura comparativa. La **línea de promedio** agrega un referente nacional por encima/dentro de la distribución, y la paleta **discreta** garantiza legibilidad por pilar (o un estilo sobrio único en el caso general). La salida es un objeto ggplot con escala **0–10** en el eje vertical, coherente con el resto del paquete.\n\n### **Ejemplos**\n\n#### **1) Distribución por pilares con configuración por defecto**\n\n**Se desea lo siguiente:** visualizar la distribución del **puntaje General** por cada pilar para una edición reciente, sin filtros adicionales.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 <- general_distribucion(\n  edicion = 2025,\n  modo    = \"pilares\",\n  regiones = \"ALL\"\n)\ng1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-26-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Seis ejes (\"ECO\",\"LAB\",\"INF\",\"SAL\",\"EDU\",\"INS\") con **boxplots** (o violines, según tipo) y **línea de promedio** nacional. Permite detectar de inmediato pilares con **dispersión alta** frente a otros más **compactos**.\n\n#### **2) Índice General (un solo eje) con jitter\\] y promedio**\n\n**Se desea lo siguiente:** observar la **variabilidad nacional** del índice general, con puntos individuales para evidenciar posibles outliers.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng2 <- general_distribucion(\n  edicion = 2025,\n  modo    = \"general\",\n  tipo    = \"boxplot\",\n  jitter  = TRUE,\n  linea_promedio = TRUE\n)\ng2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-27-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un eje único etiquetado como \"GEN\", el **boxplot** resume la distribución y el **jitter** muestra el posicionamiento puntual de cada región. La **línea de promedio** sirve de referencia global.\n\n#### **3) Subconjunto costero con exclusión de Lima\\* y paleta accesible**\n\n**Se desea lo siguiente:** analizar la distribución de pilares solo en la **costa**, excluyendo **Lima**\\*, y mejorar la accesibilidad cromática.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng3 <- general_distribucion(\n  edicion = 2025,\n  modo    = \"pilares\",\n  regiones = c(\"gr_costa\", \"-Lima*\"),\n  tipo    = \"violin\",\n  paleta  = \"cividis\",\n  mostrar_leyenda = TRUE\n)\ng3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-28-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Seis violines con distribución **sin Lima**\\* (para evitar que su peso estructural distorsione la lectura). La paleta \"cividis\" favorece la **distinguibilidad** en proyección e impresión.\n\n#### **4) Foco en tres pilares clave con jitter fino y paleta perceptual**\n\n**Se desea lo siguiente:** concentrar la lectura en **Educación**, **Infraestructura** y **Salud** con separación adicional de puntos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng4 <- general_distribucion(\n  edicion = 2025,\n  modo    = \"pilares\",\n  regiones = \"ALL\",\n  tipo    = \"boxplot\",\n  jitter  = TRUE,\n  paleta  = \"viridis\",\n  mostrar_leyenda = TRUE\n)\n\ng4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-29-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Boxplots por pilar con **puntos** superpuestos, la paleta \"viridis\" mantiene **contraste**.\n\n#### **5) Comparación “bloque mixto” (grupo + nombres) con línea de promedio activada**\n\n**Se desea lo siguiente:** comparar un **bloque mixto** formado por gr_sierra y dos regiones específicas, manteniendo la referencia nacional.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng5 <- general_distribucion(\n  edicion = 2025,\n  modo    = \"pilares\",\n  regiones = c(\"gr_sierra\", \"La Libertad\"),\n  tipo    = \"violin\",\n  paleta  = \"blues\",\n  linea_promedio = TRUE,\n  mostrar_leyenda = TRUE\n)\ng5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-30-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Violines por pilar con énfasis en un **bloque heterogéneo** (grupo + regiones puntuales). La **línea de promedio** refuerza la comparación “por encima/por debajo” del referente nacional, útil para mensajes ejecutivos.\n\n## **general_heatmap()**\n\n**Mapa de calor del puntaje General por región en múltiples ediciones**\n\n### **Introducción**\n\ngeneral_heatmap() resuelve un problema habitual en el análisis longitudinal: **comparar la evolución del puntaje General (0–10) por región a lo largo de varias ediciones**. La representación en **mapa de calor** condensa, en una sola figura, tres componentes: **regiones** (filas), **ediciones** (columnas) y **magnitud** del puntaje (color). Esta composición facilita detectar **tendencias** (mejoras o retrocesos), **persistencias** (niveles consistentemente altos o bajos) y **rupturas** (cambios bruscos entre ediciones). La función trabaja exclusivamente con filas cuyo pilar **comienza con** “Índice de Competitividad Regional” (es decir, el **índice general**), y excluye “Perú” para conservar el foco comparativo a nivel regional.\n\n### **Parámetros**\n\nEl uso práctico de general_heatmap() se articula en tres decisiones: (i) **rango de ediciones** a mostrar, (ii) **universo de regiones** (total o subconjunto) y (iii) **orden de las filas** de cara a la lectura. Sobre ello, se elige la **paleta continua** de color, se decide si **anotar valores** en cada celda y si **exhibir la leyenda**.\n\n-   **ediciones**: define el **conjunto de ediciones** a visualizar, requiere **al menos dos años**.\n\n    Opciones y formato:\n\n    -   integer vector con longitud ≥ 2\n\n    -   Rangos: 2019:2025\n\n    -   Discretos: c(2018, 2020, 2022, 2024)\n\n-   **regiones**: establece el **universo regional**, admite nombres, códigos y, si el paquete lo dispone, **grupos gr\\_\\*** y **exclusiones** por prefijo \"-\".\n\n    Opciones y formato:\n\n    -   \"ALL\" (todas las regiones)\n\n    -   c(\"Lima\\*\", \"Arequipa\", \"Cusco\") (nombres o patrones)\n\n    -   c(\"MOQ\", \"ARE\", \"CUS\") (códigos, si están definidos en catálogos)\n\n    -   c(\"gr_costa\", \"gr_sierra\") (grupos predefinidos)\n\n    -   Exclusiones por patrón: \"-Lima\\*\"\n\n    -   Combinaciones mixtas: c(\"gr_costa\", \"La Libertad\", \"-Lima\\*\")\n\n-   **ordenar**: especifica el **criterio de orden** de las filas (regiones) para favorecer la lectura comparativa.\n\n    Opciones y formato:\n\n    -   \"ninguno\" (orden alfabético)\n\n    -   \"por_ultimo\" (según puntaje de la **última** edición del rango)\n\n    -   \"por_promedio\" (según **promedio** del puntaje en el rango de ediciones)\n\n-   **paleta**: selecciona la **paleta continua** para el mapeo 0–10.\n\n    Opciones y formato:\n\n    -   \"blues\" (por defecto, progresión fría sobria)\n\n    -   \"viridis\" (perceptualmente uniforme)\n\n    -   \"cividis\" (accesible en proyección e impresión)\n\n    -   \"magma\" (contraste alto, útil para resaltar extremos)\n\n-   **anotar**: decide si **imprimir el valor** dentro de cada celda.\n\n    Opciones y formato:\n\n    -   FALSE (por defecto)\n\n    -   TRUE (muestra valores con dos decimales)\n\n-   **mostrar_leyenda**: controla la **visibilidad de la leyenda** de colores.\n\n    Opciones y formato:\n\n    -   TRUE\n\n    -   FALSE\n\nEl parámetro **usar_codigos** cumple un rol operativo: cuando es TRUE, traduce códigos de regiones a **nombres oficiales** para mantener consistencia editorial (normalmente se deja activado).\n\n### **Explicación conceptual**\n\nLa función **lee** el conjunto de ediciones solicitadas, **filtra** únicamente el **índice general** (descartando el agregado nacional “Perú”), y **consolida** un valor por (región, edición) para garantizar unicidad en cada celda del mapa. Luego **ordena** las filas según el criterio indicado: alfabético, por el valor de la **última edición** (adecuado cuando el interés es la situación más reciente) o por el **promedio** a lo largo del período (útil para lecturas de **desempeño sostenido**). Finalmente aplica una **paleta continua** con límites **0–10** y, si se solicita, **anota** el valor en cada celda, lo que puede ser conveniente en matrices pequeñas o en cortes enfocados.\n\n### **Ejemplos**\n\n#### **1) Panorama básico por ediciones (orden alfabético, paleta por defecto)**\n\n**Se desea lo siguiente:** visualizar la evolución 2020–2025 para todas las regiones, priorizando una lectura sobria.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh1 <- general_heatmap(\n  ediciones = 2020:2025,\n  regiones  = \"ALL\",\n  ordenar   = \"ninguno\",\n  paleta    = \"blues\"\n)\nh1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-31-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Mapa de calor con filas alfabéticas y columnas 2020…2025, la progresión “blues” facilita distinguir niveles sin saturar.\n\n#### **2) Enfoque en la foto más reciente (orden por última edición)**\n\n**Se desea lo siguiente:** ordenar las regiones según su valor en la edición más reciente del rango.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh2 <- general_heatmap(\n  ediciones = 2019:2025,\n  regiones  = \"ALL\",\n  ordenar   = \"por_ultimo\",\n  paleta    = \"viridis\",\n  mostrar_leyenda = TRUE\n)\nh2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-32-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Filas ordenadas de mayor a menor **según 2025**, útil para destacar posiciones actuales y evaluar trayectorias relativas.\n\n#### **3) Subconjunto con grupo y exclusión (anotando valores)**\n\n**Se desea lo siguiente:** comparar solo la **costa** excluyendo **Lima**\\* y **anotar** los puntajes para un seguimiento fino.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh3 <- general_heatmap(\n  ediciones = 2021:2025,\n  regiones  = c(\"gr_costa\", \"-Lima*\"),\n  ordenar   = \"por_promedio\",\n  paleta    = \"cividis\",\n  anotar    = TRUE,\n  mostrar_leyenda = TRUE\n)\nh3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-33-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Filas ordenadas por el **promedio 2021–2025** de la costa **sin Lima**\\*, con valores impresos en cada celda, la paleta \"cividis\" favorece la distinguibilidad en proyección.\n\n#### **4) Corte enfocado con códigos/nombres y contraste alto**\n\n**Se desea lo siguiente:** mostrar 2022–2025 para un subconjunto mixto (códigos + nombres) con contraste cromático alto.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh4 <- general_heatmap(\n  ediciones = 2022:2025,\n  regiones  = c(\"MOQ\", \"Arequipa\", \"La Libertad\", \"Cusco\"),\n  ordenar   = \"por_ultimo\",\n  paleta    = \"magma\",\n  anotar    = FALSE\n)\nh4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-34-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Mapa compacto que prioriza la lectura por **última edición** y resalta extremos con \"magma\", útil para resúmenes ejecutivos.\n\n#### **5) Serie discontinua de ediciones con orden por promedio**\n\n**Se desea lo siguiente:** evaluar un patrón **no anual** (años alternos) y ordenar por **desempeño sostenido**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh5 <- general_heatmap(\n  ediciones = c(2017, 2019, 2021, 2023, 2025),\n  regiones  = \"ALL\",\n  ordenar   = \"por_promedio\",\n  paleta    = \"viridis\",\n  anotar    = FALSE,\n  mostrar_leyenda = TRUE\n)\nh5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-35-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Filas ordenadas por el **promedio** en una serie discontinua, lo que ayuda a identificar regiones con **rendimiento consistente** a lo largo del tiempo.\n\n## **general_largo()**\n\n**Evolución del puntaje General (líneas) por región y/o por pilar**\n\nEsta función integra la familia de visualizaciones general\\_\\* y está diseñada para **series de tiempo** del **puntaje General (0–10)** del INCORE cuando se dispone de **dos o más ediciones**. Ofrece dos enfoques complementarios:\n\n-   modo = \"general\": una **línea por región** del **índice general** (filas cuyo pilar inicia con “Índice de Competitividad Regional” e indicador == \"General\").\n\n-   modo = \"pilares\": **líneas por región** con **facetado por pilar**, utilizando indicador == \"General\" en cada pilar.\n\n### **Introducción**\n\ngeneral_largo() resuelve la necesidad de **observar trayectorias**: cómo evolucionan las regiones en el **índice general** o, alternativamente, cómo se mueven **en cada pilar** a lo largo del tiempo. Es especialmente útil para identificar **convergencias** o **divergencias** regionales, **rupturas** (cambios abruptos entre ediciones), **persistencias** (tendencias sostenidas) y **liderazgos** emergentes. En modo = \"pilares\", el **facetado** permite comparar, en paralelo, si la historia de una misma región es similar o distinta según el pilar considerado. El eje vertical se mantiene en **0–10** para asegurar comparabilidad, y la estética de color por región preserva la identidad visual en todas las ediciones.\n\nEl argumento usar_codigos (secundario) facilita la **traducción de códigos** a nombres oficiales en regiones/pilares para mantener consistencia editorial y legibilidad en etiquetas y leyendas.\n\n### **Parámetros**\n\nEl uso práctico se apoya en tres decisiones: (i) **rango de ediciones** a estudiar, (ii) **nivel de análisis** (índice general vs. pilares) y (iii) **universo de regiones** (total o subconjunto). Sobre estas, se elige la **paleta** y si conviene **marcar puntos** en las líneas.\n\n-   **ediciones**: determina las **ediciones (años)** a graficar, requiere **al menos dos**.\n\n    Opciones y formato:\n\n    -   integer vector con longitud ≥ 2\n\n    -   Rangos: 2020:2025\n\n    -   Discretos: c(2018, 2020, 2022, 2024)\n\n-   **regiones**: define el **universo regional**, admite nombres, códigos, **grupos gr\\_\\*** y **exclusiones** con prefijo \"-\".\n\n    Opciones y formato:\n\n    -   \"ALL\" (todas las regiones)\n\n    -   c(\"REGION1\", \"REGION2\")\n\n    -   c(\"COD1\", \"COD2\")\n\n    -   c(\"gr_costa\", \"gr_sierra\", \"gr_selva\")\n\n    -   Exclusiones: \"-Lima\\*\"\n\n    -   Combinaciones mixtas: c(\"gr_costa\", \"La Libertad\", \"-Lima\\*\")\n\n-   **modo**: establece el **nivel de análisis** temporal.\n\n    Opciones y formato:\n\n    -   \"general\" (una línea por región, índice general)\n\n    -   \"pilares\" (líneas por región, **facetado** por los seis pilares)\n\n-   **pilares** *(solo si modo = \"pilares\")*: restringe el **conjunto de pilares** a graficar, admite **nombres** y **códigos**.\n\n    Opciones y formato:\n\n    -   NULL (por defecto: los 6 pilares canónicos)\n\n    -   Nombres: c(\"Salud\", \"Infraestructura\", \"Educación\")\n\n    -   Códigos: c(\"SAL\", \"INF\", \"EDU\")\n\n    -   Mezcla: c(\"SAL\", \"Educación\", \"INF\")\n\n-   **paleta**: paleta **cualitativa** para colorear **por región**.\n\n    Opciones y formato:\n\n    -   \"ipe\" (por defecto, institucional)\n\n    -   \"okabe_ito\" (accesible para daltonismo)\n\n    -   \"viridis\" (perceptualmente uniforme)\n\n-   **mostrar_puntos**: decide si **marcar puntos** en cada edición sobre las líneas.\n\n    Opciones y formato:\n\n    -   TRUE (por defecto)\n\n    -   FALSE\n\n### **Explicación conceptual**\n\nLa función **lee** el conjunto de ediciones solicitado, **filtra** a indicador == \"General\" y, según el modo, conserva ya sea el **índice general** (pilar agregado de portada) o los **seis pilares canónicos**. Para regiones, resuelve **grupos gr\\_\\*** y **exclusiones**. El color asignado **por región** se mantiene consistente entre ediciones, y el eje **0–10** preserva la escala del INCORE.\n\nEn modo = \"general\", las regiones se **ordenan** tomando la **última edición** del rango (útil para resaltar la situación más reciente en la leyenda y facilitar la lectura de líderes y rezagados). En modo = \"pilares\", el **facetado** (facet_wrap) organiza las series en paneles por pilar, lo que permite leer **patrones simultáneos** con un mismo código cromático por región.\n\n### **Ejemplos**\n\n> Se asume el paquete cargado y dependencias disponibles (ggplot2, etc.). Los ejemplos exploran **características propias del paquete**: grupos gr\\_\\*, exclusiones por patrón, mezcla de nombres/códigos de pilar, facetado y elección de paleta.\n\n#### **1) Evolución del índice general para todas las regiones Se desea lo siguiente:** visualizar la evolución 2019–2025 del índice general para el país, con puntos marcados en cada edición.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ne1 <- general_largo(\n  ediciones = 2019:2025,\n  regiones  = \"ALL\",\n  modo      = \"general\",\n  paleta    = \"ipe\",\n  mostrar_puntos = TRUE\n)\ne1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-36-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Una línea por región (índice general), escala 0–10, puntos visibles y **orden en leyenda** acorde a la **última edición**.\n\n#### **2)Pilares con facetado completo y paleta accesible**\n\n**Se desea lo siguiente:** observar trayectorias por pilar (los seis paneles)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ne2 <- general_largo(\n  ediciones = 2020:2025,\n  regiones  = c(\"gr_selva\"),\n  modo      = \"pilares\",\n  paleta    = \"okabe_ito\",\n  mostrar_puntos = TRUE\n)\ne2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-37-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Seis paneles (pilares), una línea por región en cada panel.\n\n#### **3) Subconjunto territorial con grupo y exclusión**\n\n**Se desea lo siguiente:** comparar la evolución del índice general solo para la **costa**, **excluyendo Lima**\\*, con una paleta perceptual robusta.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ne3 <- general_largo(\n  ediciones = 2016:2025,\n  regiones  = c(\"gr_costa\", \"-Lima*\"),\n  modo      = \"general\",\n  paleta    = \"viridis\",\n  mostrar_puntos = FALSE\n)\ne3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-38-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Líneas más claras en el subconjunto costero sin Lima\\*, con **trazos limpios** (sin puntos) para enfatizar tendencia.\n\n#### **4)Pilares seleccionados mezclando nombres y códigos**\n\n**Se desea lo siguiente:** analizar solo **Salud**, **Infraestructura** y **Educación** combinando nombres y códigos de pilar.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ne4 <- general_largo(\n  ediciones = 2020:2025,\n  regiones  = c(\"gr_costa\", \"-Lima*\"),\n  modo      = \"pilares\",\n  pilares   = c(\"SAL\", \"Infraestructura\", \"EDU\"),\n  paleta    = \"ipe\",\n  mostrar_puntos = TRUE\n)\ne4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-39-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Facetado con **tres paneles** (Salud, Infraestructura, Educación), respetando el color por región e identificando **contrastes** en la dinámica por dimensión.\n\n#### **5) Serie discontinua y bloque mixto de regiones**\n\n**Se desea lo siguiente:** estudiar un patrón **no anual** (ediciones alternas) y centrarse en un **bloque mixto** de regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ne5 <- general_largo(\n  ediciones = c(2016, 2018, 2020, 2022, 2024),\n  regiones  = c(\"gr_sierra\", \"Arequipa\", \"La Libertad\"),\n  modo      = \"general\",\n  paleta    = \"okabe_ito\",\n  mostrar_puntos = TRUE\n)\ne5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-40-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Evolución en **años alternos** para un conjunto formado por **grupo** + **regiones puntuales**, los puntos facilitan comparar niveles en las ediciones muestreadas.\n\nPerfecto. Aquí tienes el texto **detallado, narrativo y didáctico** para tu manual sobre **general_mapa()**, con los **parámetros clave en viñetas** (todas las opciones y valores envueltos en \\`\\`) y **5 ejemplos** claros que exploran funcionalidades propias del paquete (grupos gr\\_\\*, exclusiones con \\`”-”\\`, zoom a subconjuntos, etiquetas y paletas continuas/divergentes). Mantengo \\`usar_codigos\\` como argumento secundario.\n\n## **general_mapa()**\n\n**Mapa coroplético del puntaje General por región (una edición)**\n\n### **Introducción**\n\ngeneral_mapa() resuelve la necesidad de **ubicar espacialmente** los resultados del **Índice de Competitividad Regional (INCORE)** en **una edición** específica. A diferencia de un ranking o una dispersión, el coroplético prioriza la **lectura territorial**: permite reconocer **patrones geográficos** (continuidades, gradientes, contrastes) y detectar **bolsones de alto o bajo desempeño**. La función colorea cada región según su **puntaje General (0–10)** y utiliza exclusivamente filas cuyo pilar **comienza con** “Índice de Competitividad Regional”, garantizando que se represente el **índice general** y no un pilar. El subtítulo fija el contexto temporal con “Puntaje General (YYYY)”, reforzando la idea de **corte temporal**.\n\nSe debe cargar primero el mapa:\n\n\n\n\n\n\n\n\n\n### **Parámetros**\n\nEl uso práctico combina tres decisiones: (i) **qué edición** se desea mostrar, (ii) **qué regiones** incluir (todas o un subconjunto, con soporte a **grupos** y **exclusiones**), y (iii) **cómo** presentar la figura (paleta, etiquetas, y **zoom** opcional sobre un subconjunto). Si no se proporciona un objeto espacial, la función construye uno adecuado para el Perú.\n\n-   **edicion**: fija la **edición (año)** a representar, debe ser un único valor numérico.\n\n    Opciones y formato:\n\n    -   integer(1)\n\n    -   2016 … 2025\n\n-   **regiones**: delimita el **universo de regiones**, admite nombres, códigos, **grupos gr\\_\\*** e **inclusiones/exclusiones** por patrón.\n\n    Opciones y formato:\n\n    -   \"ALL\" (todas las regiones)\n\n    -   c(\"REGION1\", \"REGION2\")\n\n    -   c(\"COD1\", \"COD2\")\n\n    -   c(\"gr_costa\", \"gr_sierra\", \"gr_selva\")\n\n    -   Exclusiones: \"-Lima\\*\"\n\n    -   Combinaciones mixtas: c(\"gr_costa\", \"La Libertad\", \"-Lima\\*\")\n\n-   **mapa_sf**: objeto espacial con columnas \"region\" y \"geometry\".\n\n    Opciones y formato:\n\n    -   NULL (por defecto, se crea con mapa_peru())\n\n    -   sf o SpatVector convertible a sf con st_as_sf()\n\n-   **paleta**: controla la **escala continua** de color (0–10).\n\n    Opciones y formato:\n\n    -   \"blues\" (por defecto, progresión fría sobria)\n\n    -   \"greens\" (alternativa sobria en verdes)\n\n    -   \"viridis\" (perceptualmente uniforme)\n\n    -   \"cividis\" (robusta en proyección e impresión)\n\n    -   \"divergente\" (bicolor con punto medio en 5, útil para “por encima/por debajo”)\n\n-   **simplificar**: tolerancia de **simplificación geométrica** (al crear mapa_peru()) para aligerar el dibujo.\n\n    Opciones y formato:\n\n    -   0 (sin simplificar, por defecto)\n\n    -   \\> 0 (mayores valores ⇒ geometrías más simples)\n\n-   **zoom**: decide si **recortar la vista** al *bounding box* del subconjunto **seleccionado** en regiones.\n\n    Opciones y formato:\n\n    -   FALSE (por defecto, vista nacional)\n\n    -   TRUE (activa zoom si regiones ≠ \"ALL\")\n\n-   **expand_zoom**: margen **proporcional** alrededor del *bounding box* cuando zoom = TRUE.\n\n    Opciones y formato:\n\n    -   0.04 (por defecto)\n\n    -   0 … 0.2 (aprox., según preferencia de encuadre)\n\n-   **etiquetas**: controla cómo **anotar los valores** dentro de cada región.\n\n    Opciones y formato:\n\n    -   \"repel\" (por defecto, usa ggrepel si está disponible)\n\n    -   \"texto\" (etiquetas directas con geom_text)\n\n    -   \"ninguna\" (sin etiquetas internas)\n\nEl parámetro **usar_codigos** es operativo: cuando es TRUE, la función **traduce códigos** a nombres oficiales para mantener consistencia editorial en el mapa y las etiquetas. Mantenerlo activado suele ser lo más conveniente.\n\n### **Explicación conceptual**\n\nLa función **lee** la edición solicitada, **filtra** únicamente el **índice general** (excluyendo “Perú” para conservar el foco subnacional) y, si se especificó regiones, **expande grupos** gr\\_\\* y **aplica exclusiones**. Antes de mapear, **consolida** un único valor por región (promedio defensivo y redondeo), y **une** los datos al objeto espacial. Cuando se establece un subconjunto, el resto de regiones quedan con **NA** y se dibujan en **gris** para no inducir comparaciones donde no hay dato mostrado. La **paleta continua** fija los límites en **0–10**, y las **etiquetas** (si se activan) se colocan sobre puntos internos de cada polígono, favoreciendo la legibilidad. El **zoom opcional** centra la vista en el subconjunto, con un margen expand_zoom para evitar recortes visuales.\n\n### **Ejemplos**\n\n#### **1) Mapa nacional básico (paleta por defecto)**\n\n#### **Se desea lo siguiente:** representar el **índice general** en una edición reciente para **todas** las regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- general_mapa(\n  edicion  = 2025,\n  regiones = \"ALL\",\n  paleta   = \"blues\",\n  etiquetas = \"repel\"\n)\nm1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-42-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Coroplético nacional 0–10.\n\n#### **2) Subconjunto por grupo con zoom automático**\n\n**Se desea lo siguiente:** concentrar la lectura en **costa**, con recorte automático del encuadre.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- general_mapa(\n  edicion   = 2025,\n  regiones  = c(\"gr_costa\"),\n  paleta    = \"viridis\",\n  zoom      = TRUE,\n  expand_zoom = 0.05,\n  etiquetas = \"repel\"\n)\nm2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-43-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Vista recortada a la **costa**, paleta \"viridis\" y etiquetas repel que evitan solapamientos.\n\n#### **3) Subconjunto mixto con exclusión y etiquetas simples**\n\n**Se desea lo siguiente:** mostrar un bloque mixto (grupo + regiones puntuales) **excluyendo Lima**\\* y usar etiquetas simples.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- general_mapa(\n  edicion   = 2025,\n  regiones  = c(\"gr_sierra\", \"Arequipa\", \"La Libertad\", \"-Lima*\"),\n  paleta    = \"cividis\",\n  zoom      = TRUE,\n  etiquetas = \"texto\"\n)\nm3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-44-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Coroplético del subconjunto, **sin Lima**\\*, con etiquetas directas y encuadre ajustado al bloque.\n\n#### **4) Paleta divergente para lectura “por encima / por debajo”**\n\n**Se desea lo siguiente:** enfatizar si las regiones están por **encima** o **debajo** de un punto medio (5).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm4 <- general_mapa(\n  edicion   = 2025,\n  regiones  = \"ALL\",\n  paleta    = \"divergente\",\n  etiquetas = \"ninguna\"\n)\nm4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-45-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Paleta bicolor con **midpoint = 5**: útil para lecturas rápidas tipo “alto/bajo” respecto de un umbral simbólico.\n\n#### **5) Mapa ligero para informes: simplificación geométrica**\n\n**Se desea lo siguiente:** mapa de la región sur\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm5 <- general_mapa(\n  edicion     = 2025,\n  regiones    = \"gr_sur\",\n  paleta      = \"greens\",\n  simplificar = 0.02,\n  etiquetas   = \"repel\",\n  zoom = T\n)\nm5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-46-1.png){width=960}\n:::\n:::\n\n\n\n\n## **general_media()**\n\n**Dispersión del puntaje General (total o de un pilar) frente a un promedio**\n\nSu foco es mostrar, en **una edición** del INCORE, cómo se sitúan las **regiones** frente a un **promedio de referencia**. El gráfico representa, en el eje **X**, el **puntaje General (0–10)** y, en el eje **Y**, las **regiones**. Cada región incluye: (i) una **línea** que va desde el **promedio** hasta su valor y (ii) un **punto** en el valor observado, más una **etiqueta** numérica. La referencia central puede ser el **promedio nacional** (todas las regiones) o el **promedio de la selección** (solo las regiones filtradas para el gráfico).\n\n### **Introducción**\n\ngeneral_media() resuelve un problema recurrente en la comunicación de resultados: **ubicar a cada región respecto de un promedio** de referencia. Mientras un ranking ordena, este diseño enfatiza la **distancia a la media** (y su dirección), permitiendo responder preguntas como: ¿qué regiones están **por encima** del promedio y cuáles **por debajo**?, ¿cuán lejos se encuentran?, ¿existe un bloque de regiones en torno al promedio? La función admite trabajar con el **índice general total** o con el **General de un pilar** específico, y ofrece **cinco esquemas de color** que refuerzan diferentes lecturas (binaria, continua divergente, bandas tipo “semáforo”, color por región, o monocromo).\n\n### **Parámetros**\n\nLa práctica con general_media() descansa en tres decisiones: (i) **qué se grafica** (general total vs. un pilar), (ii) **qué universo regional** se considera (todas o un subconjunto) y (iii) **qué promedio** funge como referente (nacional vs. selección). Sobre eso, se elige el **esquema de color** que mejor sirva el mensaje.\n\n-   **edicion**: fija la **edición (año)** a graficar, un único valor numérico.\n\n    Opciones y formato:\n\n    -   integer(1)\n\n    -   2016 … 2025\n\n-   **pilar**: determina el **contenido** a graficar: **índice general total** o **General de un pilar**.\n\n    Opciones y formato:\n\n    -   NULL (por defecto, índice general total, filas cuyo pilar inicia con “Índice de Competitividad Regional”)\n\n    -   Nombre de pilar: \"Salud\", \"Educación\", \"Infraestructura\", etc.\n\n    -   Código de pilar: \"SAL\", \"EDU\", \"INF\", etc.\n\n-   **regiones**: delimita el **universo de regiones** a representar, admite nombres, códigos, **grupos gr\\_\\*** e **inclusiones/exclusiones** por patrón.\n\n    Opciones y formato:\n\n    -   \"ALL\" (todas las regiones)\n\n    -   c(\"REGION1\", \"REGION2\")\n\n    -   c(\"COD1\", \"COD2\")\n\n    -   c(\"gr_costa\", \"gr_sierra\", \"gr_selva\")\n\n    -   Exclusiones: \"-Lima\\*\"\n\n    -   Mezcla: c(\"gr_costa\", \"La Libertad\", \"-Lima\\*\")\n\n-   **promedio_nacional**: define el **promedio de referencia**.\n\n    Opciones y formato:\n\n    -   FALSE (por defecto, promedio sobre la **selección filtrada**)\n\n    -   TRUE (promedio **nacional** calculado sobre **todas** las regiones disponibles en la edición)\n\n-   **esquema**: elige el **enfoque cromático** del gráfico.\n\n    Opciones y formato:\n\n    -   \"binario\": dos colores según valor \\>= promedio vs. \\< promedio\n\n    -   \"divergente\": gradiente centrado en 0 sobre la diferencia valor - promedio\n\n    -   \"semaforo\": tres bandas (bajo, en torno, alto) con tolerancia interna\n\n    -   \"region\": color **por región** (paletas cualitativas)\n\n    -   \"monocromo\": un solo color para todo el trazo/punto\n\n-   **color_arriba**, **color_abajo**: colores para \"binario\" (y extremos en \"divergente\").\n\n    Opciones y formato:\n\n    -   color_arriba = \"##2C7FB8\", color_abajo = \"##D7301F\" (por defecto)\n\n    -   Cualquier color válido en R (hex, nombre, etc.)\n\n-   **paleta_region** *(cuando esquema = \"region\")*: paleta cualitativa para **regiones**.\n\n    Opciones y formato:\n\n    -   \"ipe\" (por defecto)\n\n    -   \"okabe_ito\"\n\n    -   \"viridis\"\n\n-   **color_mono** *(cuando esquema = \"monocromo\")*: color único para segmentos y puntos.\n\n    Opciones y formato:\n\n    -   \"##3B5B92\" (por defecto)\n\n    -   Cualquier color válido\n\n-   **mostrar_leyenda**: controla si se muestra **leyenda**.\n\n    Opciones y formato:\n\n    -   FALSE (por defecto)\n\n    -   TRUE (relevante sobre todo para \"binario\", \"divergente\", \"semaforo\" y \"region\")\n\n### **Explicación conceptual**\n\nLa función **lee** la edición solicitada, **filtra** a Puntaje del 0 al 10 y, si se especifica pilar, restringe a indicador == \"General\" de ese pilar, si pilar = NULL, toma el **índice general total**. Para regiones, resuelve **grupos gr\\_\\*** y **exclusiones**. Calcula luego un único valor por región (promedio defensivo y redondeo) y determina el **promedio de referencia**: **nacional** (si promedio_nacional = TRUE) o de la **selección** filtrada (por defecto).\n\nEl gráfico traza una **línea horizontal** por región, con origen en el **promedio** y destino en su **valor**, y un **punto** en el valor. La **anotación** numérica se desplaza levemente para evitar solapes y mejorar la legibilidad. La paleta elegida en esquema guía la lectura: **comparación binaria**, **gradiente divergente**, **bandas semafóricas**, **identidad por región** o **sobriedad monocroma**.\n\n### **Ejemplos**\n\n#### **1) Índice General con esquema binario (promedio de la selección)**\n\n**Se desea lo siguiente:** comparar las regiones frente al **promedio de la selección** (todas, porque no se filtra) usando dos colores.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 <- general_media(\n  edicion = 2025,\n  pilar   = NULL,          ## índice general total\n  regiones = \"ALL\",\n  esquema = \"binario\",\n  mostrar_leyenda = TRUE\n)\ng1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-47-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dos clases: **por encima** (o igual) vs. **por debajo** del promedio de la selección. Útil para una lectura ejecutiva rápida.\n\n#### **2) Pilar Salud con esquema divergente (promedio nacional)**\n\n**Se desea lo siguiente:** visualizar la **distancia al promedio nacional** en el pilar Salud, con gradiente continuo centrado en 0.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng2 <- general_media(\n  edicion = 2025,\n  pilar   = \"SAL\",         \n  regiones = \"ALL\",\n  promedio_nacional = TRUE,\n  esquema = \"divergente\",\n  mostrar_leyenda = TRUE\n)\ng2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-48-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Colores fríos para **sobre** el promedio nacional, cálidos para **bajo** el promedio, la leyenda cuantifica la **diferencia**.\n\n#### **3) Subconjunto costero sin Lima \\*, esquema semaforo**\n\n**Se desea lo siguiente:** enfocar en la **costa**, excluir **Lima**\\* y clasificar en **bajo/en torno/alto** respecto del promedio **de la selección**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng3 <- general_media(\n  edicion = 2025,\n  pilar   = NULL,                         \n  regiones = c(\"gr_costa\", \"-Lima*\"),\n  promedio_nacional = FALSE,                \n  esquema = \"semaforo\",\n  mostrar_leyenda = TRUE\n)\ng3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-49-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Tres bandas con tolerancia interna, útil para audiencias que prefieren umbrales cualitativos claros.\n\n#### **4) Color por región (pilar Infraestructura) y paleta accesible**\n\n**Se desea lo siguiente:** resaltar la **identidad** de cada región con una paleta cualitativa accesible.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng4 <- general_media(\n  edicion = 2025,\n  pilar   = \"INF\",      \n  regiones = \"gr_norte\",\n  promedio_nacional = TRUE,\n  esquema = \"region\",\n  paleta_region = \"okabe_ito\",\n  mostrar_leyenda = TRUE\n)\ng4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-50-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Una entrada por región con su color propio, manteniendo la referencia del **promedio nacional** y la comparabilidad 0–10.\n\n### **5) Diseño monocromo**\n\n**Se desea lo siguiente:** un gráfico para un bloque mixto de regiones, enfatizando la distancia al promedio **nacional** sin distracción cromática.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng5 <- general_media(\n  edicion = 2025,\n  pilar   = c(\"Educación\"),   ## pilar por nombre\n  regiones = c(\"gr_sierra\", \"Arequipa\", \"La Libertad\"),\n  promedio_nacional = TRUE,\n  esquema = \"monocromo\",\n  color_mono = \"#3B5B92\",\n  mostrar_leyenda = FALSE\n)\ng5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-51-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Segmentos y puntos en **un color**, la interpretación se centra en la **dirección** y **magnitud** de la diferencia frente al promedio nacional.\n\nPerfecto. Aquí tienes el texto **detallado, narrativo y didáctico** para tu manual sobre **general_radar()**, con los **parámetros clave en viñetas** (todas las opciones y valores envueltos en \\`\\`) y **5 ejemplos** claros que exploran funcionalidades propias del paquete (selección automática AUTO3, uso de grupos \\`gr\\_\\*\\`, control de paleta/alpha, puntos y formato de etiquetas de ejes). Trato \\`usar_codigos\\` como argumento secundario, mencionado en la narración.\n\n## **general_radar()**\n\n**Telaraña del puntaje General por pilares (una edición)**\n\nOrientada a representar, en **una edición** del INCORE, la **configuración de puntajes por pilar** (escala 0–10) en un **radar regular** (hexágono). Cada vértice corresponde a uno de los **seis pilares**: Entorno económico, Laboral, Infraestructura, Salud, Educación e Instituciones. La figura admite **comparar varias regiones** superponiendo sus polígonos (lo ideal son **3–6** para una lectura nítida).\n\n### **Introducción**\n\n`general_radar()` resuelve la necesidad de **comparar perfiles** de competitividad por pilar entre regiones en un corte temporal único. Mientras un ranking por pilar ordena y un mapa localiza, la telaraña muestra la **forma** del desempeño: regiones con **perfiles equilibrados** (polígonos cercanos a un círculo) frente a otras con **fortalezas** y **debilidades** marcadas (polígonos “deformados” hacia ciertos vértices).\n\nLa función puede **seleccionar automáticamente** tres casos representativos (\"AUTO3\", por defecto): **bajo**, **medio** y **alto** según el **promedio simple de los seis pilares**. Internamente, obtiene los puntajes con ind_tabla(ediciones = edicion, modo = \"pilares\", largo = TRUE) y los proyecta en coordenadas cartesianas para dibujar **lados rectos**, facilitando la comparación visual.\n\n### **Parámetros**\n\nTrabajar con general_radar() implica decidir: (i) **qué edición** se dibuja, (ii) **qué regiones** se comparan (automáticas, subconjuntos, grupos), y (iii) **cómo** presentar la figura (paleta, transparencia de relleno, puntos y formato de etiquetas de ejes). A continuación, los argumentos clave con sus opciones.\n\n-   **edicion**: define la **edición (año)** de la que se tomarán los puntajes por pilar.\n\n    Opciones y formato:\n\n    -   integer(1)\n\n    -   Rango típico del INCORE: 2016 … 2025\n\n-   **regiones**: controla **qué regiones** se superponen en el radar.\n\n    Opciones y formato:\n\n    -   \"AUTO3\" (por defecto): selección automática de **3** regiones representativas (**bajo/medio/alto**) según el **promedio** de los seis pilares.\n\n    -   NULL: **todas** las regiones (no recomendado por legibilidad).\n\n    -   Vector con nombres/códigos: c(\"Arequipa\", \"Cusco\", \"La Libertad\") o c(\"ARE\", \"CUS\", \"LAL\").\n\n    -   Puede incluir **grupos gr\\_\\*** cuando estén disponibles en tu ecosistema (p. ej., \"gr_costa\"), combinados con regiones puntuales.\n\n-   **max_regiones**: establece el **umbral de advertencia** por **legibilidad**.\n\n    Opciones y formato:\n\n    -   numeric(1), por defecto 6.\n\n    -   Si el número de regiones supera este valor, se emite una **advertencia** (no detiene el gráfico).\n\n-   **alpha**: controla la **transparencia del relleno** de los polígonos (0–1).\n\n    Opciones y formato:\n\n    -   0.25 (por defecto)\n\n    -   Valores mayores ⇒ **más opaco**, valores menores ⇒ **más transparente**.\n\n-   **paleta**: define la paleta **cualitativa** para colorear **por región**.\n\n    Opciones y formato:\n\n    -   \"ipe\" (por defecto, institucional)\n\n    -   \"okabe_ito\" (accesible para daltonismo)\n\n    -   \"viridis\" (perceptualmente uniforme, aunque concebida para continuas, también útil aquí por contraste)\n\n-   **mostrar_puntos**: decide si **marcar puntos** en los **vértices** de cada polígono (un punto por pilar).\n\n    Opciones y formato:\n\n    -   TRUE (por defecto)\n\n    -   FALSE (limpia el gráfico cuando hay muchas regiones)\n\n-   **etiquetas_pilares**: controla el **formato** de las **etiquetas** en los ejes del radar.\n\n    Opciones y formato:\n\n    -   \"corto\" (por defecto, quiebres de línea pensados para encajar mejor)\n\n    -   \"largo\" (nombres completos en una sola línea)\n\n### **Explicación conceptual**\n\nLa función **lee** los puntajes por pilar de la **edición** indicada (escala 0–10) y establece un **orden canónico** de pilares para la disposición **hexagonal**. Si regiones = \"AUTO3\", computa el **promedio de pilares** por región y selecciona automáticamente **tres** casos representativos (mínimo, mediana, máximo). Si se pasa un vector específico (o grupos gr\\_\\*), filtra a esas regiones.\n\nCada pilar se mapea a un **ángulo fijo** del hexágono y el puntaje actúa como **radio**, pero la proyección es a **coordenadas cartesianas** para dibujar **lados rectos**. Se añade una **rejilla** de referencia (por ejemplo, 2–4–6–8–10) y los **ejes** desde el centro a cada vértice con **etiquetas** cortas o largas. La **paleta cualitativa** asigna color por región y el **relleno** con alpha permite ver solapes al comparar.\n\nEn la lectura, **polígonos amplios** sugieren **desempeño alto** generalizado, **deformaciones** hacia un vértice indican **fortalezas** específicas, **huecos** o retracciones señalan **áreas a mejorar**. Limitar el número de regiones maximiza la **interpretabilidad**.\n\n### **Ejemplos**\n\n#### **1) Selección automática de 3 regiones (\"AUTO3\") — configuración básica**\n\n**Se desea lo siguiente:** comparar **tres** perfiles representativos (bajo/medio/alto) en la edición 2025 con formato legible por defecto.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr1 <- general_radar(\n  edicion  = 2025,\n  paleta   = \"ipe\",\n  alpha    = 0.25,\n  mostrar_puntos    = TRUE,\n  etiquetas_pilares = \"corto\"\n)\nr1\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-52-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Un radar con **tres polígonos**: uno “retraído” (bajo), otro intermedio y otro “expandido” (alto), facilitando la comparación pedagógica.\n\n#### **2) Subconjunto explícito de regiones**\n\n#### **Se desea lo siguiente:** comparar **tres** regiones específicas usando una paleta accesible y nombres completos en los ejes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr2 <- general_radar(\n  edicion  = 2025,\n  regiones = c(\"Arequipa\", \"Cusco\", \"La Libertad\"),\n  paleta   = \"okabe_ito\",\n  alpha    = 0.30,\n  mostrar_puntos    = TRUE,\n  etiquetas_pilares = \"largo\"\n)\nr2\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-53-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Tres polígonos con **alto contraste cromático** y ejes con **etiquetas**\n\n#### **3) Uso de grupos gr (combinación con región puntual) y mayor transparencia**\n\n**Se desea lo siguiente:** contrastar un grupo regional con una región puntual, reduciendo opacidad para ver mejor solapes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr3 <- general_radar(\n  edicion  = 2025,\n  regiones = c(\"gr_costa\", \"-Arequipa\", \"-Lima*\", \n               \"-Lima Provincias\", \"-Ica\", \"-Moquegua\"),\n  paleta   = \"viridis\",\n  alpha    = 0.18,\n  mostrar_puntos    = TRUE,\n  etiquetas_pilares = \"corto\"\n)\nr3\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-54-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** El polígono agregado del **grupo** (si tu ecosistema expande gr_costa a sus integrantes y filtra)\n\n#### **4) Comparación ampliada con advertencia de legibilidad**\n\n**Se desea lo siguiente:** incluir **ocho** regiones (por encima del umbral por defecto) para evaluar la **advertencia** y el comportamiento visual.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr4 <- general_radar(\n  edicion  = 2025,\n  regiones = c(\"Arequipa\", \"Cusco\", \"La Libertad\",\n               \"Piura\", \"Lambayeque\", \"Tacna\",\n               \"Junín\", \"Puno\"),\n  paleta   = \"ipe\",\n  alpha    = 0.20,\n  mostrar_puntos    = FALSE,   ## sin puntos para reducir ruido\n  etiquetas_pilares = \"corto\"     \n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in general_radar(edicion = 2025, regiones = c(\"Arequipa\", \"Cusco\", :\nEstás comparando 8 regiones. Para un radar legible, considera ≤ 6 (ideal 3–4).\n```\n\n\n:::\n\n```{.r .cell-code}\nr4\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-55-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** El gráfico **se renderiza** y muestra los ocho polígonos, pero aparece una **advertencia** por legibilidad. Se sugiere, para análisis fino, reducir el conjunto o segmentar en dos gráficos.\n\n### **5) Comparación focalizada con AUTO3 y estilo sin puntos**\n\n**Se desea lo siguiente:** producir una figura **limpia** (sin puntos) con la selección automática AUTO3, ajustando la transparencia para enfatizar formas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr5 <- general_radar(\n  edicion  = 2025,\n  regiones = \"AUTO3\",\n  paleta   = \"ipe\",\n  alpha    = 0.35,\n  mostrar_puntos    = FALSE,   ## limpia vértices para destacar contornos\n  etiquetas_pilares = \"corto\"\n)\nr5\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-56-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Tres polígonos con contornos nítidos y relleno intermedio.\n\n# Familia `indc_` y `valor_`\n\n## **indc_tabla(): indicadores por pilar (puntajes 0–10)**\n\n### **Descripción de parámetros**\n\n-   ediciones: vector numérico con una o más ediciones. Acepta formas como 2025 o 2018:2025.\n\n-   pilar: cadena con el pilar en **código** (\"LAB\") o **nombre** (\"Laboral\").\n\n-   indicadores: \"ALL\" (todos los indicadores del pilar, salvo \"General\"), o un vector de **códigos** (p. ej., \"LAB2\") y/o **nombres** (p. ej., \"2.2 Formalidad laboral\").\n\n-   regiones: \"ALL\" o vector de **códigos/nombres** y **grupos** (p. ej., \"gr_costa\"), con **exclusiones** mediante prefijo \"-\" (p. ej., \"-Lima\\*\").\n\n-   usar_codigos: (mencionado) controla traducir códigos ↔ nombres en filtros.\n\n-   incluir_peru: (mencionado) si se desea mantener la fila **“Perú”**.\n\n-   largo: TRUE devuelve **formato largo** (region, edicion, indicador, valor, usando **código** cuando esté disponible), FALSE devuelve **ancho**.\n\n-   gt: TRUE produce una tabla **gt** con *spanners* por edición, FALSE devuelve **tibble**.\n\n-   verbose: TRUE imprime mensajes informativos.\n\n### **Explicación conceptual**\n\nLa función filtra la base por **pilar** y **ediciones**, descarta la fila “Perú” (salvo que se pida), y elimina el indicador **“General”** (a menos que se solicite todo). Luego **promedia** internamente si aparecen duplicados esporádicos y **redondea** a dos decimales. En salida **ancha**, las columnas se nombran como CODIGO_EDICION (por ejemplo, LAB2_2025), si un indicador no tiene código disponible, se genera un nombre limpio a partir del título del indicador.\n\n### **Ejemplos**\n\n1.  **Tabla ancha** con todos los indicadores de un pilar en un rango de años\n\n**Se desea lo siguiente:** obtener, para el pilar LAB, una **tabla por regiones** con dos indicadores en **columnas** para las ediciones **2019–2025**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab1 <- indc_tabla(\n  ediciones    = 2019:2020,\n  pilar        = \"LAB\",\n  indicadores  = \"LAB3\",\n  regiones     = \"ALL\", \n  largo        = FALSE\n)\ntab1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 3\n   region       LAB3_2019 LAB3_2020\n   <chr>            <dbl>     <dbl>\n 1 Amazonas          2.27      2.66\n 2 Apurímac          2.67      3.52\n 3 Arequipa          6.94      7.49\n 4 Ayacucho          3.25      3.23\n 5 Cajamarca         0.16      1.64\n 6 Cusco             4.92      5.31\n 7 Huancavelica      2.14      0.77\n 8 Huánuco           1.87      2.37\n 9 Ica               7.38      8.48\n10 Junín             4.05      4.66\n# ℹ 15 more rows\n```\n\n\n:::\n:::\n\n\n\n\n> Se espera un tibble con columnas tipo LAB1_2019, LAB1_2020 por región.\n\n2.  **Formato largo** para graficar con ggplot2\n\n**Se desea lo siguiente:** obtener datos **largos** del pilar ECO en **2025**, listos para facetear por indicador.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_long <- indc_tabla(\n  ediciones    = 2025,\n  pilar        = \"ECO\",\n  indicadores  = \"ALL\",\n  regiones     = \"ALL\",\n  largo        = TRUE,\n)\ntab_long |> \n  head(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n   region   edicion indicador valor\n   <chr>      <int> <chr>     <dbl>\n 1 Amazonas    2025 ECO1       1.28\n 2 Amazonas    2025 ECO2       2.52\n 3 Amazonas    2025 ECO3       3.78\n 4 Amazonas    2025 ECO4       0.45\n 5 Amazonas    2025 ECO5       9.11\n 6 Amazonas    2025 ECO6       2.88\n 7 Amazonas    2025 ECO7       3.84\n 8 Apurímac    2025 ECO1       3   \n 9 Apurímac    2025 ECO2       2.52\n10 Apurímac    2025 ECO3       2.8 \n```\n\n\n:::\n:::\n\n\n\n\n> Se espera region, edicion, indicador y valor (0–10).\n\n3.  **Selección de indicadores por código y nombre**\n\n**Se desea lo siguiente:** limitar a **tres** indicadores del pilar LAB en **2024–2025** (mezclando código y nombre).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsel <- c(\"LAB1\", \"2.2 Formalidad laboral\", \"LAB5\")\n\ntab_sel <- indc_tabla(\n  ediciones    = 2025,\n  pilar        = \"LAB\",\n  indicadores  = sel,\n  regiones     = \"ALL\",\n  usar_codigos = TRUE\n)\ntab_sel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 4\n   region       LAB1_2025 LAB2_2025 LAB5_2025\n   <chr>            <dbl>     <dbl>     <dbl>\n 1 Amazonas          2.15      3.99      3.12\n 2 Apurímac          3.44      3.53      2.81\n 3 Arequipa          8.68      7.43     10   \n 4 Ayacucho          2.78      0.9       1.47\n 5 Cajamarca         3.49      3.4       2.64\n 6 Cusco             3.1       4.62      3.99\n 7 Huancavelica      1.51      3.38      3.16\n 8 Huánuco           2.79      3.8       1.93\n 9 Ica               5.7       4.95      7.78\n10 Junín             4.21      4.02      5.39\n# ℹ 15 more rows\n```\n\n\n:::\n:::\n\n\n\n\n> Se espera una **tabla ancha** únicamente con las columnas de esos **indicadores×edición**.\n\n4.  **Con grupos y exclusiones de regiones**\n\n**Se desea lo siguiente:** incluir **Costa** y **Sierra**, **excluyendo** Lima Metropolitana, para LAB en **2025**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_reg <- indc_tabla(\n  ediciones    = 2025,\n  pilar        = \"LAB\",\n  indicadores  = c(\"LAB4\", \"LAB5\", \"LAB6\"),\n  regiones     = c(\"gr_costa\", \"gr_sierra\", \"-Lima*\")\n)\ntab_reg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 19 × 4\n   region          LAB4_2025 LAB5_2025 LAB6_2025\n   <chr>               <dbl>     <dbl>     <dbl>\n 1 Apurímac             7.03      2.81      7.37\n 2 Arequipa             5.85     10         5.89\n 3 Ayacucho             6         1.47      7.53\n 4 Cajamarca            5.84      2.64      4.82\n 5 Cusco                7.24      3.99      8.61\n 6 Huancavelica         7.97      3.16      9.31\n 7 Huánuco              5         1.93      4.39\n 8 Ica                  6.28      7.78      5.93\n 9 Junín                7.86      5.39      6.93\n10 La Libertad          6.21      5.51      3.5 \n11 Lambayeque           4.83      5.42      3.95\n12 Lima Provincias      6.08      5.55      4.64\n13 Moquegua             5.56      8.99      6.56\n14 Pasco                6.15      5.62      4.12\n15 Piura                5.83      3.81      3.25\n16 Puno                 5.01      3.98      8.69\n17 Tacna                3.22      6.46      5.75\n18 Tumbes               2.97      4.74      2.56\n19 Áncash               5.99      4.55      5.34\n```\n\n\n:::\n:::\n\n\n\n\n> Se espera una tabla por **regiones filtradas**, Lima\\* queda excluida.\n\n5.  **Salida gt con spanners por edición**\n\n**Se desea lo siguiente:** una **tabla presentable** para el pilar LAB en **2024–2025**, con encabezados por edición.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_gt <- indc_tabla(\n  ediciones    = 2024:2025,\n  pilar        = \"LAB\",\n  indicadores  = \"ALL\",\n  regiones     = \"ALL\",\n  gt           = TRUE\n)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](trem.png){fig-align='center' fig-pos='H' width=90%}\n:::\n:::\n\n\n\n\n> Se espera una **tabla gt** con *spanners* por edición y números a 2 decimales.\n\n¿Así, tal cual, te sirve para pegarlo directo a tu Quarto? Si quieres, armo la subsección de **valores** (valor_tabla) con el mismo patrón.\n\n## **valor_tabla(): valores originales por indicador (con unidad/fuente)**\n\n### **Descripción de parámetros**\n\n-   ediciones: vector numérico con una o más ediciones. Acepta formas como 2025 o 2018:2025.\n\n-   pilar: cadena con el pilar en **código** (\"ECO\") o **nombre** (\"Entorno económico\").\n\n-   indicadores: \"ALL\" (todos los del pilar) o vector de **códigos/nombres**, admite entradas que **empiezan en número** (p. ej., \"3\" o \"3.1 ...\") mapeadas a ECO3 dentro del pilar.\n\n-   regiones: \"ALL\" o vector de **códigos/nombres**, también puede usar **grupos** y **exclusiones** (si los helpers de tu paquete lo permiten en valores).\n\n-   usar_codigos: (mencionado) controla traducciones en filtros.\n\n-   incluir_peru: (mencionado) si se desea mantener **“Perú”**.\n\n-   largo: TRUE devuelve **formato largo** con region, edicion, indicador, valor, unidad, fuente, FALSE devuelve **ancho**.\n\n-   gt: TRUE produce **gt** con *spanners* por edición, FALSE devuelve **tibble**.\n\n-   verbose: TRUE imprime mensajes informativos.\n\n### **Explicación conceptual**\n\nA diferencia de indc_tabla(), esta función trabaja con **valores originales** (no normalizados a 0–10). Por diseño **excluye** unidad == \"Puntaje del 0 al 10\". Resuelve los **indicadores** contra un catálogo (code ↔ name), acepta atajos como “3” dentro del pilar (→ ECO3/LAB3 según corresponda), y **promedia** si existen duplicados esporádicos. En salida ancha, las columnas se nombran como CODIGO_EDICION (o un nombre limpio cuando el código no esté disponible). La salida larga conserva **unidad** y **fuente**, lo que resulta útil para rótulos y *captions* de gráficos.\n\n### **Ejemplos**\n\n1.  **Valores anchos para un pilar en múltiples ediciones**\n\n**Se desea lo siguiente:** obtener los **valores (no puntaje)** del pilar **ECO** entre **2020–2025** para **todas** las regiones, en formato ancho.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nval1 <- valor_tabla(ediciones = 2020:2025, \n                    pilar = \"ECO\",\n                    indicadores = \"ECO1\")\nval1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 25 × 7\n   region       ECO1_2020 ECO1_2021 ECO1_2022 ECO1_2023 ECO1_2024 ECO1_2025\n   <chr>            <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>\n 1 Amazonas          3.50      3.48      3.49      3.49      3.49      3.48\n 2 Apurímac          3.86      3.81      3.82      3.80      3.83      3.86\n 3 Arequipa          4.50      4.42      4.48      4.50      4.50      4.50\n 4 Ayacucho          3.77      3.72      3.76      3.78      3.77      3.79\n 5 Cajamarca         4.06      4.01      4.06      4.08      4.07      4.08\n 6 Cusco             4.34      4.29      4.31      4.33      4.35      4.35\n 7 Huancavelica      3.55      3.52      3.54      3.54      3.54      3.59\n 8 Huánuco           3.78      3.74      3.78      3.79      3.82      3.84\n 9 Ica               4.25      4.19      4.29      4.32      4.32      4.33\n10 Junín             4.19      4.14      4.20      4.21      4.20      4.20\n# ℹ 15 more rows\n```\n\n\n:::\n:::\n\n\n\n\n**Se espera:** un tibble por región con columnas tipo ECO3_2020, ECO3_2021, … (una columna por combinación indicador×edición).\n\n2.  **Formato largo con unidad y fuente**\n\n**Se desea lo siguiente:** obtener un **dataset largo** del pilar **ECO** en **2025**, listo para anotar **unidades** y **fuentes** en gráficos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nval_long <- valor_tabla(ediciones = 2025, \n                        pilar = \"ECO\", \n                        largo = TRUE)\nhead(val_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  region   edicion indicador                                 valor unidad fuente\n  <chr>      <int> <chr>                                     <dbl> <chr>  <chr> \n1 Amazonas    2025 1.1 PBI real en logaritmos                 3.48 Millo… INEI.…\n2 Amazonas    2025 1.2 Trabajadores en grandes empresas (m…  12.5  Porce… INEI.…\n3 Amazonas    2025 1.3 Gasto real pre cápita mensual        799.   Soles… INEI-…\n4 Amazonas    2025 1.4 Apertura externa                       5.12 Expor… Adex …\n5 Amazonas    2025 1.5 Tenencia de cuentas                   63.8  Porce… INEI-…\n6 Amazonas    2025 1.6 Acceso al crédito                     22.1  Porce… SBS. …\n```\n\n\n:::\n:::\n\n\n\n\n**Se espera:** columnas region, edicion, indicador (código si existe), valor, unidad, fuente.\n\n3.  **Selección explícita de indicadores con mezcla de formatos**\n\n**Se desea lo siguiente:** para **ECO** en **2024–2025**, limitarse a los indicadores **ECO3** y **ECO7** usando **gt**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninds    <- c(\"ECO3\", \"ECO7\")\nval_sel <- valor_tabla(ediciones    = 2024:2025,\n                       regiones     = \"gr_norte\",\n                       pilar        = \"ECO\", \n                       indicadores  = inds,\n                       gt           = TRUE\n                       )\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](tabla.png){fig-align='center' fig-pos='H' width=90%}\n:::\n:::\n\n\n\n\n**Se espera:** resolución que mapea “3.1 …” a ECO3 (si aplica en el catálogo) y columnas **solo** de los indicadores seleccionados×edición.\n\n4.  **Filtrado regional con exclusiones e inclusión de Perú**\n\n**Se desea lo siguiente:** obtener **ECO (2025)** solo para **Costa** y **Macro Norte**, **excluyendo Lima\\*** e **incluyendo Perú**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nval_reg <- valor_tabla(\n  ediciones   = 2025,\n  pilar       = \"ECO\",\n  regiones    = c(\"gr_costa\", \"gr_macro_norte\", \"-Lima*\"),\n  incluir_peru = TRUE\n)\nval_reg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 8\n   region  ECO1_2025 ECO2_2025 ECO3_2025 ECO4_2025 ECO5_2025 ECO6_2025 ECO7_2025\n   <chr>       <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>\n 1 Arequi…      4.50      18.3     1074.     42.3       63.9      38.0      25.2\n 2 Ica          4.33      23.4     1117.     67.5       62.0      33.5      31.3\n 3 La Lib…      4.40      17.4      933.     40.6       52.0      26.8      28.6\n 4 Lambay…      4.13      16.1     1038.     15.9       54.5      33.4      30.7\n 5 Lima P…      4.28      19.1      871.     18.0       55.7      26.3      36.5\n 6 Moqueg…      4.14      25.4     1164.    104.        68.3      35.8      25.7\n 7 Piura        4.33      15.9      848.     28.7       50.9      29.7      23.6\n 8 Tacna        3.95      15.6      915.     14.5       46.0      34.9      18.5\n 9 Tumbes       3.48      15.6      867.      5.71      48.8      30.8      26.6\n10 Áncash       4.33      14.7      904.     58.1       49.4      23.9      23.0\n```\n\n\n:::\n:::\n\n\n\n\n**Se espera:** que aparezca la fila **“Perú”** y se apliquen correctamente los **grupos** y **exclusiones**.\n\n5.  **Salida gt con spanners por edición para reporte**\n\n**Se desea lo siguiente:** presentar en un informe los **valores** de **LAB3 (2023–2025)** como **tabla gt** con encabezados por edición.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nval_gt <- valor_tabla(ediciones = 2022:2025, \n                      pilar = \"LAB\", \n                      indicadores = \"LAB3\",\n                      gt = TRUE)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](vuru.png){fig-align='center' fig-pos='H' width=90%}\n:::\n:::\n\n\n\n\n**Se espera:** una **tabla gt** con formateo numérico y **spanners** por edición (“Edición 2023”, “Edición 2024”, “Edición 2025”).\n\n## **Barras por región para un indicador(indc_barras) y para su valor (valor_barras)**\n\n-   indc_barras() grafica el **puntaje (0–10)** del indicador, coherente con la escala estandarizada del índice.\n\n-   valor_barras() grafica el **valor original** del indicador (no estandarizado), mostrando en el eje la **unidad propia** y en el *caption* la **fuente**.\n\n### **Parámetros**\n\nPara un uso práctico y consistente, conviene definir **edición**, **indicador** (por código o nombre) y, cuando sea necesario, el **pilar** para desambiguar. El filtrado por regiones admite **grupos** gr\\_\\* y **exclusiones** con prefijo \"-\". En ambos casos, usar_codigos (siempre que sea TRUE) facilita traducir códigos a nombres oficiales **antes** del filtrado, incluir_peru añade o no la fila “Perú” (promedio nacional). Estos dos se tratan como secundarios y no aparecen en las viñetas.\n\n### **indc_barras: puntaje (0–10) de un indicador**\n\n-   edicion: **edición** a graficar.\n\n    -   Opciones válidas: 2016 … 2025 (p.ej., 2025).\n\n-   pilar: **pilar** al que pertenece el indicador.\n\n    -   Formatos aceptados: código \"ECO\"/\"LAB\"/… o nombre \"Entorno económico\"/\"Laboral\"/…\n\n    -   Puede omitirse si indicador **identifica unívocamente**.\n\n-   indicador: **indicador** a graficar.\n\n    -   Formatos aceptados: código (p.ej., \"LAB2\") o nombre completo (p.ej., \"2.2 Formalidad laboral\").\n\n    -   Recomendado **especificarlo** para evitar ambigüedades.\n\n-   regiones: universo de **regiones** a incluir.\n\n    -   \"ALL\" (todas)\n\n    -   Listas por nombre/código (p.ej., c(\"Arequipa\",\"Cusco\") o c(\"ARE\",\"CUS\"))\n\n    -   **Grupos**: \"gr_costa\", \"gr_sierra\", \"gr_selva\"\n\n    -   **Exclusiones** por patrón: p.ej., \"-Lima\\*\"\n\n    -   Combinables: c(\"gr_costa\",\"-Lima\\*\",\"La Libertad\")\n\n-   paleta: esquema de color cualitativo por región.\n\n    -   \"ipe\" (por defecto), \"okabe_ito\", \"viridis\"\n\n-   mostrar_leyenda: control de la leyenda.\n\n    -   FALSE (por defecto) o TRUE\n\n### **valor_barras(): valor original del indicador (no puntaje)**\n\n-   edicion: **edición** a graficar.\n\n    -   Opciones válidas: 2016 … 2025 (p.ej., 2024).\n\n-   pilar: **pilar** del indicador (código o nombre).\n\n    -   Puede omitirse si indicador **es único** en la edición/filtro.\n\n-   indicador: **indicador** a graficar.\n\n    -   Código (p.ej., \"ECO7\") o nombre (p.ej., \"1.7 Billeteras digitales\").\n\n    -   El título puede rotularse por **código** o **nombre** con label_indicador.\n\n-   regiones: universo de **regiones** a incluir.\n\n    -   \"ALL\", listas por nombre/código, **grupos** gr\\_\\*, **exclusiones** con \"-\" (mismos patrones que arriba).\n\n-   paleta: esquema de color cualitativo por región.\n\n    -   \"ipe\", \"okabe_ito\", \"viridis\"\n\n-   mostrar_leyenda: control de la leyenda.\n\n    -   FALSE (por defecto) o TRUE\n\n-   label_indicador: cómo **rotular** el indicador en el título.\n\n    -   \"nombre\" (por defecto) o \"cod\"\n\n### **Explicación conceptual**\n\nAmbas funciones **leen** la edición indicada, **normalizan** cadenas clave y aplican filtros defensivos:\n\n-   `indc_barras()` retiene **puntajes 0–10** del indicador seleccionado, consolida a **un valor por región** (promedios defensivos ante duplicados), **ordena** de mayor a menor y **colorea** por región con paletas predefinidas. Es ideal para **ranking** dentro de un indicador concreto.\n\n-   `valor_barras()` trabaja con la **magnitud observada** del indicador (no el puntaje), respeta la **unidad** original en el eje y añade la **fuente** como *caption*, con el mismo enfoque de **consolidación** y **orden**. Permite interpretar **qué significa** una diferencia de valores en términos sustantivos (por ejemplo, tasas, montos, porcentajes).\n\n### **Ejemplos**\n\n#### **1) Puntaje 0–10 de un indicador por región (básico)**\n\n**Se desea lo siguiente:** graficar el **puntaje** del indicador (código) en la edición 2025 para **todas** las regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_barras(\n  edicion   = 2025,\n  pilar     = \"LAB\",\n  indicador = \"LAB2\",\n  regiones  = \"ALL\",\n  paleta    = \"ipe\",\n  mostrar_leyenda = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-73-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Barras horizontales ordenadas (0–10), una por región, con etiquetas de valor y estilo del paquete.\n\n#### **2) Puntaje por grupo costero con exclusión de un patrón**\n\n**Se desea lo siguiente:** comparar el **puntaje** del indicador por las **regiones de la costa**, excluyendo las que empiecen con “Lima\\*”.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_barras(\n  edicion   = 2025,\n  pilar     = \"ECO\",\n  indicador = \"ECO7\",\n  regiones  = c(\"gr_costa\", \"-Lima*\"),\n  paleta    = \"okabe_ito\",\n  mostrar_leyenda = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-74-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Barras para el subconjunto costero **sin** Lima\\*, útiles para contrastes regionales enfocados.\n\n#### **3) Valor original del indicador con unidad en el eje**\n\n**Se desea lo siguiente:** graficar el **valor** del indicador (no puntaje) para 2024, mostrando la **unidad** en el eje y la **fuente** automática.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_barras(\n  edicion   = 2024,\n  pilar     = \"ECO\",\n  indicador = \"ECO7\",\n  regiones  = \"ALL\",\n  paleta    = \"ipe\",\n  mostrar_leyenda = FALSE,\n  label_indicador = \"nombre\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-75-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Barras con eje rotulado según la **unidad corta** del indicador, ordenadas de mayor a menor.\n\n#### **4) Valor del indicador para un subconjunto mixto y con “Perú”**\n\n**Se desea lo siguiente:** comparar valores en regiones específicas **más** un grupo, **incluyendo “Perú”** para referencia.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_barras(\n  edicion       = 2024,\n  indicador     = \"1.7 Billeteras digitales\",\n  regiones      = c(\"Arequipa\", \"La Libertad\", \"gr_sierra\"),\n  incluir_peru  = TRUE,\n  paleta        = \"viridis\",\n  mostrar_leyenda = TRUE,\n  label_indicador = \"cod\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-76-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Barras para el conjunto mixto (regiones explícitas + grupo), **con** la fila “Perú”, paleta continua cualitativa y rótulo del título por **código**.\n\n#### **5) Puntaje por indicador identificado**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_barras(\n  edicion   = 2025,\n  indicador = \"2.2 Formalidad laboral\",  # ejemplo de nombre completo\n  regiones  = c(\"gr_selva\", \"Cusco\"),\n  paleta    = \"ipe\",\n  mostrar_leyenda = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-77-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Barras por región del **puntaje** (0–10) para el indicador identificado por **nombre**, si el nombre no es único fuera del pilar, el pilar desambiguará correctamente.\n\n## **Líneas por indicador (valor_largo) y por puntaje (indc_largo)**\n\n-   valor_largo() grafica la **evolución de valores originales** (no puntajes) de uno o varios indicadores de un pilar a lo largo de **múltiples ediciones**. Rotula cada facet con **código o nombre** y añade **unidad** al panel (cuando se elige por código).\n\n-   indc_largo() grafica la **evolución del puntaje (0–10)** por **indicador** de un pilar, también en **varias ediciones**, con facets por indicador (rotulados por **nombre** completo o **código**).\n\n### **Parámetros: decisiones clave**\n\n**Comunes**\n\n-   ediciones: rango con **≥ 2** años (p.ej., 2019:2025).\n\n-   pilar: código \"ECO\"/\"LAB\"/… o nombre \"Entorno económico\"/\"Laboral\"/….\n\n-   indicadores: \"ALL\" o mezcla de **códigos y nombres**, en valor_largo().\n\n-   regiones: \"ALL\", lista de nombres/códigos, y combinaciones con **grupos** gr\\_\\* y **exclusiones** con \"-\".\n\n-   usar_codigos: si TRUE, traduce códigos **antes** de filtrar.\n\n-   facetear: si TRUE, genera **facets por indicador**, útil cuando hay varios.\n\n**Sólo en valor_largo()**\n\n-   paleta: \"ipe\", \"okabe_ito\", \"viridis\".\n\n-   mostrar_puntos: puntos sobre las líneas.\n\n-   label_indicador: \"codigo\" (default) o \"nombre\" para el rótulo del facet.\n\n**Sólo en indc_largo()**\n\n-   facet_label_nombre: TRUE (default) rotula los facets con **“d.d nombre completo”**, FALSE usa el **código** (“EDU3”).\n\n-   paleta, mostrar_puntos: iguales que arriba.\n\n### **Explicación conceptual**\n\n-   valor_largo() trabaja con la **magnitud observada** (no estandarizada). Filtra **valores ≠ puntaje**, mapea **código↔nombre** con el catálogo y arma **etiquetas de facet** (código o nombre + **unidad corta**). Ideal para interpretar cambios **sustantivos** (tasas, montos, porcentajes) por indicador y región en el tiempo.\n\n-   indc_largo() se limita al **puntaje 0–10** (estandarizado), excluye \"General\" y **“Perú”** por defecto, y consolida a **un valor por (región, edición, indicador)**. Útil para comparar **trayectorias relativas** entre regiones manteniendo la **misma escala**.\n\n### **Ejemplos**\n\n#### **A) Valores originales con valor_largo()**\n\n1.  **Varios indicadores (auto) en un rango de años**\n\n**Se desea lo siguiente:** graficar la **evolución de valores** de **todos** los indicadores del pilar ECO (2020–2025) para **todas** las regiones, con facets automáticos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_largo(\n  ediciones      = 2020:2025,\n  pilar          = \"ECO\",\n  indicadores    = \"ALL\",\n  regiones       = \"ALL\",\n  facetear       = TRUE,\n  paleta         = \"ipe\",\n  mostrar_puntos = TRUE,\n  label_indicador = \"codigo\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-78-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Paneles por indicador (ECO1, ECO2, …) con líneas por región, el rótulo muestra **código + unidad**.\n\n2.  **Selección mixta de indicadores**\n\n**Se desea lo siguiente:** graficar sólo **ECO3** en 2016–2025.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_largo(\n  ediciones   = 2016:2025,\n  pilar       = \"ECO\",\n  indicadores = c(\"ECO2\"),\n  regiones    = \"gr_sur\",\n  facetear    = TRUE,\n  paleta      = \"okabe_ito\",\n  label_indicador = \"nombre\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-79-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Facets sólo de los tres indicadores solicitados, los que empiezan con “3.1 …” se **mapean a ECO3** si corresponde.\n\n3.  **Subconjunto regional con exclusiones**\n\n**Se desea lo siguiente:** graficar valores de **LAB (ALL)** en 2019–2025 para la **Costa** y la **Macro Norte**, **excluyendo** “Lima\\*”.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_largo(\n  ediciones   = 2019:2025,\n  pilar       = \"LAB\",\n  indicadores = \"ALL\",\n  regiones    = c(\"gr_costa\", \"gr_norte\", \"-Lima*\"),\n  paleta      = \"viridis\",\n  facetear    = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-80-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Líneas sólo para las regiones filtradas, Lima\\* no aparece en los paneles.\n\n#### **B) Puntajes 0–10 con indc_largo()**\n\n1.  **Todos los indicadores de un pilar (puntaje) en varios años**\n\n**Se desea lo siguiente:** graficar la **evolución del puntaje (0–10)** de todos los **indicadores** del pilar **EDU** (2018–2025), por región.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_largo(\n  ediciones          = 2018:2025,\n  pilar              = \"EDU\",\n  indicadores        = \"ALL\",\n  regiones           = \"gr_norte\",\n  facetear           = TRUE,\n  facet_label_nombre = TRUE,\n  paleta             = \"ipe\",\n  mostrar_puntos     = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-81-1.png){width=1152}\n:::\n:::\n\n\n\n\n2.  **Lista acotada de indicadores por código y nombre**\n\n**Se desea lo siguiente:** comparar sólo **LAB2** y **“2.5 …”** (por nombre) en 2020–2025.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_largo(\n  ediciones          = 2020:2025,\n  pilar              = \"LAB\",\n  indicadores        = c(\"LAB2\", \"2.5 Inserción laboral juvenil\"),\n  regiones           = \"ALL\",\n  facetear           = TRUE,\n  facet_label_nombre = FALSE,  # usar rótulo por código\n  paleta             = \"okabe_ito\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-82-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dos facets (códigos), con líneas de regiones y escala 0–10.\n\n3.  **Con grupos y exclusiones de regiones**\n\n**Se desea lo siguiente:** puntajes de **ECO** (indicadores ALL) en 2023–2025 para **Sierra** y **Selva**, excluyendo “Lima\\*”.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_largo(\n  ediciones   = 2023:2025,\n  pilar       = \"ECO\",\n  indicadores = \"ALL\",\n  regiones    = c(\"gr_sur\", \"gr_selva\", \"-Lima*\"),\n  paleta      = \"viridis\",\n  facetear    = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-83-1.png){width=1152}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Facets por indicador, sólo líneas de regiones pertenecientes a los grupos especificados, sin Lima\\*.\n\n## **Mapas por indicador (valor_mapa) y por puntaje (indc_mapa)**\n\n-   **valor_mapa()** colorea cada región por el **valor original** del indicador (no estandarizado). El eje/leyenda usa la **unidad propia** y el *caption* la **fuente**.\n\n-   **indc_mapa()** colorea por el **puntaje (0–10)** del indicador, en la misma escala estandarizada del índice.\n\n### **Parámetros: decisiones clave**\n\n**Comunes**\n\n-   **edicion**: un año (2016–2025), p.ej. 2025.\n\n-   **indicador**: código \"ECO3\", \"LAB2\"… o **nombre completo**.\n\n-   **pilar**: código \"ECO\"/\"LAB\"/… o nombre, **opcional** (se usa para validar coherencia).\n\n-   **regiones**: \"ALL\", lista de nombres/códigos y combinaciones con **grupos** gr\\_\\* y **exclusiones** \"-\" (mismos patrones que en otras funciones).\n\n-   **usar_codigos**: si TRUE, traduce códigos **antes** de filtrar.\n\n-   **mapa_sf**: objeto sf con region y geometry. Si NULL, se usa mapa_peru(simplificar=...).\n\n-   **simplificar**: tolerancia para mapa_peru(), 0 = sin simplificar.\n\n-   **zoom** y **expand_zoom**: acotan la vista al *bounding box* de las regiones con datos.\n\n-   **etiquetas**: \"repel\", \"texto\" o \"ninguna\" para rotular valores dentro del mapa.\n\n**Sólo en valor_mapa()**\n\n-   **paleta** (continua): \"blues\" (default), \"viridis\", \"cividis\", \"magma\".\n\n-   **subtitulo_nombre**: TRUE muestra **nombre** del indicador en el subtítulo, FALSE usa el **código**.\n\n**Sólo en indc_mapa()**\n\n-   **paleta** (continua): \"blues\", \"greens\", \"viridis\", \"cividis\", \"magma\", \"divergente\".\n\n-   **subtitulo_nombre**: TRUE rotula el subtítulo con **nombre**, FALSE con **código**.\n\n### **Explicación conceptual**\n\n-   **valor_mapa()** trabaja con la **magnitud observada** (no estandarizada): filtra valores ≠ “Puntaje del 0 al 10”, consolida a **un valor por región** (promedio defensivo), usa **escala continua** acorde al rango real del indicador, muestra **unidad completa** en subtítulo y **unidad corta** en la leyenda, y añade **fuente** en el *caption*.\n\n-   **indc_mapa()** se limita al **puntaje 0–10**, excluye \"Perú\" y \"General\", consolida por región y aplica paletas continuas en el rango \\[0,10\\]. Útil para comparar **posicionamiento relativo** entre regiones con la misma escala del índice.\n\n### **Ejemplos**\n\n#### **A) Mapas de valores originales con valor_mapa()**\n\n1.  **Indicador por código, todas las regiones**\n\n**Se desea lo siguiente:** colorear por el **valor** de ECO7 en **2025**, con etiquetas y paleta en azul.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_mapa(\n  edicion          = 2025,\n  indicador        = \"ECO7\",\n  regiones         = \"ALL\",\n  paleta           = \"blues\",\n  etiquetas        = \"repel\",\n  subtitulo_nombre = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-84-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Coropleta por región con leyenda en **unidad propia** (abreviada), subtítulo con nombre completo y *caption* con la(s) **fuente(s)**.\n\n2.  **Nombre de indicador + zoom a subconjunto regional**\n\n**Se desea lo siguiente:** mapear el valor de **“1.7 Billeteras digitales”** en 2024, sólo para **Costa** y **Norte**, excluyendo “Lima\\*”, y **zoom** al área.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_mapa(\n  edicion   = 2024,\n  indicador = \"1.7 Billeteras digitales\",\n  regiones  = c(\"gr_costa\", \"gr_norte\", \"-Lima*\"),\n  paleta    = \"viridis\",\n  etiquetas = \"texto\",\n  zoom      = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-85-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Mapa enfocado al subconjunto con etiquetas simples y leyenda continua en la unidad correspondiente.\n\n#### **B) Mapas de puntajes 0–10 con indc_mapa()**\n\n1.  **Indicador por código, paleta continua**\n\n**Se desea lo siguiente:** colorear por el **puntaje** de LAB2 en 2025 para **todas** las regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_mapa(\n  edicion          = 2025,\n  indicador        = \"LAB2\",\n  regiones         = \"ALL\",\n  paleta           = \"greens\",\n  etiquetas        = \"repel\",\n  subtitulo_nombre = FALSE  # subtítulo con código\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-86-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Coropleta en escala 0–10, subtítulo con **código**, etiquetas numéricas redondeadas.\n\n2.  **Indicador por nombre, con exclusiones y paleta alternativa**\n\n**Se desea lo siguiente:** puntaje del indicador **“2.2 Formalidad laboral”** en 2025, sólo **Selva**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_mapa(\n  edicion   = 2025,\n  indicador = \"2.2 Formalidad laboral\",\n  regiones  = c(\"gr_selva\", \"-Lima*\"),\n  paleta    = \"cividis\",\n  etiquetas = \"ninguna\",\n  zoom      = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-87-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Mapa con escala 0–10 y vista recortada al subconjunto, sin etiquetas sobre el mapa.\n\n## **Dispersión por indicador (indc_dispersion)**\n\n-   indc_dispersion() muestra, para **una edición** y un **pilar**, un diagrama de **dispersión** donde el eje X son los **códigos de indicadores** (p.ej., LAB2, LAB5, …) y cada punto es el **puntaje (0–10)** de una **región** en ese indicador.\n\n-   Filtra siempre a unidad == \"Puntaje del 0 al 10\", excluye \"General\" y, por defecto, **no** incluye “Perú”.\n\n### **Parámetros: decisiones clave**\n\n**Comunes**\n\n-   **edicion**: año único (2016–2025).\n\n-   **pilar**: código \"ECO\"/\"LAB\"/… o nombre \"Entorno económico\"/\"Laboral\"/….\n\n-   **regiones**: \"ALL\", lista de nombres/códigos, y combinaciones con **grupos** gr\\_\\* y **exclusiones** con \"-\" (p.ej., c(\"gr_costa\",\"-Lima\\*\")).\n\n-   **usar_codigos**: si TRUE, traduce códigos antes de filtrar.\n\n-   **paleta**: \"ipe\", \"okabe_ito\", \"viridis\".\n\n-   **mostrar_leyenda**: muestra/oculta la leyenda por región.\n\n**Promedio y dispersión**\n\n-   **mostrar_promedio**: si TRUE, agrega un **rombo** por indicador con el **promedio** regional.\n\n-   **promedio_shape / promedio_size / promedio_color / promedio_fill**: estilo del rombo.\n\n-   **jitter_width / jitter_height**: “apertura” horizontal/vertical de los puntos (útil para evitar solapes).\n\n### **Explicación conceptual**\n\nLa función consolida a **un valor por (región × indicador)** (promedio defensivo si hubiera duplicados), ordena el eje X por **código de indicador** y colorea por **región**. El rombo opcional indica la **posición promedio** por indicador, lo cual facilita ver **dispersión** y **asimetrías** entre regiones sobre la **misma escala (0–10)**.\n\n### **Ejemplos**\n\n#### **1) Dispersión básica por pilar para todas las regiones**\n\n**Se desea lo siguiente:** ver la dispersión de puntajes de **LAB** en **2025**, con promedio por indicador.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_dispersion(\n  edicion          = 2025,\n  pilar            = \"LAB\",\n  regiones         = \"ALL\",\n  paleta           = \"ipe\",\n  mostrar_promedio = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-88-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Eje X con LAB1, LAB2, …, puntos por región y rombos de promedio, eje Y en 0–10.\n\n#### **2) Con grupos y exclusiones de regiones, resaltando promedio**\n\n**Se desea lo siguiente:** comparar **ECO (2025)** sólo para **Costa** y **Selva**, excluyendo \"Lima\\*\", mantener el rombo de promedio.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_dispersion(\n  edicion          = 2025,\n  pilar            = \"ECO\",\n  regiones         = c(\"gr_costa\", \"gr_selva\", \"-Lima*\"),\n  paleta           = \"okabe_ito\",\n  mostrar_promedio = TRUE,\n  mostrar_leyenda  = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-89-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Puntos únicamente de las regiones filtradas, Lima\\* no aparece, rombos por indicador.\n\n#### **3) Sin promedio, controlando el jitter y ocultando leyenda**\n\n**Se desea lo siguiente:** para **EDU (2024)**, ocultar la leyenda, suprimir el promedio y ajustar la dispersión para evitar solapes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_dispersion(\n  edicion          = 2024,\n  pilar            = \"EDU\",\n  regiones         = \"ALL\",\n  paleta           = \"viridis\",\n  mostrar_promedio = FALSE,\n  jitter_width     = 0.12,\n  jitter_height    = 0.00,\n  mostrar_leyenda  = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-90-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Nube de puntos por región en cada EDU\\*, sin rombos, con mejor separación horizontal.\n\n## **Distribución por indicador (indc_distribucion)**\n\n-   indc_distribucion() muestra, para **una edición** y **un pilar**, la **distribución de puntajes (0–10)** por **indicador** entre regiones, como **boxplot** o **violin**. El eje X son **códigos** (p.ej., LAB1, LAB2, …), el eje Y es el **puntaje (0–10)**.\n\n-   Siempre excluye \"Perú\" y \"General\", y consolida a **un valor por (región, indicador)** mediante promedio defensivo si hubiera duplicados.\n\n### **Parámetros: decisiones clave**\n\n-   **edicion**: año único (p.ej., 2025).\n\n-   **pilar**: código \"ECO\"/\"LAB\"/… o nombre \"Entorno económico\"/\"Laboral\"/….\n\n-   **indicadores**: \"ALL\" (default) o vector de **códigos**/**nombres** (p.ej., c(\"LAB1\",\"Inserción laboral juvenil\")).\n\n-   **regiones**: \"ALL\" o vector, admite **grupos** gr\\_\\* y **exclusiones** con \"-\" (a través de los helpers de regiones de tu paquete).\n\n-   **usar_codigos**: si TRUE (default), permite pasar códigos en pilar/regiones/indicadores.\n\n-   **tipo**: \"boxplot\" (default) o \"violin\".\n\n-   **jitter**: TRUE para superponer puntos individuales (ruido controlado).\n\n-   **paleta**: \"blues\" (default), \"viridis\", \"cividis\" — aplicada **por indicador**.\n\n-   **linea_promedio**: TRUE dibuja línea horizontal con el **promedio global** de puntajes.\n\n-   **mostrar_leyenda**: FALSE (default). Útil activarla si quieres identificar el **relleno por indicador**.\n\n### **Explicación conceptual**\n\n-   La función trabaja solo con **puntajes estandarizados (0–10)** del INCORE, y **facilita comparar dispersión** entre regiones por indicador dentro del pilar.\n\n-   El **orden** de los indicadores en el eje X se define por la **mediana** de su distribución (desc), lo que ayuda a leer de mayor a menor desempeño típico.\n\n-   Con tipo = \"boxplot\" ves mediana, IQR y valores atípicos, con tipo = \"violin\" ves densidad. El jitter aporta granularidad por región.\n\n-   La **línea punteada** (linea_promedio) resume el nivel **promedio general** de puntajes.\n\n### **Ejemplos**\n\n#### **1) Boxplot de todos los indicadores de un pilar**\n\n**Se desea lo siguiente:** comparar la **distribución** de puntajes de **LAB** en **2025** para **todas** las regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_distribucion(\n  edicion         = 2025,\n  pilar           = \"LAB\",\n  indicadores     = \"ALL\",\n  regiones        = \"ALL\",\n  tipo            = \"boxplot\",\n  jitter          = TRUE,\n  paleta          = \"blues\",\n  linea_promedio  = TRUE,\n  mostrar_leyenda = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-91-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Boxplots por **LAB1, LAB2, …** ordenados por mediana (desc), con puntos de regiones y línea de promedio global.\n\n#### **2) Violin para un subconjunto de indicadores**\n\n**Se desea lo siguiente:** visualizar solo **LAB2** y **LAB5** como violines, con puntos, en 2025.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_distribucion(\n  edicion         = 2025,\n  pilar           = \"LAB\",\n  indicadores     = c(\"LAB2\", \"LAB5\"),\n  regiones        = \"ALL\",\n  tipo            = \"violin\",\n  jitter          = TRUE,\n  paleta          = \"viridis\",\n  linea_promedio  = TRUE,\n  mostrar_leyenda = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-92-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dos violines (LAB2, LAB5) con escala 0–10 y línea de promedio.\n\n#### **3) Con grupos y exclusiones de regiones**\n\n**Se desea lo siguiente:** comparar la distribución de **ECO** (todos los indicadores) en 2024 para **Costa** y **Norte**, excluyendo \"Lima\\*\".\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_distribucion(\n  edicion         = 2024,\n  pilar           = \"ECO\",\n  indicadores     = \"ALL\",\n  regiones        = c(\"gr_costa\", \"gr_norte\", \"-Lima*\"),\n  tipo            = \"boxplot\",\n  jitter          = TRUE,\n  paleta          = \"cividis\",\n  linea_promedio  = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-93-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Distribuciones por indicador solo para las regiones filtradas, Lima\\* no aparece.\n\n## **Telaraña por INDICADORES (indc_radar)**\n\n-   indc_radar() dibuja un **radar** con los **indicadores** de un **pilar** en **una edición**, comparando una o varias **regiones**.\n\n-   Los ejes pueden rotularse por **código** (LAB2, EDU5, …) o por **nombre** completo.\n\n-   Siempre usa **puntaje (0–10)**, excluye “Perú” y “General”, y consolida un único valor por (región, indicador).\n\n### **Parámetros**\n\n-   **edicion**: año a graficar (2016 … 2025).\n\n-   **pilar**: código \"ECO\"/\"LAB\"/… o nombre \"Entorno económico\"/\"Laboral\"/….\n\n-   **indicadores**: \"ALL\" (default) o vector mixto de **códigos** y/o **nombres** a incluir.\n\n-   **regiones**:\n\n    -   \"AUTO3\" (default) selecciona automáticamente **3** regiones (baja, media y alta) por promedio del pilar.\n\n    -   \"ALL\" o vector de nombres/códigos, admite combinaciones con tus *helpers* (grupos/ exclusiones) si prefieres filtrar antes y pasar el resultado.\n\n-   **usar_codigos**: si TRUE, traduce códigos antes de filtrar.\n\n-   **etiquetas_indicadores**: \"codigo\" (default) o \"nombre\" para el **rótulo de ejes**.\n\n-   **max_regiones**: umbral de advertencia por legibilidad (default 6).\n\n-   **alpha**: transparencia del **relleno** (default 0.25).\n\n-   **paleta**: \"ipe\", \"okabe_ito\", \"viridis\" (cualitativas por región).\n\n-   **mostrar_puntos**: TRUE/FALSE para puntos en los vértices.\n\n### **Explicación conceptual**\n\nEl radar compara regiones **en la misma escala 0–10** para todos los **indicadores** del pilar.\n\n-   Cuando regiones=\"AUTO3\", se eligen automáticamente tres casos representativos (bajo/medio/alto) para una lectura rápida.\n\n-   Si hay muchos polígonos (muchas regiones), la superposición reduce la claridad, por eso se **advierte** cuando superas max_regiones.\n\n-   Se normaliza/depura para asegurar **un valor por (región, indicador)**, y se recorta a \\[0,10\\] por robustez.\n\n### **Ejemplos**\n\n#### **1) Comparación rápida con selección automática de regiones**\n\n**Se desea lo siguiente:** un radar de **Laboral** en **2025** con todos los indicadores, dejando que el algoritmo elija 3 regiones representativas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_radar(\n  edicion   = 2025,\n  pilar     = \"LAB\",\n  indicadores = \"ALL\",\n  regiones  = \"AUTO3\",\n  etiquetas_indicadores = \"codigo\",  # ejes tipo LAB1, LAB2, ...\n  paleta    = \"ipe\",\n  alpha     = 0.25,\n  mostrar_puntos = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-94-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Tres polígonos (baja/mediana/alta) con ejes por **código** de indicador y escala 0–10.\n\n#### **2) Comparar un conjunto específico de regiones con ejes por nombre**\n\n**Se desea lo siguiente:** comparar **Arequipa**, **Cusco** y **La Libertad** en **ECO (2025)**, con ejes rotulados por **nombre** de indicador.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_radar(\n  edicion   = 2025,\n  pilar     = \"EDU\",\n  indicadores = \"ALL\",\n  regiones  = c(\"Arequipa\", \"Cusco\", \"La Libertad\"),\n  etiquetas_indicadores = \"nombre\",\n  paleta    = \"okabe_ito\",\n  alpha     = 0.3\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-95-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Radar con **3 regiones** y ejes por **nombre** completo, título y caption con estilo del paquete.\n\n#### **3) Foco en un subconjunto de indicadores**\n\n**Se desea lo siguiente:** telaraña de **LAB (2025)** con **sólo tres indicadores** (por código o nombre) y un conjunto amplio de regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_radar(\n  edicion   = 2025,\n  pilar     = \"LAB\",\n  indicadores = c(\"LAB1\", \"LAB2\", \"LAB3\", \"LAB5\", \"LAB6\"),\n  regiones  = \"gr_norte\",\n  etiquetas_indicadores = \"codigo\",\n  paleta    = \"viridis\",\n  max_regiones = 8,  \n  alpha     = 0.2\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-96-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Radar con **sólo los indicadores** elegidos.\n\n## **Distribución por indicador (indc_distribucion)**\n\n-   **indc_distribucion()** muestra, para **una edición** y **un pilar**, la **distribución de puntajes (0–10)** por **indicador** entre regiones, como **boxplot** o **violin**. El eje X son **códigos** (p.ej., LAB1, LAB2, …) y el eje Y es el **puntaje (0–10)**.\n\n-   Siempre **excluye** \"Perú\" y \"General\", y consolida a **un valor por (región, indicador)** mediante promedio defensivo ante duplicados. Internamente lee con agregar_codigos = TRUE para garantizar el eje en códigos.\n\n### **Parámetros: decisiones clave**\n\n-   **edicion**: año único (p.ej., 2025).\n\n-   **pilar**: código \"ECO\"/\"LAB\"/… o nombre \"Entorno económico\"/\"Laboral\"/….\n\n-   **indicadores**: \"ALL\" (default) o vector de **códigos**/**nombres** (p.ej., c(\"LAB1\",\"Inserción laboral juvenil\")).\n\n-   **regiones**: \"ALL\" o vector; admite **grupos** gr\\_\\* y **exclusiones** con \"-\" (vía helpers de regiones).\n\n-   **usar_codigos**: si TRUE (default), permite pasar códigos en pilar/regiones/indicadores.\n\n-   **tipo**: \"boxplot\" (default) o \"violin\".\n\n-   **jitter**: TRUE para superponer puntos individuales (ruido controlado).\n\n-   **paleta**: \"blues\" (default), \"viridis\", \"cividis\" — aplicada **por indicador**.\n\n-   **linea_promedio**: TRUE dibuja línea horizontal con el **promedio global** de puntajes.\n\n-   **mostrar_leyenda**: FALSE (default). Útil activarla si quieres identificar el **relleno por indicador**.\n\n### **Explicación conceptual**\n\n-   Trabaja solo con **puntajes estandarizados (0–10)** del INCORE y permite comparar **dispersión** entre regiones por indicador dentro del pilar.\n\n-   El **orden** de los indicadores en el eje X se define por la **mediana** de su distribución (desc), facilitando la lectura de mayor a menor desempeño típico.\n\n-   Con tipo = \"boxplot\" ves mediana, IQR y atípicos; con tipo = \"violin\" ves densidad. El jitter aporta la granularidad por región.\n\n-   La **línea punteada** (linea_promedio) resume el **promedio general** de puntajes de todos los indicadores seleccionados.\n\n### **Ejemplos**\n\n#### **1) Boxplot de todos los indicadores de un pilar**\n\n**Se desea lo siguiente:** comparar la **distribución** de puntajes de **LAB** en **2025** para **todas** las regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_distribucion(\n  edicion         = 2025,\n  pilar           = \"LAB\",\n  indicadores     = \"ALL\",\n  regiones        = \"ALL\",\n  tipo            = \"boxplot\",\n  jitter          = TRUE,\n  paleta          = \"blues\",\n  linea_promedio  = TRUE,\n  mostrar_leyenda = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-97-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Boxplots por **LAB1, LAB2, …** ordenados por mediana (desc), con puntos por región y una línea de promedio global.\n\n#### **2) Violin para un subconjunto de indicadores**\n\n**Se desea lo siguiente:** visualizar solo **LAB2** y **LAB5** como violines, con puntos, en 2025.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_distribucion(\n  edicion         = 2025,\n  pilar           = \"LAB\",\n  indicadores     = c(\"LAB2\", \"LAB5\"),\n  regiones        = \"ALL\",\n  tipo            = \"violin\",\n  jitter          = TRUE,\n  paleta          = \"viridis\",\n  linea_promedio  = TRUE,\n  mostrar_leyenda = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-98-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dos violines (LAB2, LAB5) con escala 0–10 y línea de promedio.\n\n#### **3) Con grupos y exclusiones de regiones**\n\n**Se desea lo siguiente:** comparar la distribución de **ECO** (todos los indicadores) en 2024 para **Costa** y **Norte**, excluyendo \"Lima\\*\".\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_distribucion(\n  edicion         = 2024,\n  pilar           = \"ECO\",\n  indicadores     = \"ALL\",\n  regiones        = c(\"gr_costa\", \"gr_norte\", \"-Lima*\"),\n  tipo            = \"boxplot\",\n  jitter          = TRUE,\n  paleta          = \"cividis\",\n  linea_promedio  = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-99-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Distribuciones por indicador solo para las regiones filtradas; \"Lima\\*\" no aparece.\n\n## **Heatmap por indicadores o por tiempo (indc_heatmap)**\n\n-   **indc_heatmap()** dibuja un mapa de calor con filas = **regiones** y columnas que pueden ser:\n\n    -   **Indicadores** de un **pilar** en **una** edición (modo = \"indicadores\").\n\n    -   **Ediciones** para **un** **indicador** (modo = \"tiempo\").\n\n-   Siempre trabaja con **puntajes 0–10**, usando indc_leer_incore(..., agregar_codigos = TRUE) y excluyendo el indicador **“General”** (y la fila **“Perú”**).\n\n### **Parámetros: decisiones clave**\n\n-   **modo**: \"indicadores\" (columnas = indicadores, una edición) o \"tiempo\" (columnas = ediciones, un indicador).\n\n-   **pilar**: código \"ECO\"/\"LAB\"/… o nombre \"Entorno económico\"/\"Laboral\"/… (requerido si modo=\"indicadores\").\n\n-   **indicador**: código o nombre (requerido si modo=\"tiempo\").\n\n-   **edicion**: año único (cuando modo=\"indicadores\").\n\n-   **ediciones**: rango con ≥2 años (cuando modo=\"tiempo\", p.ej., 2019:2025).\n\n-   **regiones**: \"ALL\" o vector; admite **grupos** gr\\_\\* y **exclusiones** con \"-\" (se apoya en tus helpers de regiones).\n\n-   **usar_codigos**: si TRUE, permite pasar códigos en pilar/indicador/regiones.\n\n-   **ordenar** (solo modo=\"tiempo\"): \"ninguno\", \"por_ultimo\" (ordena por el valor en la última edición), \"por_promedio\".\n\n-   **paleta**: \"blues\", \"viridis\", \"cividis\", \"magma\" (escala continua).\n\n-   **anotar**: si TRUE, escribe el valor dentro de cada celda.\n\n-   **mostrar_leyenda**: TRUE/FALSE.\n\n### **Explicación conceptual**\n\n-   En modo = \"indicadores\" las columnas son **códigos de indicador** (p.ej., LAB1, LAB2, …) del pilar elegido en la **edición** indicada; útil para comparar desempeño **entre indicadores** dentro del pilar.\n\n-   En modo = \"tiempo\" las columnas son **ediciones** para un **indicador** específico; útil para ver **trayectorias** por región.\n\n    El parámetro ordenar ayuda a resaltar patrones (por el último dato o por el promedio).\n\n-   Siempre se consolida a **un valor por celda** mediante **promedio defensivo** si aparecen duplicados en (región, indicador) o (región, edición).\n\n### **Ejemplos**\n\n#### **A) Indicadores de un pilar en una edición**\n\n**Se desea lo siguiente:** heatmap de **EDU** en **2025** (todas las regiones), con valores anotados.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_heatmap(\n  modo       = \"indicadores\",\n  pilar      = \"EDU\",\n  edicion    = 2025,\n  regiones   = \"ALL\",\n  paleta     = \"blues\",\n  anotar     = TRUE,\n  usar_codigos = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-100-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Filas = regiones; columnas = **EDU1, EDU2, …**; celdas en escala 0–10 con rótulos numéricos.\n\n#### **B) Evolución temporal de un indicador**\n\n**Se desea lo siguiente:** heatmap de **LAB2** en **2019–2025**, ordenando filas por el **valor en la última edición**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_heatmap(\n  modo        = \"tiempo\",\n  indicador   = \"LAB2\",\n  ediciones   = 2019:2025,\n  regiones    = \"ALL\",\n  ordenar     = \"por_ultimo\",\n  paleta      = \"viridis\",\n  anotar      = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-101-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Filas ordenadas por desempeño en 2025; columnas = 2019…2025; colores 0–10.\n\n#### **C) Con grupos y exclusiones de regiones**\n\n**Se desea lo siguiente:** heatmap de **ECO** (todos los indicadores) en **2024** solo para **Costa** y **Macro Norte**, excluyendo \"Lima\\*\".\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindc_heatmap(\n  modo       = \"indicadores\",\n  pilar      = \"ECO\",\n  edicion    = 2024,\n  regiones   = c(\"gr_costa\", \"gr_norte\", \"-Lima*\"),\n  paleta     = \"cividis\",\n  anotar     = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-102-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Filas restringidas a los grupos solicitados, **sin** Lima\\*, columnas = indicadores de ECO, escala 0–10.\n\n## **Ridgeline por año (valor_ridgeline)**\n\n-   **valor_ridgeline()** muestra la **distribución de valores originales (no puntajes)** de un **indicador** del INCORE a lo largo de **varias ediciones** (una cresta por año), agregando sobre **regiones** en cada año.\n\n-   Siempre **excluye** registros cuya unidad sea **“Puntaje del 0 al 10”**; por defecto **excluye “Perú”** (puedes incluirlo con incluir_peru = TRUE).\n\n### **Parámetros: decisiones clave**\n\n-   **indicador**: código o nombre (p.ej., \"EDU2\" o \"2.2 …\").\n\n-   **ediciones**: rango con ≥ 2 años (p.ej., 2017:2025).\n\n-   **regiones**: \"ALL\" (default) o vector; admite **códigos**/nombres (y los helpers de tu paquete).\n\n-   **usar_codigos**: TRUE (default) para traducir códigos en filtros.\n\n-   **incluir_peru**: FALSE (default). Si TRUE, incluye la fila “Perú”.\n\n-   **paleta**: \"ipe\", \"okabe_ito\", \"viridis\" (colorea **años**).\n\n-   **scale**: superposición vertical de crestas (default 1.1).\n\n-   **rel_min_height**: umbral mínimo relativo de densidad (default 0.001).\n\n-   **mostrar_leyenda**: FALSE (default) para ocultar la leyenda de años.\n\n### **Explicación conceptual**\n\n-   Trabaja con **valores originales** (unidades propias) del indicador; **no** con el puntaje 0–10.\n\n-   Para cada **año** se estima una **densidad** con los valores de las **regiones** filtradas; si un año tiene **\\< 3 observaciones**, se omite por estabilidad.\n\n-   El **título** usa el nombre del indicador y el **subtítulo** la **unidad** (cuando está disponible). El *caption* puede incorporar **fuente(s)** automáticamente.\n\n### **Ejemplos**\n\n#### **1) Evolución 2017–2025 para todas las regiones (básico)**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_ridgeline(\n  indicador = \"EDU2\",\n  ediciones = 2017:2025,\n  regiones  = \"ALL\",\n  paleta    = \"ipe\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-103-1.png){width=960}\n:::\n:::\n\n\n\n\n#### **2) Solo un subconjunto de regiones**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_ridgeline(\n  indicador = \"EDU2\",\n  ediciones = 2019:2025,\n  regiones  = c(\"Arequipa\", \"Cusco\", \"Tacna\", \"La Libertad\"),\n  paleta    = \"okabe_ito\",\n  mostrar_leyenda = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-104-1.png){width=960}\n:::\n:::\n\n\n\n\n#### **3) Ajuste fino de superposición y suavizado**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalor_ridgeline(\n  indicador       = \"1.7 Billeteras digitales\",\n  ediciones       = 2020:2025,\n  regiones        = \"ALL\",\n  paleta          = \"viridis\",\n  scale           = 1.3,\n  rel_min_height  = 0.002,\n  incluir_peru    = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-105-1.png){width=960}\n:::\n:::\n\n\n\n\n# Funciones bivalor\\_\n\nLa familia `bivalor_` permite analizar **relaciones entre dos o más indicadores** de manera conjunta.\\\nEstá diseñada para explorar **correlaciones, dispersiones y series de tiempo comparadas** entre indicadores, ya sea en **puntajes (0–10)** o en **valores originales**, según la fuente de datos cargada.\n\n## **bivalor_largo()**\n\n**Comparación bivariada de valores de dos indicadores a lo largo del tiempo**\n\n### **Introducción**\n\nLa función bivalor_largo() permite **trazar y comparar simultáneamente dos indicadores distintos** del INCORE en términos de sus **valores originales** (no puntajes estandarizados) a lo largo de varias ediciones.\n\nEl objetivo es visualizar en un solo panel cómo evolucionan dos magnitudes diferentes (por ejemplo, porcentaje de acceso a internet y gasto público per cápita) a través del tiempo, **promediadas sobre un conjunto de regiones** seleccionado. Cada indicador se muestra con un color distinto y se asocia a un **eje Y propio** (izquierdo/derecho), lo que garantiza la comparabilidad aun cuando se midan en unidades diferentes.\n\nEsta función es particularmente útil cuando se busca **relacionar tendencias entre dos fenómenos**, identificando convergencias, divergencias o trayectorias paralelas en el marco del análisis regional.\n\n### **Parámetros**\n\n-   **ediciones**: rango de años a analizar.\n\n    -   Requiere ≥ 2 valores.\n\n    -   Ejemplo: 2019:2025.\n\n-   **ind_x, ind_y**: indicadores a comparar.\n\n    -   Pueden especificarse por **código** (ej. \"ECO3\") o por **nombre completo**.\n\n    -   Se grafican en paralelo, cada uno con su eje Y.\n\n-   **regiones**: delimita el conjunto de regiones consideradas en el promedio.\n\n    -   \"ALL\" (por defecto) = todas las regiones.\n\n    -   Vector de nombres o códigos.\n\n    -   Grupos predefinidos (gr\\_\\*) o exclusiones (\"-Lima\\*\").\n\n-   **usar_codigos**: si TRUE (default), permite ingresar códigos en filtros.\n\n-   **incluir_peru**: si TRUE, añade la fila agregada nacional (“Perú”). Por defecto se excluye.\n\n-   **col_x, col_y**: colores de las series X e Y, respectivamente.\n\n    -   Por defecto: \"#355C7D\" y \"#35B778\".\n\n### **Explicación conceptual**\n\nEl funcionamiento de bivalor_largo() sigue tres pasos:\n\n1.  **Resolución de indicadores.** Se consulta el catálogo oficial para mapear código ↔ nombre y asegurar la selección de los indicadores correctos.\n\n2.  **Preparación de datos.** Se filtran únicamente los valores originales (excluyendo puntajes 0–10), se aplican los filtros de regiones, y se calcula un **promedio defensivo** por edición e indicador. De esta forma, cada año tiene un valor único por indicador.\n\n3.  **Escalamiento y visualización.**\n\n    -   La serie de ind_x se dibuja con su escala natural en el eje Y izquierdo.\n\n    -   La serie de ind_y se transforma linealmente para compartir el mismo canvas, pero se muestra en un **eje secundario** (derecho) con sus unidades originales.\n\n    -   El gráfico incluye líneas y puntos para cada serie, etiquetas de ejes con unidad corta y subtítulo con las unidades completas.\n\nEste diseño asegura una representación visual **coherente y comparativa**, sin distorsionar las magnitudes propias de cada indicador.\n\n### **Ejemplos**\n\n#### **1) Comparar conectividad y gasto público**\n\n**Se desea lo siguiente:** graficar el acceso a internet (INF2) frente al gasto público per cápita (ECO5) entre 2018 y 2025 para todas las regiones.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_largo(\n  ediciones = 2018:2025,\n  ind_x     = \"INF2\",\n  ind_y     = \"ECO5\",\n  regiones  = \"ALL\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-106-1.png){width=1344}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dos líneas con puntos: INF2 en el eje izquierdo (azul), ECO5 en el derecho (verde), mostrando tendencias paralelas o divergentes.\n\n#### **2) Subconjunto regional con exclusión**\n\n**Se desea lo siguiente:** comparar SAL3 y EDU4 entre 2019–2025 para regiones de la Sierra y Selva, excluyendo Lima.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_largo(\n  ediciones = 2019:2025,\n  ind_x     = \"SAL3\",\n  ind_y     = \"EDU4\",\n  regiones  = c(\"gr_sierra\", \"gr_selva\", \"-Lima*\")\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-107-1.png){width=1344}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Gráfico con dos series (ejes distintos) basadas en los promedios regionales de las zonas seleccionadas.\n\n#### **3) Inclusión de Perú y personalización de colores**\n\n**Se desea lo siguiente:** incluir la referencia nacional para comparar ECO2 y ECO6 en 2020–2025, usando colores personalizados.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_largo(\n  ediciones    = 2020:2025,\n  ind_x        = \"ECO2\",\n  ind_y        = \"ECO6\",\n  incluir_peru = TRUE,\n  col_x        = \"purple\",\n  col_y        = \"red\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-108-1.png){width=1344}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Ambas series con sus respectivos ejes, incorporando además la fila “Perú” en los promedios.\n\n## **bivalor_dispersion()**\n\n**Dispersión bivariada de valores por región en una edición del INCORE**\n\n### **Introducción**\n\nbivalor_dispersion() grafica, para **una edición**, la relación entre **dos indicadores** del INCORE usando sus **valores originales** (no puntajes 0–10). Cada punto representa una **región**; el **eje X** corresponde a ind_x y el **eje Y** a ind_y.\n\nLa función acepta indicadores por **código** (p. ej., \"EDU1\") o por **nombre completo**, excluye “Perú” por defecto y permite tres estrategias de color: **cualitativa** por región, **monocroma**, o un modo para **resaltar** un subconjunto de regiones sobre un fondo atenuado. Es ideal para explorar **correlaciones**, **patrones** y **outliers** entre dos magnitudes sustantivas en un corte temporal.\n\n### **Parámetros**\n\n-   **edicion**: año único del INCORE.\n\n    -   Ejemplo: 2025.\n\n-   **ind_x, ind_y**: indicadores a ubicar en los ejes X e Y.\n\n    -   Por **código** (p. ej., \"EDU1\", \"LAB3\") o por **nombre completo**.\n\n    -   Trabaja con **valores originales** (unidades propias).\n\n-   **regiones**: selección de regiones a mostrar.\n\n    -   \"ALL\" (default) = todas.\n\n    -   Vector mixto de **nombres**, **códigos** o **grupos** gr\\_\\* (admite exclusiones con prefijo \"-\").\n\n-   **usar_codigos**: si TRUE (default), permite filtros por **código** en regiones/indicadores y los traduce a nombres oficiales.\n\n-   **incluir_peru**: si TRUE, incluye la fila “Perú” en la dispersión.\n\n    -   Default: FALSE.\n\n-   **paleta**: esquema de color para puntos.\n\n    -   \"ipe\" (default), \"okabe_ito\", \"viridis\", \"mono\" (monocromo).\n\n-   **color_mono**: color único cuando paleta = \"mono\".\n\n    -   Default: \"#3B5B92\".\n\n-   **modo**: lógica de coloración.\n\n    -   \"normal\": colores por región (según paleta).\n\n    -   \"resaltar\": colorea **sólo** un subconjunto y atenúa el resto.\n\n-   **highlight_regiones**: vector de regiones a **resaltar** cuando modo = \"resaltar\".\n\n    -   Recomendado ≤ 8 para legibilidad.\n\n-   **highlight_color**: color para las regiones resaltadas.\n\n    -   Default: \"#D7301F\".\n\n-   **mostrar_leyenda**: mostrar/ocultar leyenda.\n\n    -   En paleta = \"mono\" se ignora; en modo = \"resaltar\" se muestran **sólo** las resaltadas.\n\n### **Explicación conceptual**\n\n1.  **Valores, no puntajes.** La función opera con las **magnitudes originales** (tasas, montos, porcentajes, etc.). Si hubiera duplicados para un mismo **(región, indicador)**, se consolida por **promedio** para asegurar un punto por región.\n\n2.  **Resolución código ↔ nombre.** Se consulta el **catálogo oficial** para mapear automáticamente códigos y nombres de indicadores antes de filtrar y cruzar ind_x con ind_y.\n\n3.  **Coloración flexible.**\n\n    -   En **modo normal**, cada región recibe un color (paletas cualitativas robustas).\n\n    -   En **monocromo**, todas comparten un mismo tono (útil para enfatizar la nube de puntos y la forma de la relación).\n\n    -   En **resaltar**, solo un subconjunto se muestra en color destacado, mientras que el resto queda en gris tenue; la leyenda enumera únicamente las resaltadas.\n\n4.  **Etiquetas con unidad corta.** Los ejes muestran el **nombre del indicador** y su **unidad abreviada**, facilitando la lectura cruzada cuando las magnitudes son diferentes.\n\n### **Ejemplos**\n\n#### **1) Dispersión simple (todas las regiones, color por región)**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_dispersion(2025, \n                   ind_x = \"EDU1\", \n                   ind_y = \"LAB3\")\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-109-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Nube de puntos donde cada color identifica una región; ejes etiquetados con nombre de indicador y unidad corta.\n\n#### **2) Subconjunto de regiones y paleta Okabe–Ito**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_dispersion(\n  2025, \"EDU1\", \"LAB3\",\n  regiones = c(\"Arequipa\", \"Lima*\", \"MOQ\",\n               \"CUS\", \"APC\", \"ANC\"),\n  paleta   = \"okabe_ito\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-110-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Dispersión sólo con las regiones seleccionadas, colores accesibles (Okabe–Ito) y sin “Perú”.\n\n#### **3) Modo monocromo, sin leyenda**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_dispersion(\n  2025, \"EDU1\", \"LAB3\",\n  paleta     = \"mono\",\n  color_mono = \"#555577\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-111-1.png){width=960}\n:::\n:::\n\n\n\n\n**Resultado esperado.** Puntos en un único color; ideal para destacar el **patrón geométrico** de la relación.\n\n#### **4) Resaltar conjunto sobre fondo gris**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_dispersion(\n  2025, \"EDU1\", \"LAB3\",\n  modo               = \"resaltar\",\n  highlight_regiones = c(\"Arequipa\",\"Cusco\",\"Tacna\"),\n  highlight_color    = \"#C43C39\",\n  mostrar_leyenda    = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-112-1.png){width=960}\n:::\n:::\n\n\n\n\n## **Matriz de correlaciones bivariadas de valores (bivalor_correlaciones)**\n\n**Visualiza relaciones entre múltiples indicadores (en valores originales, no puntajes 0–10) en una edición del INCORE**\n\n### **Introducción**\n\nbivalor_correlaciones() construye una **matriz tipo pairs** para un conjunto de indicadores medidos en **valores originales** en una **edición** específica. La matriz integra tres vistas complementarias:\n\n-   **Triángulo superior:** **dispersión** X vs. Y por **región** (cada punto es una región).\n\n-   **Diagonal:** **densidad univariada** de cada indicador (distribución entre regiones).\n\n-   **Triángulo inferior:** **heatmap** del **coeficiente de correlación** (Spearman o Pearson) entre indicadores, con el valor numérico en la celda.\n\nPor defecto se excluye la fila “Perú”, así la correlación se calcula comparando únicamente **regiones**. La función consolida defensivamente a **un valor por (región, indicador)** si hubiera duplicados esporádicos.\n\n### **Parámetros**\n\n-   **edicion**\n\n    Año único del INCORE (p. ej., 2016 … 2025).\n\n-   **indicadores**\n\n    Conjunto de **códigos** (p. ej., “EDU1”, “LAB3”) y/o **nombres completos** de indicadores. Se requieren **≥ 2**.\n\n-   **regiones**\n\n    Universo de análisis. Admite:\n\n    -   \"ALL\" (todas las regiones, default)\n\n    -   Lista de **nombres** y/o **códigos**\n\n    -   **Grupos** gr\\_\\* y **exclusiones** con “-”\n\n        (ej.: gr_costa, gr_norte, -Lima\\*)\n\n-   **usar_codigos**\n\n    TRUE/FALSE. Si TRUE (recomendado), traduce **códigos** de región/indicador a nombres oficiales antes de filtrar.\n\n-   **incluir_peru**\n\n    TRUE/FALSE. Si FALSE (default), se **excluye** “Perú”.\n\n-   **metodo**\n\n    Correlación a mostrar en el heatmap:\n\n    -   \"spearman\" (default; robusta a no linealidades monótonas y a outliers)\n\n    -   \"pearson\" (relaciones lineales, sensible a outliers y a escala)\n\n-   **paleta_cor**\n\n    Esquema de color para el heatmap de correlaciones:\n\n    -   \"rb\" = **rojo–blanco–azul** (negativo ↔ positivo)\n\n    -   \"viridis\" = **escala perceptual** continua\n\n-   **alpha_puntos**\n\n    Opacidad de los puntos en la dispersión (triángulo superior). Default **0.8**.\n\n### **Explicación conceptual**\n\n1.  **Lectura y depuración.** Se leen los datos de la **edición** elegida y se normalizan etiquetas. Se **excluye “Perú”** por defecto.\n\n2.  **Resolución de indicadores.** La función acepta mezcla de **códigos** y **nombres**; internamente los alinea y **consolida** a un único valor por (región, indicador) mediante **promedio defensivo** si detecta duplicados.\n\n3.  **Estructura de la matriz.**\n\n    -   **Diagonal:** densidades que muestran la **dispersión** regional de cada indicador.\n\n    -   **Superior:** **dispersión** entre pares de indicadores (puntos = regiones).\n\n    -   **Inferior:** **correlación** (r ∈ \\[-1,1\\]) con **anotación numérica**; se calculan con **pares completos** por celda.\n\n4.  **Robustez mínima.** Para calcular correlaciones útiles, cada indicador debe tener **≥ 3** observaciones válidas (regiones). Indicadores con datos insuficientes se omiten automáticamente.\n\n### **Buenas prácticas de lectura**\n\n-   Prefiera **Spearman** cuando sospeche **no linealidad** o presencia de **outliers**; use **Pearson** si espera una relación **lineal** clara y datos **sin valores extremos**.\n\n-   Interprete valores \\|r\\| **≥ 0.7** como **altos** (según contexto), 0.3–0.7 **moderados**, y \\< 0.3 **débiles** — siempre con criterio sustantivo y revisando la **dispersión** del triángulo superior.\n\n-   Si las **unidades** de dos indicadores difieren sustantivamente y hay **colas pesadas**, la **densidad** (diagonal) y la **forma del scatter** son pistas cruciales para no sobreinterpretar r.\n\n### **Ejemplos**\n\nMatriz simple de correlaciones con 3 indicadores (Spearman, default)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_correlaciones(\n  edicion = 2025,\n  indicadores = c(\"EDU1\", \"SAL3\", \"INF2\")\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-113-1.png){width=1152}\n:::\n:::\n\n\n\n\nAnálisis focalizado en 4 indicadores y un conjunto de regiones\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_correlaciones(\n  edicion = 2025,\n  indicadores = c(\"1.1 PBI real en logaritmos\", \"5.1 Conclusión secundaria\",\n                  \"4.1 Desnutrición crónica\", \"2.1 Ingreso por hora por trabajo\"),\n  regiones = c(\"Arequipa\", \"Moquegua\", \"Lima*\", \"Loreto\")\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-114-1.png){width=1152}\n:::\n:::\n\n\n\n\nComparación con Pearson y paleta viridis\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbivalor_correlaciones(\n  edicion = 2025,\n  indicadores = c(\"LAB1\", \"LAB2\", \"LAB3\", \"LAB4\", \"LAB5\"),\n  metodo = \"pearson\",\n  paleta_cor = \"viridis\"\n)\n```\n\n::: {.cell-output-display}\n![](Manual_files/figure-html/unnamed-chunk-115-1.png){width=1152}\n:::\n:::\n\n\n\n\n### **Notas y consideraciones**\n\n-   La matriz **omite** indicadores sin datos suficientes (≥ 3 regiones con valor) y **filas con NA completos**, para evitar correlaciones inestables.\n\n-   Si la conformación regional es muy desigual, considere restringir a **subconjuntos comparables** (p. ej., macrozonas).\n\n-   El resultado es un objeto **GGally::ggpairs**, ideal para **inserción directa** en reportes y para añadir capas (temas/estilos) si se desea.\n",
    "supporting": [
      "Manual_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}