<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Integración – R para el análisis de datos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./statdesc.html" rel="next">
<link href="./fundamentosR.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./integración.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Integración</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para el análisis de datos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Agradecimientos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estructura del libro</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fundamentos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Fundamentos de la Estadística</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fundamentosR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Fundamentos de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./integración.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Integración</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statdesc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estadística descriptiva</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probabilidad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estadística inferencial</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Comparando grupos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regresión</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glosariofunciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Glosario de funciones y operaciones útiles en R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solucionario.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solucionario</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bilbiografía</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#data.frames" id="toc-data.frames" class="nav-link active" data-scroll-target="#data.frames"><span class="header-section-number">3.1</span> Data.frames</a></li>
  <li><a href="#el-flujo-de-trabajo-en-el-tidyverse" id="toc-el-flujo-de-trabajo-en-el-tidyverse" class="nav-link" data-scroll-target="#el-flujo-de-trabajo-en-el-tidyverse"><span class="header-section-number">3.2</span> El flujo de trabajo en el Tidyverse</a></li>
  <li><a href="#importación-y-resumen" id="toc-importación-y-resumen" class="nav-link" data-scroll-target="#importación-y-resumen"><span class="header-section-number">3.3</span> Importación y resumen</a>
  <ul class="collapse">
  <li><a href="#importación" id="toc-importación" class="nav-link" data-scroll-target="#importación"><span class="header-section-number">3.3.1</span> Importación</a></li>
  <li><a href="#funciones-resumen" id="toc-funciones-resumen" class="nav-link" data-scroll-target="#funciones-resumen"><span class="header-section-number">3.3.2</span> Funciones resumen</a></li>
  </ul></li>
  <li><a href="#limpieza" id="toc-limpieza" class="nav-link" data-scroll-target="#limpieza"><span class="header-section-number">3.4</span> Limpieza</a></li>
  <li><a href="#manipulación" id="toc-manipulación" class="nav-link" data-scroll-target="#manipulación"><span class="header-section-number">3.5</span> Manipulación</a>
  <ul class="collapse">
  <li><a href="#funciones-principales" id="toc-funciones-principales" class="nav-link" data-scroll-target="#funciones-principales"><span class="header-section-number">3.5.1</span> Funciones principales</a></li>
  <li><a href="#dplyr-en-acción" id="toc-dplyr-en-acción" class="nav-link" data-scroll-target="#dplyr-en-acción"><span class="header-section-number">3.5.2</span> Dplyr en acción</a></li>
  </ul></li>
  <li><a href="#visualización" id="toc-visualización" class="nav-link" data-scroll-target="#visualización"><span class="header-section-number">3.6</span> Visualización</a>
  <ul class="collapse">
  <li><a href="#fundamentos-de-ggplot2" id="toc-fundamentos-de-ggplot2" class="nav-link" data-scroll-target="#fundamentos-de-ggplot2"><span class="header-section-number">3.6.1</span> Fundamentos de ggplot2</a></li>
  <li><a href="#tipos-de-gráficos" id="toc-tipos-de-gráficos" class="nav-link" data-scroll-target="#tipos-de-gráficos"><span class="header-section-number">3.6.2</span> Tipos de gráficos</a></li>
  </ul></li>
  <li><a href="#flor-y-el-análisis-del-bienestar-social" id="toc-flor-y-el-análisis-del-bienestar-social" class="nav-link" data-scroll-target="#flor-y-el-análisis-del-bienestar-social"><span class="header-section-number">3.7</span> Flor y el análisis del bienestar social</a></li>
  <li><a href="#resumen-del-capítulo" id="toc-resumen-del-capítulo" class="nav-link" data-scroll-target="#resumen-del-capítulo"><span class="header-section-number">3.8</span> Resumen del capítulo</a></li>
  <li><a href="#ejercicios" id="toc-ejercicios" class="nav-link" data-scroll-target="#ejercicios"><span class="header-section-number">3.9</span> Ejercicios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Integración</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>¿Cómo podemos usar R para analizar datos? En este capítulo, exploraremos los conceptos fundamentales que forman la base del análisis de datos en R, con un enfoque práctico en herramientas y procesos esenciales. Nuestro objetivo este capítulo será explicar la <strong>importancia del manejo de datos</strong> y cómo trabajar de manera eficiente con <strong><code>data.frames</code></strong> y <strong><code>tibbles</code></strong>.</p>
<p>A lo largo del capítulo, nos centraremos en varios aspectos clave que forman parte del flujo de trabajo en el análisis de datos utilizando herramientas del tidyverse:</p>
<ul>
<li><p><strong>La importación de datos</strong>: Aprenderemos a cargar datos desde diferentes fuentes, como archivos CSV o Excel, utilizando paquetes especializados.</p></li>
<li><p><strong>La limpieza de datos</strong>, donde aprenderemos a manejar problemas comunes como nombres de columnas inconsistentes, valores perdidos y duplicados, y cómo corregir tipos de datos incorrectos.</p></li>
<li><p><strong>Las funciones resumen</strong>, que nos permiten explorar rápidamente nuestros datos, identificar patrones y obtener información sobre su estructura y contenido.</p></li>
<li><p><strong>La manipulación de datos con dplyr</strong>, donde descubriremos cómo filtrar, seleccionar, agrupar y transformar datos con funciones diseñadas para ser intuitivas y fáciles de combinar.</p></li>
<li><p><strong>La creación de visualizaciones con ggplot2</strong>, donde aprenderemos a generar gráficos apropiados que no solo nos ayuden a explorar nuestros datos, sino que también comunican hallazgos de manera visual.</p></li>
</ul>
<p>Este capítulo es extenso, ya que cubre una amplia gama de conceptos fundamentales que se usarán a lo largo del resto del libro. Sin embargo, cada sección está diseñada para ser progresiva, conectando cada paso con el siguiente. Te animo a avanzar paso a paso, ya que cada etapa es fundamental es clave para poder entender el resto del contenido teórico del libro.</p>
<section id="data.frames" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data.frames"><span class="header-section-number">3.1</span> Data.frames</h2>
<p>Cuando recolectamos o hacemos uso de conjuntos de datos, estos suelen estar almacenados en <strong>estructuras tabulares</strong>, lo que facilita su comprensión y análisis. Una <strong>estructura tabular</strong> se refiere a una organización de los datos donde cada columna representa una <strong>variable</strong> (es decir, una característica o atributo que estamos observando), y cada fila corresponde a una <strong>observación</strong> (un registro individual de los datos, como un caso o instancia). En R, la forma más común de trabajar con este tipo de estructuras es a través de <strong>objetos denominados</strong> <code>data.frames</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Observación-01.png" class="img-fluid figure-img"></p>
<figcaption>Elaboración propia</figcaption>
</figure>
</div>
<p>Recuerda que, en el capítulo anterior, cuando exploramos los tipos de objetos en R, vimos que, a diferencia de una matriz (que también tiene una forma tabular pero almacena datos de un solo tipo), un&nbsp;<code>data.frame</code>&nbsp;permite que cada columna contenga datos de diferentes tipos. Esto significa que podemos trabajar simultáneamente con variables numéricas, categóricas o lógicas dentro de una misma estructura.</p>
<p>Imaginemos que queremos crear un conjunto de datos con tres variables:<br>
- <strong>Edad</strong>: numérica, que representa la edad de los encuestados.<br>
- <strong>Género</strong>: categórica, con valores como “Masculino” y “Femenino”.<br>
- <strong>Medio de comunicación preferido</strong>: categórica, con valores como “Televisión”, “Radio”, “Internet” y “Prensa Escrita”.</p>
<p>Podemos construir este <code>data.frame</code> en R utilizando vectores para cada variable y luego combinándolos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea vectores para cada variable</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>edad <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">28</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>genero <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Femenino"</span>, <span class="st">"Masculino"</span>, <span class="st">"Femenino"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Masculino"</span>, <span class="st">"Femenino"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>medio_comunicacion <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Internet"</span>, <span class="st">"Televisión"</span>, <span class="st">"Radio"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Prensa Escrita"</span>, <span class="st">"Internet"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combina los vectores en un data.frame</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>encuesta <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Edad =</span> edad, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                       Género <span class="ot">=</span> genero, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                       Medio_de_comunicación<span class="at">_preferido =</span> medio_comunicacion)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El resultado es una tabla que muestra la edad, el género y medio de comunicación preferidos de los encuestados, estructurados en filas y columnas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>encuesta</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Edad    Género Medio_de_comunicación_preferido
1   25  Femenino                        Internet
2   30 Masculino                      Televisión
3   35  Femenino                           Radio
4   40 Masculino                  Prensa Escrita
5   28  Femenino                        Internet</code></pre>
</div>
</div>
<p>Además, peudes seleccionar una columna de <code>data.frame</code> de forma individual utilizando el signo <code>$</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>encuesta<span class="sc">$</span>Medio_de_comunicación_preferido</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Internet"       "Televisión"     "Radio"          "Prensa Escrita"
[5] "Internet"      </code></pre>
</div>
</div>
<p>Para observar el data.frame de manera visual, RStudio ofrece herramientas muy convenientes. Podemos localizar el nombre del <strong>data.frame</strong> en el panel “Entorno” (Environment) y hacer clic en el ícono de la tabla que aparece al lado. Esto abrirá una vista interactiva en forma de hoja de cálculo, donde podrás explorar las filas y columnas de tu conjunto de datos.</p>
<p><img src="images/Observación-6.png" class="img-fluid"></p>
<p>Otra forma, desde la consola, es usar la función <code>View()</code>. Por ejemplo, si tu <strong>data.frame</strong> se llama <code>encuesta</code>, simplemente escribe el siguiente código en la consola:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(encuesta)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aunque esta es una forma de generar un <strong>data.frame</strong>, es importante mencionar que, en la práctica, la mayoría de los conjuntos de datos no se crean desde cero. Normalmente, los datos provienen de otras fuentes, como archivos de texto, hojas de cálculo o bases de datos. Por ello, uno de los pasos más importantes al trabajar con datos es <strong>importarlos desde estas fuentes</strong>, lo cual veremos en más detalle más adelante.</p>
</section>
<section id="el-flujo-de-trabajo-en-el-tidyverse" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="el-flujo-de-trabajo-en-el-tidyverse"><span class="header-section-number">3.2</span> El flujo de trabajo en el Tidyverse</h2>
<p>Como vimos en el anterior capítulo, un paquete en R es una colección de funciones y datos que extienden las capacidades básicas del lenguaje. Los paquetes te permiten realizar tareas específicas de manera más eficiente. Al instalar y cargar un paquete, se accede a un conjunto de herramientas especializadas que simplifican tu trabajo.</p>
<p>Debido a que existe una multitud enorme de paquetes, sugiero les eches un vistazo siempre que puedas. Debido al propósito de este libro, nos centraremos especialmente en uno de estos que, a nivel personal, es muy intuitivo y poderoso: <strong>El Tidyverse</strong>. <span class="citation" data-cites="tidyverse-2">(<a href="references.html#ref-tidyverse-2" role="doc-biblioref">Wickham et&nbsp;al. 2019</a>)</span></p>
<p>El tidyverse es un sistema coherente de paquetes para la manipulación, exploración y visualización de datos que comparten una lógica de diseño común. Estos paquetes son fundamentales en el flujo de trabajo de un analista de datos y, en mi opinión personal, son algunos de los más comprensibles e intuitivos que existen en el mundo de la programación.</p>
<p>Algunas características del tidyverse:</p>
<ul>
<li><p>Todos los paquetes del tidyverse siguen principios de diseño similares y se entienden entre sí.</p></li>
<li><p>La sintaxis y las funciones están diseñadas para ser fáciles de entender y usar.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://teachdatascience.com/"><img src="images/clipboard-3030342419.png" class="img-fluid figure-img" width="560" alt="Extraído de teachdatascience.com"></a></p>
<figcaption>Extraído de teachdatascience.com</figcaption>
</figure>
</div>
<p>La imagen ilustra el flujo de trabajo típico al analizar datos usando los paquetes del <strong>tidyverse</strong>. Recuerda que debemos seguir un orden, pues esto asegura que podamos manejar nuestros datos de manera <strong>coherente</strong>, <strong>reproducible</strong> y <strong>eficiente</strong>.</p>
<p>El flujo de trabajo incluye las siguientes etapas principales:</p>
</section>
<section id="importación-y-resumen" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="importación-y-resumen"><span class="header-section-number">3.3</span> Importación y resumen</h2>
<p>El primer paso en el flujo de trabajo es&nbsp;<strong>importar los datos desde fuentes externas</strong>&nbsp;al entorno de R. En las ciencias sociales, los investigadores suelen trabajar con bases de datos provenientes de encuestas, experimentos o datos recolectados en plataformas como hojas de cálculo de Excel, herramientas de encuestas en línea o programas de análisis estadístico como SPSS o Stata. Aunque R incluye funciones base (viene por defecto y no necesitan cargar algún paquete) para la importación de datos, como&nbsp;<code>read.csv()</code>, en este capítulo nos enfocaremos en los paquetes especializados como&nbsp;<strong><code>readr</code></strong>,&nbsp;<strong><code>readxl</code></strong>&nbsp;y&nbsp;<strong><code>haven</code></strong>, que son más actuales y generan&nbsp;<strong><code>tibbles</code></strong>, una versión mejorada de los <code>data.frames</code>.</p>
<p>Un ejemplo interesante es el caso de la&nbsp;<strong>Encuesta Nacional de Hogares (Enaho)</strong>, cuyos datos son publicados por las instituciones encargadas en diferentes formatos:&nbsp;<strong>CSV</strong>,&nbsp;<strong>Stata (.dta)</strong>&nbsp;y&nbsp;<strong>SPSS (.sav)</strong>. Esto demuestra cómo una misma base de datos puede estar disponible en múltiples formatos para adaptarse a las herramientas utilizadas por distintos analistas. Por ejemplo, un investigador que utiliza Excel podría optar por trabajar con el formato CSV, mientras que alguien que trabaja con Stata o SPSS puede preferir los archivos nativos de esos programas.</p>
<section id="importación" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="importación"><span class="header-section-number">3.3.1</span> Importación</h3>
<p>Los archivos que utilizaremos a lo largo de este libro están disponibles en la&nbsp;<strong>carpeta de archivos del libro</strong>, la cual se recomienda descargar y guardar en una&nbsp;<strong>carpeta de trabajo</strong>&nbsp;en tu computadora. Para seguir los ejemplos en este capítulo, asegúrate de tener los archivos en tu carpeta de trabajo y configurar tu directorio de trabajo en RStudio.</p>
<p>El formato&nbsp;<strong>CSV</strong>&nbsp;(Comma-Separated Values) es uno de los más utilizados debido a su simplicidad y compatibilidad. Cada fila en un archivo CSV representa una observación, y los valores dentro de cada fila están separados por comas.</p>
<p>Un ejemplo de cómo podría lucir un archivo CSV:</p>
<pre><code>ID,Edad,Género,Ingreso
1,25,Femenino,1500
2,30,Masculino,2000
3,45,Femenino,2500</code></pre>
<p>El paquete <strong><code>readr</code></strong> es parte del tidyverse y está diseñado para leer archivos CSV.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos el paquete readr</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Al importar un conjunto de datos debemos nombrarlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos el archivo CSV y lo asignamos a un objeto</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>encuesta_csv <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"encuesta.csv"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>encuesta_csv</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Masculino Televisión            34
2 Femenino  Redes sociales        25
3 Femenino  Redes sociales        55
4 Otro      Radio                 63
5 Femenino  Televisión            47
6 Masculino Redes sociales        19
7 Masculino Redes sociales        29
8 Masculino Periódico             75</code></pre>
</div>
</div>
<p>Los archivos de Excel son comunes en las ciencias sociales debido a su facilidad de uso y capacidad para almacenar datos tabulares en varias hojas. El paquete <strong><code>readxl</code></strong> <span class="citation" data-cites="readxl">(<a href="references.html#ref-readxl" role="doc-biblioref">Wickham y Bryan 2023</a>)</span> permite importar estos archivos, ya sea en formato&nbsp;<code>.xls</code>&nbsp;o&nbsp;<code>.xlsx</code>, sin necesidad de tener Excel instalado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos el paquete readxl</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos los datos desde un archivo Excel</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>encuesta_excel <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">"encuesta.xlsx"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>encuesta_excel</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   genero    medio_comunicación  edad
   &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
 1 Masculino Televisión            34
 2 Femenino  Redes sociales        NA
 3 Femenino  Redes sociales        55
 4 Otro      Radio                 63
 5 Femenino  Televisión            NA
 6 Masculino Redes sociales        19
 7 Masculino &lt;NA&gt;                  29
 8 Masculino Periódico             75
 9 Femenino  Redes sociales        55
10 Masculino Televisión            34</code></pre>
</div>
</div>
<p>Si el archivo contiene múltiples hojas, podemos especificar cuál importar utilizando el argumento&nbsp;<code>sheet</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos una hoja específica del archivo Excel</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># encuesta_excel_hoja = read_excel("encuesta.xlsx", </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  sheet = "Resultados")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En ciencias sociales es común trabajar con datos provenientes de software estadístico como Stata o SPSS. Estos formatos incluyen información adicional, como etiquetas de variables, que son importantes para interpretar los datos correctamente. Para trabajar con estos archivos en R, utilizamos el paquete&nbsp;<strong><code>haven</code></strong> <span class="citation" data-cites="haven">(<a href="references.html#ref-haven" role="doc-biblioref">Wickham, Miller, y Smith 2023</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos el paquete haven</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Importamos un archivo Stata y lo asignamos a un objeto</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>encuesta_stata <span class="ot">=</span> <span class="fu">read_dta</span>(<span class="st">"encuesta.dta"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>encuesta_stata</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
   Edad Género    Medio_de_comunicación_preferido
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;                          
1    25 Femenino  Internet                       
2    30 Masculino Televisión                     
3    35 Femenino  Radio                          
4    40 Masculino Prensa Escrita                 
5    28 Femenino  Internet                       </code></pre>
</div>
</div>
<p>O un archivo SPSS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>encuesta_spss <span class="ot">=</span> <span class="fu">read_sav</span>(<span class="st">"encuesta.sav"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>encuesta_spss</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Masculino Televisión            34
2 Femenino  Redes sociales        25
3 Femenino  Redes sociales        55
4 Otro      Radio                 63
5 Femenino  Televisión            47
6 Masculino Redes sociales        19
7 Masculino Redes sociales        29
8 Masculino Periódico             75</code></pre>
</div>
</div>
</section>
<section id="funciones-resumen" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="funciones-resumen"><span class="header-section-number">3.3.2</span> Funciones resumen</h3>
<p>Una vez que hemos importado los datos a R, es fundamental conocer su estructura y contenido antes de proceder con el análisis. Para ello, podemos utilizar una variedad de&nbsp;<strong>funciones resumen</strong>&nbsp;que nos permiten explorar el tibble y obtener información importante sobre las variables y los datos contenidos allí.</p>
<p><strong><code>str()</code></strong> es una función base que describe la estructura del objeto, incluyendo el número de observaciones, las variables y sus tipos. Es muy parecida a <code>glimpse()</code> con la diferencia que es una función base y por lo tanto no depende del ecosistema tidyverse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Información estructural básica del tibble</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(encuesta_csv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [8 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ genero            : chr [1:8] "Masculino" "Femenino" "Femenino" "Otro" ...
 $ medio_comunicación: chr [1:8] "Televisión" "Redes sociales" "Redes sociales" "Radio" ...
 $ edad              : num [1:8] 34 25 55 63 47 19 29 75
 - attr(*, "spec")=
  .. cols(
  ..   genero = col_character(),
  ..   medio_comunicación = col_character(),
  ..   edad = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p><strong><code>glimpse()</code></strong> es una función del tidyverse que proporciona una vista compacta del tibble, mostrando los nombres de las variables, sus tipos de datos y una muestra de valores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos el paquete tibble</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploramos la estructura general del tibble</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(encuesta_csv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 8
Columns: 3
$ genero             &lt;chr&gt; "Masculino", "Femenino", "Femenino", "Otro", "Femen…
$ medio_comunicación &lt;chr&gt; "Televisión", "Redes sociales", "Redes sociales", "…
$ edad               &lt;dbl&gt; 34, 25, 55, 63, 47, 19, 29, 75</code></pre>
</div>
</div>
<p><strong><code>summary()</code></strong> proporciona estadísticas descriptivas básicas para cada columna, como mínimos, máximos, medias, medianas y conteos de valores para variables categóricas. De especial utilidad para el próximo capítulo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen estadístico de las variables</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(encuesta_csv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    genero          medio_comunicación      edad      
 Length:8           Length:8           Min.   :19.00  
 Class :character   Class :character   1st Qu.:28.00  
 Mode  :character   Mode  :character   Median :40.50  
                                       Mean   :43.38  
                                       3rd Qu.:57.00  
                                       Max.   :75.00  </code></pre>
</div>
</div>
<p><strong><code>head()</code></strong> muestra las primeras filas del tibble, permitiendo observar una muestra inicial de los datos. Puedes indicar cuanto valores deseas que devuelva especificando el segundo argumento, por defecto son seis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizamos las primeras seis filas</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(encuesta_csv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Masculino Televisión            34
2 Femenino  Redes sociales        25
3 Femenino  Redes sociales        55
4 Otro      Radio                 63
5 Femenino  Televisión            47
6 Masculino Redes sociales        19</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizamos las primeras dos filas</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(encuesta_csv, <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Masculino Televisión            34
2 Femenino  Redes sociales        25</code></pre>
</div>
</div>
<p><strong><code>tail()</code></strong> es similar a&nbsp;<code>head()</code>, pero muestra las últimas filas del tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizamos las últimas seis filas</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(encuesta_csv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Femenino  Redes sociales        55
2 Otro      Radio                 63
3 Femenino  Televisión            47
4 Masculino Redes sociales        19
5 Masculino Redes sociales        29
6 Masculino Periódico             75</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizamos las últimas dos filas</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(encuesta_csv, <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Masculino Redes sociales        29
2 Masculino Periódico             75</code></pre>
</div>
</div>
<p><strong><code>dim()</code></strong> devuelve las dimensiones del tibble, es decir, el número total de filas y columnas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificamos las dimensiones del tibble</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(encuesta_csv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8 3</code></pre>
</div>
</div>
<p><strong><code>colnames()</code></strong> muestra los nombres de las columnas (variables) del tibble</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Consultamos los nombres de las columnas</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(encuesta_csv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "genero"             "medio_comunicación" "edad"              </code></pre>
</div>
</div>
<p>Perfecto, ya tenemos el primer paso cubierto. Manos a la obra.</p>
</section>
</section>
<section id="limpieza" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="limpieza"><span class="header-section-number">3.4</span> Limpieza</h2>
<p>Una vez que hemos importado los datos, el siguiente paso es&nbsp;<strong>limpiarlos</strong>. Este proceso consiste en identificar y corregir problemas comunes como valores faltantes, nombres de columnas inconsistentes, duplicados y tipos de datos incorrectos. La limpieza asegura que los datos estén en un estado coherente y listo para ser transformado o analizado.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-3973043610.png" class="img-fluid figure-img" width="455"></p>
<figcaption>Extraído de: https://www.teraflow.ai/3-big-benefits-of-data-cleansing/</figcaption>
</figure>
</div>
<p><strong>Manejo de valores faltantes</strong></p>
<p>El&nbsp;<strong>manejo de valores faltantes</strong>&nbsp;es uno de los aspectos más complejos en la limpieza de datos, y un tema importante a considerar al trabajar con conjuntos de datos. Un&nbsp;<strong>valor perdido</strong>&nbsp;o&nbsp;<strong>NA</strong>&nbsp;en R no es lo mismo que un&nbsp;<strong>0</strong>&nbsp;o un espacio vacío. Un valor perdido (o&nbsp;<strong>NA</strong>, que significa “Not Available”) es una celda que no contiene información en absoluto, lo que puede ocurrir por diversas razones, como un error en la recolección de los datos, una respuesta no proporcionada en una encuesta o una omisión involuntaria al momento de ingresar los datos. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>encuesta_excel</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   genero    medio_comunicación  edad
   &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
 1 Masculino Televisión            34
 2 Femenino  Redes sociales        NA
 3 Femenino  Redes sociales        55
 4 Otro      Radio                 63
 5 Femenino  Televisión            NA
 6 Masculino Redes sociales        19
 7 Masculino &lt;NA&gt;                  29
 8 Masculino Periódico             75
 9 Femenino  Redes sociales        55
10 Masculino Televisión            34</code></pre>
</div>
</div>
<p>En R, puedes detectar estos valores con funciones como&nbsp;<code>is.na()</code>, que devuelve un valor lógico (TRUE o FALSE) indicando si un valor es NA. Seleccionamos la columna.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(encuesta_excel<span class="sc">$</span>edad)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>Recuerda que puedes sumar un vector lógico para contar los TRUE. En este caso los valores perdidos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cantidad de valores perdidos </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(encuesta_excel<span class="sc">$</span>edad)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Una de las formas más simples de manejar valores faltantes es eliminarlos por completo. Esto puede hacerse utilizando la función&nbsp;<code>drop_na()</code>&nbsp;del paquete&nbsp;<strong>tidyr</strong> <span class="citation" data-cites="tidyr">(<a href="references.html#ref-tidyr" role="doc-biblioref">Wickham, Vaughan, y Girlich 2024</a>)</span>, que elimina las filas que contienen al menos un valor NA en cualquier columna. Esta es una solución rápida, pero es importante ser cauteloso, ya que puede resultar en la pérdida de información valiosa si hay muchos datos faltantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos tidyr</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminamos filas con valores faltantes</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(encuesta_excel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Masculino Televisión            34
2 Femenino  Redes sociales        55
3 Otro      Radio                 63
4 Masculino Redes sociales        19
5 Masculino Periódico             75
6 Femenino  Redes sociales        55
7 Masculino Televisión            34</code></pre>
</div>
</div>
<p>Comparemos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podemos nombrarlo</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>encuesta_sin_na <span class="ot">=</span> <span class="fu">drop_na</span>(encuesta_excel)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Presta atención a las dimensiones del tibble original y del tibble sin NA</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(encuesta_excel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10  3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(encuesta_sin_na)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7 3</code></pre>
</div>
</div>
<p>Si queremos ser más específicos y eliminar valores faltantes solo en una columna particular, podemos usar:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminamos filas donde la columna 'edad' tiene NA</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>encuesta_sin_na <span class="ot">=</span> <span class="fu">drop_na</span>(encuesta_excel, edad)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>encuesta_sin_na</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  genero    medio_comunicación  edad
  &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
1 Masculino Televisión            34
2 Femenino  Redes sociales        55
3 Otro      Radio                 63
4 Masculino Redes sociales        19
5 Masculino &lt;NA&gt;                  29
6 Masculino Periódico             75
7 Femenino  Redes sociales        55
8 Masculino Televisión            34</code></pre>
</div>
</div>
<p>Aunque eliminar valores faltantes puede ser un enfoque válido en algunos casos, no siempre es ideal. Si eliminamos demasiadas filas, podemos perder una cantidad significativa de información, lo que podría alterar los resultados de nuestro análisis. Por eso, en lugar de eliminar, muchas veces es preferible <strong>imputar</strong> los valores faltantes, es decir, reemplazarlos con un valor estimado. Por ejemplo, algunas estrategias comunes para imputar valores incluyen <strong>reemplazar por el promedio</strong> en el caso de variables numéricas o <strong>reemplazar por la moda</strong> en variables categóricas donde los valores faltantes pueden ser reemplazados por el valor más frecuente (la moda).</p>
<p>Para las siguentes técnicas de limpieza utilizaremos el conjunto de datos <code>encuesta_problematica</code>. Te animo a que puedas identificar que posible problemas tiene antes de seguir adelante.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>datos_problema <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'encuesta_problematica.csv'</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>datos_problema</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID Nombre.PARTICIPANTE EDAD..años. Ingreso.Mensual género
1  1         Luis Bartra          23          1500.0      F
2  2        Carlos Gómez          27          2000.0      M
3  3      Cristina Pérez          23          1500.0      F
4  4         María López          45          2500.0      F
5  5       Javier Muller          35          3800.0      M
6  6          Liz García          29          1800.5      M</code></pre>
</div>
</div>
<p>Si te diste cuenta, utilizamos <strong><code>read.csv</code></strong> en lugar de <strong><code>read_csv</code></strong> del paquete <strong>readr</strong>, ya que <strong><code>read_csv</code></strong> detecta automáticamente el tipo de dato de cada columna, incluso si hay errores en los valores. Para el propósito de este ejemplo, donde queremos ilustrar y solucionar errores comunes en los datos, no lo utilizaremos. ¡Pero ahí tienes otra gran razón para preferir <strong><code>read_csv</code></strong> en tu flujo de trabajo diario!</p>
<p><strong>Estandarización de nombres de columnas</strong></p>
<p>Los nombres de las columnas en los conjuntos de datos pueden ser inconsistentes, incluir caracteres especiales o espacios que dificulten el manejo en R.</p>
<p>Primero, identificamos los nombres originales del conjunto de datos utilizando la función base <code>names()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos_problema)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"                  "Nombre.PARTICIPANTE" "EDAD..años."        
[4] "Ingreso.Mensual"     "género"             </code></pre>
</div>
</div>
<p>Para resolver esto, utilizamos la función <strong><code>clean_names()</code></strong> del paquete <strong>janitor</strong>. Esta función transforma automáticamente los nombres de las columnas en un formato limpio y consistente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar el paquete janitor</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estandarizar los nombres de las columnas</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>datos_problema <span class="ot">=</span> <span class="fu">clean_names</span>(datos_problema)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mostramos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos_problema)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "id"                  "nombre_participante" "edad_anos"          
[4] "ingreso_mensual"     "genero"             </code></pre>
</div>
</div>
<p><strong>Eliminación de duplicados</strong></p>
<p>En algunos casos, los datos pueden contener filas duplicadas que distorsionan el análisis. Podemos identificar y eliminar estas filas utilizando la función <code>distinct()</code> de <code>dplyr</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos dplyr</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminamos filas duplicadas</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>datos_problema <span class="ot">=</span> <span class="fu">distinct</span>(datos_problema)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mostramos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>datos_problema</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id nombre_participante edad_anos ingreso_mensual genero
1  1         Luis Bartra        23          1500.0      F
2  2        Carlos Gómez        27          2000.0      M
3  3      Cristina Pérez        23          1500.0      F
4  4         María López        45          2500.0      F
5  5       Javier Muller        35          3800.0      M
6  6          Liz García        29          1800.5      M</code></pre>
</div>
</div>
<p>Para lo siguientes pasos vamos a utilizar como ejemplo el conjunto de datos <strong>gapminder</strong>. Este conjuto de datos contiene información sobre indicadores socioeconómicos de varios países a lo largo del tiempo. Incluye variables como la esperanza de vida (<code>lifeExp</code>), el PIB per cápita (<code>gdpPercap</code>) y la población a través de los años.</p>
<p>Puedes descargar el conjunto de datos de datos desde la Datáfora o en el siguiente enlace y guardarla en tu carpeta de trabajo: <a href="https://github.com/kirenz/datasets/blob/master/gapminder.csv">gapminder.csv</a>.</p>
<p>Dado que el archivo está en formato <code>.csv</code> (valores separados por comas), utilizaremos la función <code>read_csv()</code> del paquete <code>readr</code>, que forma parte del tidyverse, para leer los datos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos el archivo CSV</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'gapminder.csv'</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos las primeras filas del dataset</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gapminder)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.
2 Afghanistan Asia       1957    30.3  9240934      821.
3 Afghanistan Asia       1962    32.0 10267083      853.
4 Afghanistan Asia       1967    34.0 11537966      836.
5 Afghanistan Asia       1972    36.1 13079460      740.
6 Afghanistan Asia       1977    38.4 14880372      786.</code></pre>
</div>
</div>
<p>Otra opción es instalar y cargar el paquete llamado <code>gapminder</code> <span class="citation" data-cites="gapminder">(<a href="references.html#ref-gapminder" role="doc-biblioref">Bryan 2023</a>)</span>, que contiene el mismo conjunto de datos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar el paquete</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos las primeras filas del dataset</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gapminder)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.
2 Afghanistan Asia       1957    30.3  9240934      821.
3 Afghanistan Asia       1962    32.0 10267083      853.
4 Afghanistan Asia       1967    34.0 11537966      836.
5 Afghanistan Asia       1972    36.1 13079460      740.
6 Afghanistan Asia       1977    38.4 14880372      786.</code></pre>
</div>
</div>
</section>
<section id="manipulación" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="manipulación"><span class="header-section-number">3.5</span> Manipulación</h2>
<p>Una vez limpios nuestros datos pasamos al tercer paso: la manipulación de datos. La manipulación de datos consiste en transformar y preparar los datos para su análisis, lo que puede incluir la creación de nuevas variables, el filtrado de observaciones o la omisión de alguna variable. Para ello, usaremos el paquete <code>dplyr</code> <span class="citation" data-cites="dplyr">(<a href="references.html#ref-dplyr" role="doc-biblioref">Wickham et&nbsp;al. 2023</a>)</span> del tidyverse.</p>
<p><code>dplyr</code> es un paquete del tidyverse diseñado específicamente para la manipulación de datos. Proporciona un conjunto de funciones que permiten seleccionar, filtrar, ordenar, resumir y transformar datos en data.frames. Una de las características más importantes de dplyr es su uso del “pipe operator” (<code>%&gt;%</code>), que permite encadenar múltiples operaciones de manera secuencial, pasando el resultado de una función directamente como entrada a la siguiente. Esto hace que el código sea más fácil de leer y mantener.</p>
<p>El atajo del teclado para el pipe operator (<code>%&gt;%</code>) es:</p>
<ul>
<li><p>Ctrl + Shift + M (Windows)</p></li>
<li><p>Cmd + Shift + M (Mac)</p></li>
</ul>
<p><strong>Un sistema de tuberías</strong></p>
<p>Para poder realizar múltiples acciones en secuencia conectando cada acción con la siguiente a través de “tuberías” debemos utilizar lo que se llama el <em>pipe operator</em> (<code>%&gt;%</code>).</p>
<p><img src="images/clipboard-3784925606.png" class="img-fluid"></p>
<p>Lo iremos viendo, de momento tienes que conocer algunas de las principales funciones de dplyr:</p>
<ul>
<li><code>filter()</code>: Filtra filas de un dataframe según una condición específica.</li>
<li><code>select()</code>: Selecciona columnas específicas de un dataframe.</li>
<li><code>mutate()</code>: Crea nuevas columnas o modifica las existentes en un dataframe.</li>
<li><code>summarize()</code>: Resumen estadístico de las columnas de un dataframe.</li>
<li><code>arrange()</code>: Ordena las filas de un dataframe según una o más variables.</li>
<li><code>group_by()</code>: Agrupa un dataframe por una o más variables, preparándolo para operaciones de resumen.</li>
</ul>
<p>Para empezar a trabajar con <code>dplyr</code> recuerda primero cargarlo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages('dplyr')</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación, verás que muchas de las funciones terminan con un comando <code>head()</code> , esto es únicamente para evitar mostrar todos los datos del data.frame por motivos puramente estéticos del libro.</p>
<section id="funciones-principales" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="funciones-principales"><span class="header-section-number">3.5.1</span> Funciones principales</h3>
<p><strong>Filter()</strong></p>
<p>La función <code>filter()</code> nos ayuda a filtrar filas bajo una condición.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-1638975480.png" class="img-fluid figure-img"></p>
<figcaption>Elaboración propia</figcaption>
</figure>
</div>
<p>Utilizando el pipe operator (<code>%&gt;%</code>) vamos a filtrar nuestros datos únicamente para aquellos que sean del 2007. Para ello nuestra condición sera que la variable <code>year</code> sea igual a 2007.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtramos las filas donde la variable year sea igual a 2007</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mostramos las primeras 5 filas del resultado para fines estéticos</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Afghanistan Asia       2007    43.8 31889923      975.
2 Albania     Europe     2007    76.4  3600523     5937.
3 Algeria     Africa     2007    72.3 33333216     6223.
4 Angola      Africa     2007    42.7 12420476     4797.
5 Argentina   Americas   2007    75.3 40301927    12779.</code></pre>
</div>
</div>
<p>Podemos asignarle un propio nombre</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="ot">=</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora tenemos otro <code>data.frame</code> filtrado solo por los valores que tenían como año el 2007. Podemos resumirlo de la misma forma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder_2007)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [142 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ country  : chr [1:142] "Afghanistan" "Albania" "Algeria" "Angola" ...
 $ continent: chr [1:142] "Asia" "Europe" "Africa" "Africa" ...
 $ year     : num [1:142] 2007 2007 2007 2007 2007 ...
 $ lifeExp  : num [1:142] 43.8 76.4 72.3 42.7 75.3 ...
 $ pop      : num [1:142] 31889923 3600523 33333216 12420476 40301927 ...
 $ gdpPercap: num [1:142] 975 5937 6223 4797 12779 ...
 - attr(*, "spec")=
  .. cols(
  ..   country = col_character(),
  ..   continent = col_character(),
  ..   year = col_double(),
  ..   lifeExp = col_double(),
  ..   pop = col_double(),
  ..   gdpPercap = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>También podemos filtrar con más de una condición. Imaginemos que queremos saber los valores del 2002 del Perú</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtramos las filas donde year sea igual a 2002</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2002</span>, </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Y donde el país sea igual a 'Peru'</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>         country <span class="sc">==</span> <span class="st">'Peru'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  country continent  year lifeExp      pop gdpPercap
  &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Peru    Americas   2002    69.9 26769436     5909.</code></pre>
</div>
</div>
<p>O los países que al año 2007 tenían mas de 100 millones de habitantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtramos las filas donde year sea igual a 2007</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Y donde la población (pop) sea mayor a 100 millones</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>         pop <span class="sc">&gt;</span> <span class="dv">100000000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   country       continent  year lifeExp        pop gdpPercap
   &lt;chr&gt;         &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 Bangladesh    Asia       2007    64.1  150448339     1391.
 2 Brazil        Americas   2007    72.4  190010647     9066.
 3 China         Asia       2007    73.0 1318683096     4959.
 4 India         Asia       2007    64.7 1110396331     2452.
 5 Indonesia     Asia       2007    70.6  223547000     3541.
 6 Japan         Asia       2007    82.6  127467972    31656.
 7 Mexico        Americas   2007    76.2  108700891    11978.
 8 Nigeria       Africa     2007    46.9  135031164     2014.
 9 Pakistan      Asia       2007    65.5  169270617     2606.
10 United States Americas   2007    78.2  301139947    42952.</code></pre>
</div>
</div>
<p><strong>Select()</strong></p>
<p>Utilizamos la función <code>select()</code> para filtrar por las columnas que son de nuestro interés. Muchas veces vamos a querer seleccionar solo algunas para nuestro análisis.</p>
<p><img src="images/clipboard-4017595068.png" class="img-fluid"></p>
<p>Como argumentos <code>select()</code> solo necesita el nombre de la columna de interés.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Seleccionamos solo las columnas country, year y pop</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, pop) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  country      year      pop
  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;
1 Afghanistan  1952  8425333
2 Afghanistan  1957  9240934
3 Afghanistan  1962 10267083
4 Afghanistan  1967 11537966
5 Afghanistan  1972 13079460</code></pre>
</div>
</div>
<p><strong>Arrange()</strong></p>
<p>Utilizamos la función <code>arrange()</code> para poder ordenar las observaciones (filas) que tengamos.</p>
<p><img src="images/clipboard-3710368930.png" class="img-fluid"></p>
<p>Imagina que queremos ordenarlo por quien tenga la menor esperanza de vida.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ordenamos las filas por la columna lifeExp en orden ascendente</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country      continent  year lifeExp     pop gdpPercap
  &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 Rwanda       Africa     1992    23.6 7290203      737.
2 Afghanistan  Asia       1952    28.8 8425333      779.
3 Gambia       Africa     1952    30    284320      485.
4 Angola       Africa     1952    30.0 4232095     3521.
5 Sierra Leone Africa     1952    30.3 2143249      880.</code></pre>
</div>
</div>
<p>Si lo queremos de mayor a menor solo debemos que envolverlo en otra función llamada <code>desc()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ordenamos las filas por la columna lifeExp en orden descendente</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lifeExp)) <span class="sc">%&gt;%</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country          continent  year lifeExp       pop gdpPercap
  &lt;chr&gt;            &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Japan            Asia       2007    82.6 127467972    31656.
2 Hong Kong, China Asia       2007    82.2   6980412    39725.
3 Japan            Asia       2002    82   127065841    28605.
4 Iceland          Europe     2007    81.8    301931    36181.
5 Switzerland      Europe     2007    81.7   7554661    37506.</code></pre>
</div>
</div>
<p>Esto es fenomenal, pero si tomamos a todos los países en cualquier momento no tenemos una fotografía muy clara de los hechos. Quizás convendría mejor analizar los datos únicamente centrándonos en un año. Podemos filtrar los valores solo para el año 2007 con <code>filter()</code> y luego conectarlo con <code>arrange()</code> y <code>desc()</code> para ordenarlo de mayor a menor. Para concatenar acciones solo debemos conectarlas con el pipe operator (<code>%&gt;%</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtramos las filas donde year sea igual a 2007</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ordenamos las filas por la columna lifeExp en orden descendente</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lifeExp)) <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country          continent  year lifeExp       pop gdpPercap
  &lt;chr&gt;            &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Japan            Asia       2007    82.6 127467972    31656.
2 Hong Kong, China Asia       2007    82.2   6980412    39725.
3 Iceland          Europe     2007    81.8    301931    36181.
4 Switzerland      Europe     2007    81.7   7554661    37506.
5 Australia        Oceania    2007    81.2  20434176    34435.</code></pre>
</div>
</div>
<p><strong>Mutate()</strong></p>
<p>Usamos la función <code>mutate()</code> para modificar columna existentes o crear nuevas.</p>
<p><img src="images/clipboard-1384461819.png" class="img-fluid"></p>
<p>Crear una nueva columna con el Producto Interno Bruto (PIB)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creamos una nueva columna llamada PIB_Bruto calculando gdpPercap * pop</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PIB_Bruto =</span> gdpPercap <span class="sc">*</span> pop) <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  country     continent  year lifeExp      pop gdpPercap   PIB_Bruto
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779. 6567086330.
2 Afghanistan Asia       1957    30.3  9240934      821. 7585448670.
3 Afghanistan Asia       1962    32.0 10267083      853. 8758855797.
4 Afghanistan Asia       1967    34.0 11537966      836. 9648014150.
5 Afghanistan Asia       1972    36.1 13079460      740. 9678553274.</code></pre>
</div>
</div>
<p>Crear una nueva columna con el PIB en miles de millones:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creamos una nueva columna llamada PBI_Mil_Millones </span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dividiendo el PIB bruto entre mil millones</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PBI_Mil_Millones =</span> </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>           (gdpPercap <span class="sc">*</span> pop) <span class="sc">/</span> <span class="dv">1000000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  country     continent  year lifeExp      pop gdpPercap PBI_Mil_Millones
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.             6.57
2 Afghanistan Asia       1957    30.3  9240934      821.             7.59
3 Afghanistan Asia       1962    32.0 10267083      853.             8.76
4 Afghanistan Asia       1967    34.0 11537966      836.             9.65
5 Afghanistan Asia       1972    36.1 13079460      740.             9.68</code></pre>
</div>
</div>
<p>También podemos utilizar <code>mutate()</code> para modificar una variable existente, sobreescribiéndola. Supongamos que queremos aumentar en un 10% el PBI per cápita de todos los países.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Modificamos la columna gdpPercap aumentando su valor en un 10%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdpPercap =</span> gdpPercap <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      857.
2 Afghanistan Asia       1957    30.3  9240934      903.
3 Afghanistan Asia       1962    32.0 10267083      938.
4 Afghanistan Asia       1967    34.0 11537966      920.
5 Afghanistan Asia       1972    36.1 13079460      814.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gapminder <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">PBI_Mil_Millones =</span> (gdpPercap <span class="sc">*</span> pop)<span class="sc">/</span><span class="dv">1000000000</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  country     continent  year lifeExp      pop gdpPercap PBI_Mil_Millones
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.             6.57
2 Afghanistan Asia       1957    30.3  9240934      821.             7.59
3 Afghanistan Asia       1962    32.0 10267083      853.             8.76
4 Afghanistan Asia       1967    34.0 11537966      836.             9.65
5 Afghanistan Asia       1972    36.1 13079460      740.             9.68
6 Afghanistan Asia       1977    38.4 14880372      786.            11.7 </code></pre>
</div>
</div>
<p>Finalmente, podemos concatenarlo con el resto de operaciones de la misa forma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Seleccionamos solo las columnas de interés</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, pop, gdpPercap) <span class="sc">%&gt;%</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtramos las filas donde year sea igual a 2007</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ordenamos las filas por la columna gdpPercap en orden descendente</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(gdpPercap)) <span class="sc">%&gt;%</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creamos una nueva columna llamada PBI calculando gdpPercap * pop</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PBI =</span> (gdpPercap <span class="sc">*</span> pop)) <span class="sc">%&gt;%</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mostramos las primeras 5 filas para facilitar la visualización</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  country        year       pop gdpPercap     PBI
  &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 Norway         2007   4627926    49357. 2.28e11
2 Kuwait         2007   2505559    47307. 1.19e11
3 Singapore      2007   4553009    47143. 2.15e11
4 United States  2007 301139947    42952. 1.29e13
5 Ireland        2007   4109086    40676. 1.67e11</code></pre>
</div>
</div>
<p><strong>Summarise() / Reframe()</strong></p>
<p>Cuando queremos obtener estadísticas resumidas de una o más variables (por ejemplo, calcular promedios, totales o conteos) usamos funciones como <code>summarise()</code>. Esta nos permite condensar la información y obtener un nuevo dataframe con solo los valores que nos interesan. En versiones recientes de dplyr, te va a aparecer <code>reframe()</code> en su lugar: esto se debe a que el paquete está actualizando algunos nombres para que reflejen mejor lo que hacen. No te preocupes, lo esencial es lo siguiente: usa <code>summarise()</code> si quieres un resumen compacto, y <code>reframe()</code> si necesitas conservar más de una fila por grupo o mayor flexibilidad.</p>
<p><img src="images/clipboard-4262009664.png" class="img-fluid"></p>
<p>Supongamos que queremos conocer la esperanza de vida media.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculamos la esperanza de vida media</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">espvida_media =</span> <span class="fu">mean</span>(lifeExp))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  espvida_media
          &lt;dbl&gt;
1          59.5</code></pre>
</div>
</div>
<p>Podemos calcular dos cosas a la vez. La esperanza de vida media y el total de la población</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculamos la esperanza de vida media y el total de la población</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">espvida_media =</span> <span class="fu">mean</span>(lifeExp), <span class="at">popTotal =</span> <span class="fu">sum</span>(pop))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  espvida_media    popTotal
          &lt;dbl&gt;       &lt;dbl&gt;
1          59.5 50440465801</code></pre>
</div>
</div>
<p>Intentemos esta vez calcular la esperanza de vida media y el total de la población en América en 2002.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtramos las filas donde year sea igual a 2002</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y el continente sea "Americas"</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2002</span>, continent <span class="sc">==</span> <span class="st">"Americas"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculamos la esperanza de vida media y el total de la población</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">espvida_media =</span> <span class="fu">mean</span>(lifeExp), <span class="at">popTotal =</span> <span class="fu">sum</span>(pop))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  espvida_media  popTotal
          &lt;dbl&gt;     &lt;dbl&gt;
1          72.4 849772762</code></pre>
</div>
</div>
<p>Sin embargo, el verdadero poder de <code>reframe()</code> es cuando lo combinamos con la siguiente función.</p>
<p><strong>Group_by()</strong></p>
<p>Supongamos que queremos calcular la esperanza de vida y el total de la población de todos los países cada año. Para ello podríamos realizar el siguiente código</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empezando por el primer año...</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1952</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">espvida_media =</span> <span class="fu">mean</span>(lifeExp), <span class="at">popTotal =</span> <span class="fu">sum</span>(pop))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  espvida_media   popTotal
          &lt;dbl&gt;      &lt;dbl&gt;
1          49.1 2406957150</code></pre>
</div>
</div>
<p>Lo tenemos para un año, pero si quisiéramos aplicarlo para <strong>cada año</strong> esto sería bastante tedioso y quereriría muchas líneas de código, sin contar con que el resultado estará en dataframes separados. Para esto la función <code>group_by()</code> entra en acción.</p>
<p>La función <code>group_by</code> le dice a dplyr que realice las operaciones por grupos en vez de aplicarlas a todo el datset a la vez.</p>
<p><img src="images/clipboard-3380744810.png" class="img-fluid"></p>
<p>Para ello simplemente tenemos que especificar la variable a agrupar, en este caso, los años.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tomamos el conjunto de datos gapminder</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Agrupamos los datos por la variable year</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculamos la esperanza de vida media y el total de la población por año</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">espvida_media =</span> <span class="fu">mean</span>(lifeExp), <span class="at">popTotal =</span> <span class="fu">sum</span>(pop))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
    year espvida_media   popTotal
   &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
 1  1952          49.1 2406957150
 2  1957          51.5 2664404580
 3  1962          53.6 2899782974
 4  1967          55.7 3217478384
 5  1972          57.6 3576977158
 6  1977          59.6 3930045807
 7  1982          61.5 4289436840
 8  1987          63.2 4691477418
 9  1992          64.2 5110710260
10  1997          65.0 5515204472
11  2002          65.7 5886977579
12  2007          67.0 6251013179</code></pre>
</div>
</div>
<p>Y listo! El nuevo <code>data.frame</code> ahora muestra los datos para cada año en que se tomaron los datos.</p>
</section>
<section id="dplyr-en-acción" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="dplyr-en-acción"><span class="header-section-number">3.5.2</span> Dplyr en acción</h3>
<p>Ahora que hemos aprendido las funciones básicas de <code>dplyr</code>, vamos a ponerlas en práctica con ejemplos concretos.</p>
<p><strong>Calcular la esperanza de vida media y el total de población de cada continente en el 2007, ordenado por mayor esperanza de vida</strong></p>
<p>Podemos filtrar los datos para el año 2007, agruparlos por continente, calcular la esperanza de vida media y el total de población, y luego ordenar los resultados por esperanza de vida media en orden descendente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtramos los datos para el año 2007</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupamos los datos por continente</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos la esperanza de vida media y el total de población</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">espvida_media =</span> <span class="fu">mean</span>(lifeExp), <span class="at">popTotal =</span> <span class="fu">sum</span>(pop)) <span class="sc">%&gt;%</span>  </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenamos los resultados por esperanza de vida media en orden descendente</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(espvida_media))  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  continent espvida_media   popTotal
  &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;
1 Oceania            80.7   24549947
2 Europe             77.6  586098529
3 Americas           73.6  898871184
4 Asia               70.7 3811953827
5 Africa             54.8  929539692</code></pre>
</div>
</div>
<p><strong>Crear una nueva columna con el PIB total (PIB per cápita * población) y filtrar los países con un PIB total mayor a 1 billón en 2007</strong></p>
<p>Vamos a crear una nueva columna para el PIB total, filtrar los datos para el año 2007, y luego seleccionar solo los países con un PIB total mayor a 1 billón.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una nueva columna para el PIB total</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PIB_Total =</span> gdpPercap <span class="sc">*</span> pop) <span class="sc">%&gt;%</span> </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtramos los datos para el año 2007 y PIB total mayor a 1 billón</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, PIB_Total <span class="sc">&gt;</span> <span class="fl">1e12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos las columnas de interés</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, continent, PIB_Total) <span class="sc">%&gt;%</span>  </span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenamos los resultados por PIB total en orden descendente</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(PIB_Total))  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   country        continent PIB_Total
   &lt;chr&gt;          &lt;chr&gt;         &lt;dbl&gt;
 1 United States  Americas    1.29e13
 2 China          Asia        6.54e12
 3 Japan          Asia        4.04e12
 4 India          Asia        2.72e12
 5 Germany        Europe      2.65e12
 6 United Kingdom Europe      2.02e12
 7 France         Europe      1.86e12
 8 Brazil         Americas    1.72e12
 9 Italy          Europe      1.66e12
10 Mexico         Americas    1.30e12
11 Canada         Americas    1.21e12
12 Spain          Europe      1.17e12
13 Korea, Rep.    Asia        1.15e12</code></pre>
</div>
</div>
<p><strong>Calcular la esperanza de vida media y el total de población de cada continente a lo largo del tiempo</strong></p>
<p>En este ejemplo, queremos ver cómo ha cambiado la esperanza de vida media y la población total en cada continente a lo largo del tiempo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos 'x'</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupamos los datos por continente y año</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos la esperanza de vida media y el total de población</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">espvida_media =</span> <span class="fu">mean</span>(lifeExp), <span class="at">popTotal =</span> <span class="fu">sum</span>(pop)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenamos los resultados por continente y año</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(continent, year)  </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos únicamente los primeros 12 (África) por motivos estéticos</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x, <span class="dv">12</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
# Groups:   continent [1]
   continent  year espvida_media  popTotal
   &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
 1 Africa     1952          39.1 237640501
 2 Africa     1957          41.3 264837738
 3 Africa     1962          43.3 296516865
 4 Africa     1967          45.3 335289489
 5 Africa     1972          47.5 379879541
 6 Africa     1977          49.6 433061021
 7 Africa     1982          51.6 499348587
 8 Africa     1987          53.3 574834110
 9 Africa     1992          53.6 659081517
10 Africa     1997          53.6 743832984
11 Africa     2002          53.3 833723916
12 Africa     2007          54.8 929539692</code></pre>
</div>
</div>
<p><strong>Comparar la esperanza de vida y el PIB per cápita entre dos países específicos (Perú y Chile) en 2007</strong></p>
<p>Vamos a filtrar los datos para los países Perú y Chile en el año 2007, y comparar la esperanza de vida y el PIB per cápita entre ellos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtramos los datos para Perú y Chile en el año 2007</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Peru"</span>, <span class="st">"Chile"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos las columnas de interés</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, lifeExp, gdpPercap) <span class="sc">%&gt;%</span>  </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenamos los resultados por país</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  country lifeExp gdpPercap
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Chile      78.6    13172.
2 Peru       71.4     7409.</code></pre>
</div>
</div>
<p><strong>Crear una nueva columna con la relación PIB per cápita y esperanza de vida, y analizar esta relación para los países en Asia en 2007</strong></p>
<p>Podemos crear una nueva columna para la relación entre PIB per cápita y esperanza de vida, y luego analizamos esta relación para los países en Asia en 2007.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtramos los datos para los países en Asia en 2007</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, continent <span class="sc">==</span> <span class="st">"Asia"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una nueva columna para la relación PIB per cápita / esperanza de vida</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PIB_vs_vida =</span> gdpPercap <span class="sc">/</span> lifeExp) <span class="sc">%&gt;%</span> </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos las columnas de interés</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, PIB_vs_vida) <span class="sc">%&gt;%</span> </span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenamos los resultados por la relación PIB per cápita / esperanza de vida en orden descendente</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(PIB_vs_vida))  </span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   country          PIB_vs_vida
   &lt;chr&gt;                  &lt;dbl&gt;
 1 Kuwait                  610.
 2 Singapore               589.
 3 Hong Kong, China        483.
 4 Bahrain                 394.
 5 Japan                   383.
 6 Taiwan                  366.
 7 Israel                  316.
 8 Saudi Arabia            298.
 9 Korea, Rep.             297.
10 Oman                    295.</code></pre>
</div>
</div>
</section>
</section>
<section id="visualización" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="visualización"><span class="header-section-number">3.6</span> Visualización</h2>
<p>La última etapa del flujo de trabajo es la <strong>visualización de datos</strong>. Poder visualizar la información no solo nos ayuda a a anticipar ciertos patrones y comportamientos, sino que también facilita la comunicación de estos hallazgos a otros. Es importante reconocer que tendemos a dejarnos llevar más por los gráficos que por los resúmenes numéricos, aunque ambos sean igualmente importantes.</p>
<p><code>ggplot2</code> es uno de los paquetes más populares y poderosos en R para la creación de gráficos. Para generar gráficos adecuados en R, necesitamos considerar dos elementos fundamentales: el elemento estadístico y el elemento de diseño. La finalidad de un gráfico es resumir y transmitir información de manera adecuada para el análisis que estamos realizando, sin olvidar la importancia de un diseño atractivo. <code>ggplot2</code> <span class="citation" data-cites="ggplot2">(<a href="references.html#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span> consigue ambos objetivos.</p>
<p>Antes de empezar a usar <code>ggplot2</code>, necesitamos instalarlo y cargarlo. de R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalación del paquete ggplot2 (en caso no esté instalado)</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages('ggplot2')</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga del paquete ggplot2</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="fundamentos-de-ggplot2" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="fundamentos-de-ggplot2"><span class="header-section-number">3.6.1</span> Fundamentos de ggplot2</h3>
<p>La creación de gráficos con <code>ggplot2</code> se basa en la gramática de los gráficos (Grammar of Graphics). Esta gramática define una serie de componentes que forman parte de un gráfico:</p>
<ol type="1">
<li><strong>Datos</strong>: El conjunto de datos que queremos visualizar.</li>
<li><strong>Estética</strong>: La asignación de variables a aspectos visuales del gráfico, como posición, color, tamaño, etc.</li>
<li><strong>Geometría</strong>: El tipo de gráfico (barras, puntos, líneas, etc.).</li>
<li><strong>Facetas</strong>: Subdivisiones del gráfico en múltiples paneles basados en una o más variables.</li>
<li><strong>Estadísticas</strong>: Transformaciones estadísticas que se aplican a los datos antes de graficarlos.</li>
<li><strong>Coordenadas</strong>: El sistema de coordenadas usado (cartesiano, polar, etc.).</li>
<li><strong>Tema</strong>: Elementos de diseño y formato del gráfico.</li>
</ol>
<p>Piensa en cada uno de ellos como una capa que va encima. Para construir un gráfico en <code>ggplot2</code>, concatenamos diferentes capas usando el operador <code>+</code>. Cada capa añade un nuevo componente al gráfico.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-1644515835.png" class="img-fluid figure-img"></p>
<figcaption>Extraído de: https://cristoichkov.github.io</figcaption>
</figure>
</div>
<p>Vamos a empezar con un gráfico de dispersión básico utilizando el conjunto de datos <code>gapminder</code>. Este conjunto contiene datos sobre el Producto Interno Bruto (PIB) per cápita, la esperanza de vida y otros indicadores para varios países a lo largo del tiempo.</p>
<p>Empezamos agregando la primera capa, los datos. Para comenzar, creamos la base del gráfico con la función <code>ggplot()</code>, y como argumento el conjunto de datos <code>gapminder</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como ves, los datos por si solos únicamente nos dan un recuadro blanco, debemos añadir el resto de capas. Definimos las estéticas del gráfico con la función <code>aes()</code>, asignando el PIB per cápita al eje x (<code>gdpPercap</code>) y la esperanza de vida al eje y (<code>lifeExp</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora que R sabe qué datos vamos a utilizar y qué variables tomar como coordenadas, necesitamos especificar qué tipo de gráfico queremos crear. En <code>ggplot2</code>, hay muchas <code>geoms</code> (geometrías), y cada una proporciona un tipo de gráfico diferente. Por ejemplo, <code>geom_bar</code> crea un gráfico de barras y <code>geom_line</code> crea un gráfico de líneas. En este caso, como ambas variables (PIB per cápita y esperanza de vida) son numéricas, usaremos un gráfico de dispersión (puntos) para visualizar la relación entre ellas. Para ello, usamos <code>geom_point()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En este ejemplo, <code>aes(x = gdpPercap, y = lifeExp)</code> define la estética del gráfico, asignando el Producto Interno Bruto per cápita al eje x y la esperanza de vida al eje y. <code>geom_point()</code> especifica que queremos un gráfico de dispersión. Ya puedes lanzarte a sacar tus primeras conclusiones.</p>
<p>Algo que podemos notar es que el gráfico se ve un poco apretado al principio. Para mejorar la visualización, podemos usar una escala logarítmica en el eje x. Esto transforma los datos para que las diferencias entre los puntos se aprecien mejor, especialmente cuando algunos países tienen un PIB per cápita muy alto y otros muy bajo. Solo recuerda que usar una escala logarítmica cambia la manera en que interpretamos el gráfico, así que debemos tenerlo en cuenta.</p>
<p>Usamos <code>scale_x_log10()</code> para transformar el eje x a una escala logarítmica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En este caso, hemos añadido <code>scale_x_log10()</code> para aplicar la escala logarítmica en el eje x. Esto clarifica la relación entre las variables, permitiéndonos observar que un mayor PIB per cápita generalmente se asocia con una mayor esperanza de vida.</p>
<p>También podemos añadir otros elementos estéticos para mejorar la visualización, como el color de los puntos basado en el continente. Para ello, modificamos <code>aes()</code> para incluir <code>color = continent</code>, lo que añade color a los puntos según el continente. Recuerda que <code>continent</code> es una variable categórica del conjunto de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> lifeExp, </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Te animo a que sigas intentando identificar patrones importantes. Por ejemplo, ¿dónde se encuentran los puntos asociados a determinados continentes? ¿Existe alguna relación entre el continente y las otras dos variables?</p>
<p>Este gráfico ya es de por si sumamente útil pero si deseamos poder comunicarlo cada uno de los elementos deben estar debidamente nombrados. Para ello, es importante añadir etiquetas y títulos para mejorar la interpretación del gráfico. Esto lo podemos hacer agregando una capa más con la función <code>labs()</code> y usando como argumentos <code>title</code>, <code>x</code>, <code>y</code> y <code>color</code>.</p>
<p>Usamos <code>labs()</code> para añadir un título y etiquetas a los ejes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relación entre PIB per cápita y Esperanza de Vida"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"PIB per cápita (log10)"</span>,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Esperanza de Vida"</span>,</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"Continente"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Otra capa opcional que también podemos agregar es el <code>facet</code>. El facetado permite dividir el gráfico en múltiples paneles basados en una o más variables. Por ejemplo, podemos crear un gráfico separado para cada continente.</p>
<p>Usamos <code>facet_wrap(~ continent)</code> para dividir el gráfico en múltiples paneles, uno para cada continente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relación entre PIB per cápita y Esperanza de Vida"</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"PIB per cápita (log10)"</span>,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Esperanza de Vida"</span>,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Continente"</span>) <span class="sc">+</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> continent) <span class="sc">+</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Puedes quitar la leyenda con esta capa adicional</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Tenemos la última capa, los themes. La capa de themes tiene una multitud de funciones que permiten modificar de forma precisa el tamaño, posición o forma de casi todos los elementos del gráfico. Por ejemplo, en el gráfico anterior eliminamos la leyenda usando un theme. Los themes permiten personalizar la apariencia del gráfico de manera detallada.Esta guía no tiene como objetivo explorar la complejidad de los themes en profundidad, así que nos centraremos en los themes predeterminados.</p>
<p>¿Recuerdas el gráfico que generamos antes de los facets? Vamos a volver a utilizarlo para ejemplificar los diversos temas en ggplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relación entre PIB per cápita y Esperanza de Vida"</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"PIB per cápita (log10)"</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Esperanza de Vida"</span>,</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"Continente"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pero no tenemos que volver a escribirlo. Verás, los gráficos también son un tipo de objeto en R así que puedes ser almacenarlos en forma de una variable. De esta forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>grafico <span class="ot">=</span> <span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relación entre PIB per cápita y Esperanza de Vida"</span>,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"PIB per cápita (log10)"</span>,</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Esperanza de Vida"</span>,</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"Continente"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora solo basta con llamarlo por su recien adquirido nombre</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>grafico</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como decíamos, existen varios themes predeterminados en ggplot2. Los themes en <code>ggplot2</code> permiten personalizar la apariencia de los gráficos de manera detallada. Existen varios themes predeterminados que se pueden usar para cambiar el aspecto de los gráficos sin necesidad de realizar configuraciones complejas.</p>
<p>Ya que nombramos al objeto gráfico, podemos añadir una capa fácilmente con el signo <code>+</code></p>
<p>El <code>theme_minimal</code> es un tema limpio y sencillo, con un fondo blanco y líneas de cuadrícula ligeras.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>grafico <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El <code>theme_gray</code> es el tema predeterminado en <code>ggplot2</code>, con un fondo gris claro y líneas de cuadrícula blancas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>grafico <span class="sc">+</span> <span class="fu">theme_gray</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El <code>theme_bw</code> es similar al <code>theme_gray</code>, pero utiliza un fondo blanco y es útil para presentaciones en blanco y negro.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>grafico <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El <code>theme_classic</code> se asemeja los gráficos clásicos de R base, con un fondo blanco y ejes negros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>grafico <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El <code>theme_void</code> elimina todos los elementos no esenciales del gráfico, dejando solo los datos. Es útil para gráficos personalizados donde se desea agregar y tener control de cada cosa de forma manual.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>grafico <span class="sc">+</span> <span class="fu">theme_void</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El <code>theme_dark</code> utiliza un fondo oscuro con líneas de cuadrícula claras.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>grafico <span class="sc">+</span> <span class="fu">theme_dark</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Cada uno de estos themes puede ser modificado y combinado con otros elementos para crear gráficos personalizados según las necesidades específicas del análisis. En particular, utilizaré el theme_minimal por preferencia personal. Pero recuerdas que puedes utilizar el que se adapte mejor a tus necesidades.</p>
</section>
<section id="tipos-de-gráficos" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="tipos-de-gráficos"><span class="header-section-number">3.6.2</span> Tipos de gráficos</h3>
<p>Así como existen diferentes tipos de variables, también hay diversos gráficos que se pueden utilizar para representarlas adecuadamente. A continuación, se presentan algunos de los gráficos más importantes y que se utilizarán en los próximos capítulos.</p>
<p><strong>Gráfico de barras</strong></p>
<p>Un gráfico de barras es útil para visualizar la frecuencia de categorías o la comparación de cantidades entre diferentes categorías.</p>
<p>Para crear un gráfico de barras en R, podemos usar la función <code>geom_bar()</code>. Si solo queremos contar las observaciones en una sola variable, podemos usar <code>geom_bar()</code> sin especificar ambos ejes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cuenta simple</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Frecuencia de países por continente"</span>,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Continente"</span>,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En este caso, el argumento <code>fill</code> se utiliza para rellenar las barras con colores diferentes según la categoría (en este caso, el continente). La diferencia entre <code>fill</code> y <code>color</code> es que <code>fill</code> se utiliza para rellenar el interior de las formas (como barras o áreas), mientras que <code>color</code> se usa para definir el color de los bordes de las formas.</p>
<p>Pero cuando queremos especificar ambos ejes, como cuando estamos comparando cantidades específicas entre categorías, usamos <code>geom_col</code> y especificamos ambos ejes en <code>aes</code>:</p>
<p>Por ejemplo, vamos a contar el número de países en cada continente que tienen una esperanza de vida mayor a 75 años en el año 2007.</p>
<p>Primero preparamos los datos con <code>dplyr</code>, filtrando los datos para el año 2007 y luego contando los países por continente con una esperanza de vida mayor a 75 años.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, lifeExp <span class="sc">&gt;</span> <span class="dv">75</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n_distinct</span>(country)  <span class="co"># Contar el número de países únicos</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aquí tenemos los datos preparados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>datos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent     n
  &lt;chr&gt;     &lt;int&gt;
1 Africa        1
2 Americas     10
3 Asia          9
4 Europe       22
5 Oceania       2</code></pre>
</div>
</div>
<p>Luego, creamos el gráfico de barras especificando ambas coordenadas con <code>geom_col()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podemos usar la función reorder() para ordenar de mayor a menor en el gráfico</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, n), <span class="at">y =</span> n, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Países con esperanza de vida mayor a 75 años en 2007"</span>,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continente"</span>,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Número de Países"</span>,</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Continente"</span>) <span class="sc">+</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Podemos invertir fácilmente el gráfico usando <code>coord_flip()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, n), <span class="at">y =</span> n, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Países con esperanza de vida mayor a 75 años en 2007"</span>,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continente"</span>,</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Número de Países"</span>,</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Continente"</span>) <span class="sc">+</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Histograma</strong></p>
<p>Un histograma es útil para visualizar la distribución de una variable numérica. Muestra la frecuencia de valores en intervalos específicos.</p>
<p>Para crear un histograma en R, usamos la función <code>geom_histogram()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de la esperanza de vida"</span>,</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Esperanza de vida"</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráfico de líneas</strong></p>
<p>Un gráfico de líneas es útil para visualizar la tendencia de una variable a lo largo del tiempo.</p>
<p>Para preparar los datos, calculamos la esperanza de vida media por año:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
    year lifeExp_mean
   &lt;dbl&gt;        &lt;dbl&gt;
 1  1952         49.1
 2  1957         51.5
 3  1962         53.6
 4  1967         55.7
 5  1972         57.6
 6  1977         59.6
 7  1982         61.5
 8  1987         63.2
 9  1992         64.2
10  1997         65.0
11  2002         65.7
12  2007         67.0</code></pre>
</div>
</div>
<p>Otra ventaja de usar <code>dplyr</code> y <code>ggplot</code> juntos es que podemos unir ambos códigos con un pipe operator. Usamos <code>geom_line(color = "blue")</code> para crear el gráfico de líneas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)) <span class="sc">%&gt;%</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tendencia de la esperanza de vida media a lo largo del tiempo"</span>,</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Año"</span>,</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Esperanza de vida media"</span>) <span class="sc">+</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Boxplot</strong></p>
<p>Un boxplot es útil para visualizar la distribución de una variable y comparar distribuciones entre diferentes categorías. Hablaremos de él de forma mas rigurosa en el siguiente capítulo</p>
<p>Para crear el boxplot de la esperanza de vida por continente, usamos <code>geom_boxplot()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> lifeExp, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de la esperanza de vida por continente"</span>,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continente"</span>,</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Esperanza de vida"</span>) <span class="sc">+</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Estos son algunos de los tipos de gráficos que utilizaremos para analizar datos en los próximos capítulos. Cada uno tiene su utilidad específica y pueden añadirse más detalles en función del objetivo que se tenga para la investigación.</p>
</section>
</section>
<section id="flor-y-el-análisis-del-bienestar-social" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="flor-y-el-análisis-del-bienestar-social"><span class="header-section-number">3.7</span> Flor y el análisis del bienestar social</h2>
<p>Flor encontró un conjunto de datos abierto sobre <strong>indicadores de bienestar social</strong>, que incluía información reciente sobre ingresos, niveles educativos y acceso a servicios básicos en diversas regiones.</p>
<p>Flor descargó un archivo CSV y lo IMPORTÓ a R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>bienestar <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"datos_bienestar.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analiza la estructura de los datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bienestar)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,020
Columns: 4
$ Region               &lt;chr&gt; "Sur", "Oeste", "Sur", "Este", "Este", "Norte", "…
$ `Ingreso Mensual`    &lt;dbl&gt; 2018, 1705, 3321, 3101, 1293, 2424, 1783, 843, 26…
$ `Nivel Educativo`    &lt;chr&gt; "Secundaria", "Superior", "Secundaria", "Primaria…
$ `Acceso a Servicios` &lt;dbl&gt; 73.6, 77.2, 99.5, 95.1, 62.3, 86.9, 79.1, 58.1, 9…</code></pre>
</div>
</div>
<p>Al explorar los datos, encontró variables como:</p>
<ul>
<li><p><code>region</code>: La región de cada observación. - <code>ingreso_mensual</code>: El ingreso promedio mensual de cada hogar.</p></li>
<li><p><code>nivel_educativo</code>: Nivel educativo mas alto alcanzado por la mayoría (Primaria, Secundaria, Superior).</p></li>
<li><p><code>acceso_servicios</code>: Porcentaje de hogares con acceso a servicios básicos (agua y electricidad).</p></li>
</ul>
<p>Primero, los nombres de las columnas no eran uniformes y contenían espacios que complicaban su manipulación. Decidió solucionar estos problemas antes de continuar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>bienestar <span class="ot">=</span> <span class="fu">clean_names</span>(bienestar)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bienestar)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "region"             "ingreso_mensual"    "nivel_educativo"   
[4] "acceso_a_servicios"</code></pre>
</div>
</div>
<p>Además, al revisar el conjunto de datos, Flor notó algunos <strong>VALORES FALTANTES</strong> en <code>ingreso_mensual</code>. Se dispone a comprobar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(bienestar<span class="sc">$</span>ingreso_mensual)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51</code></pre>
</div>
</div>
<p>Tenemos 51 valores perdidos. En este caso en particular, tomó la decisión de eliminarlos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>bienestar <span class="ot">=</span> <span class="fu">drop_na</span>(bienestar)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Flor decidió explorar las <strong>diferencias en el ingreso promedio por región</strong> y cómo estas se relacionaban con el nivel educativo y el acceso a servicios básicos. Para ello tuvo que MANIPULAR los datos usando <strong>dplyr</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculó el ingreso promedio por región</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupa por región y calcula el ingreso promedio</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>ingreso_por_region <span class="ot">=</span> bienestar <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ingreso_promedio =</span> <span class="fu">mean</span>(ingreso_mensual))</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>ingreso_por_region</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  region ingreso_promedio
  &lt;chr&gt;             &lt;dbl&gt;
1 Centro            2537.
2 Este              2408.
3 Norte             2524.
4 Oeste             2538.
5 Sur               2513.</code></pre>
</div>
</div>
<p>Flor notó que algunas regiones tenían ingresos más altos. Esto la llevó a preguntarse si el acceso a servicios básicos podría explicar parte de estas diferencias.Flor creó una tabla que mostraba el ingreso promedio y el acceso promedio a servicios básicos por región.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupam por región y calcula el ingreso promedio y acceso promedio</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>bienestar_region <span class="ot">=</span> bienestar <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ingreso_promedio =</span> <span class="fu">mean</span>(ingreso_mensual),</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">acceso_servicios_promedio =</span> <span class="fu">mean</span>(acceso_a_servicios)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>bienestar_region</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  region ingreso_promedio acceso_servicios_promedio
  &lt;chr&gt;             &lt;dbl&gt;                     &lt;dbl&gt;
1 Centro            2537.                      87.5
2 Este              2408.                      85.8
3 Norte             2524.                      87.9
4 Oeste             2538.                      88.2
5 Sur               2513.                      87.3</code></pre>
</div>
</div>
<p>Una alternativa que planteó para simplificar la comparación fue clasificar los ingresos en “Altos” y “Bajos” según el promedio nacional. Para ello, integró la función&nbsp;<code>ifelse()</code> a su estructura de dplyr. <code>ifelse()</code> está estructurada para evaluar condiciones lógicas. En este caso, se escribe como&nbsp;<code>ifelse(ingreso_mensual &gt; promedio_nacional, "Alto", "Bajo")</code>, donde la condición (<code>ingreso_mensual &gt; promedio_nacional</code>) se evalúa para cada fila del vector. Si es verdadera (<code>TRUE</code>), se asigna el valor&nbsp;<code>"Alto"</code>, y si es falsa (<code>FALSE</code>), se asigna&nbsp;<code>"Bajo"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcula el ingreso promedio nacional</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>promedio_nacional <span class="ot">=</span> <span class="fu">mean</span>(bienestar<span class="sc">$</span>ingreso_mensual)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>promedio_nacional</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2508.653</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea una nueva columna con la clasificación de ingresos</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>bienestar <span class="ot">=</span> bienestar <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">categoria_ingreso =</span> </span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(ingreso_mensual <span class="sc">&gt;</span> promedio_nacional, <span class="co"># Condición</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Alto"</span>,                              <span class="co"># Si la condición es verdadera</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Bajo"</span>)                              <span class="co"># Si la condición es falsa</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bienestar, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   region ingreso_mensual nivel_educativo acceso_a_servicios categoria_ingreso
   &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;            
 1 Sur               2018 Secundaria                    73.6 Bajo             
 2 Oeste             1705 Superior                      77.2 Bajo             
 3 Sur               3321 Secundaria                    99.5 Alto             
 4 Este              3101 Primaria                      95.1 Alto             
 5 Este              1293 Secundaria                    62.3 Bajo             
 6 Norte             2424 Primaria                      86.9 Bajo             
 7 Centro            1783 Primaria                      79.1 Bajo             
 8 Este               843 Primaria                      58.1 Bajo             
 9 Centro            2620 Superior                      97.4 Alto             
10 Sur               2437 Superior                      91.6 Bajo             </code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Ilustración_sin_título 1.png" class="img-fluid figure-img" width="453"></p>
<figcaption>Manipular datos es parte esencial de un análisis bien estrcuturado</figcaption>
</figure>
</div>
<p>Flor era consciente de que podía interpretar mejor sus resultados visualmente asi que decidió usar ggplot2 para crear VISUALIZACIONES.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quería mostrar cómo variaba el ingreso promedio entre regiones. Usó <code>geom_col()</code> para crear un gráfico de barras.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras del ingreso promedio por región</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ingreso_por_region, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, ingreso_promedio), </span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> ingreso_promedio, </span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ingreso Promedio por Región"</span>,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Región"</span>,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ingreso Promedio"</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Luego, quería explorar la relación entre el ingreso y el acceso a servicios básicos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de dispersión por localidad</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bienestar, <span class="fu">aes</span>(<span class="at">x =</span> acceso_a_servicios, </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> ingreso_mensual, </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># Le puso puntos con transparencia para mejor visualización</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  </span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relación entre Acceso a Servicios Básicos e Ingreso por Localidad"</span>,</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Acceso a Servicios Básicos (%)"</span>,</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ingreso Mensual"</span>,</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Región"</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finalmente, Flor decidió analizar cómo variaba el ingreso por nivel educativo, usando facetas para separar cada región.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de facetas</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bienestar, <span class="fu">aes</span>(<span class="at">x =</span> nivel_educativo, </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> ingreso_mensual, </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill =</span> nivel_educativo)) <span class="sc">+</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region) <span class="sc">+</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ingreso Mensual por Nivel Educativo y Región"</span>,</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Nivel Educativo"</span>,</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ingreso Mensual"</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="integración_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Ilustración_sin_título 2.png" class="img-fluid figure-img" width="444"></p>
<figcaption>Los gráficos nos ayudan a representar el comportamiento de nuestras variables y la relación entre ellas</figcaption>
</figure>
</div>
</section>
<section id="resumen-del-capítulo" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="resumen-del-capítulo"><span class="header-section-number">3.8</span> Resumen del capítulo</h2>
<p>El análisis de datos en R se estructura como un flujo lógico que empieza con la importación de datos, continúa con su limpieza, exploración y transformación, y finaliza con visualizaciones claras. En este libro el flujo lo hemos ejecutado principalmente con herramientas del <em>tidyverse</em>, una colección de paquetes diseñados para ser compatibles entre sí y mantener una sintaxis consistente.</p>
<p>Los datos se trabajan sobre estructuras tabulares, como <code>data.frame</code> y <code>tibble</code>, que permiten manejar variables de distintos tipos. Para importar datos se utilizan funciones como <code>read_csv()</code> para archivos CSV, <code>read_excel()</code> para Excel y <code>read_dta()</code> o <code>read_sav()</code> para formatos de Stata y SPSS.</p>
<p>La limpieza de datos es crítica. Se identifican y eliminan valores faltantes con <code>is.na()</code> y <code>drop_na()</code>, se estandarizan nombres con <code>clean_names()</code> del paquete <code>janitor</code>, se eliminan duplicados con <code>distinct()</code> y se corrigen tipos de datos con <code>as.numeric()</code> o funciones equivalentes. La inspección estructural se apoya en funciones como <code>str()</code>, <code>glimpse()</code>, <code>summary()</code>, <code>head()</code> y <code>dim()</code>.</p>
<p>La transformación y manipulación se organiza mediante <code>dplyr</code>. Con <code>filter()</code> se filtran filas, <code>select()</code> permite aislar columnas, <code>mutate()</code> crea o modifica variables, <code>arrange()</code> ordena observaciones, <code>group_by()</code> agrupa por categorías, y <code>summarise()</code> / <code>reframe()</code> extrae estadísticas resumidas. El uso del operador <code>%&gt;%</code> permite encadenar acciones una tras de otra.</p>
<p>Para visualizar se emplea <code>ggplot2</code>, que construye gráficos en capas a partir de una gramática declarativa. Se definen las estéticas con <code>aes()</code>, se elige la geometría adecuada (<code>geom_point()</code>, <code>geom_col()</code>, <code>geom_histogram()</code>, <code>geom_boxplot()</code>…), se pueden usar facetas con <code>facet_wrap()</code>, transformar escalas como con <code>scale_x_log10()</code> y ajustar diseño con <code>theme_minimal()</code> u otros temas prediseñados. Las visualizaciones se optimizan añadiendo títulos y etiquetas con <code>labs()</code> y organizando el gráfico en objetos que pueden modificarse sucesivamente.</p>
</section>
<section id="ejercicios" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="ejercicios"><span class="header-section-number">3.9</span> Ejercicios</h2>
<p><strong>1. Tienes un archivo llamado <code>datos_bienestar.csv</code>. ¿Cuál es la forma correcta de cargarlo en R usando el paquete <code>readr</code>?</strong></p>
<ol type="a">
<li><p><code>read.csv("datos_bienestar.csv")</code></p></li>
<li><p><code>read_csv("datos_bienestar.csv")</code></p></li>
<li><p><code>library(readr)</code> seguido de <code>read_csv("datos_bienestar.csv")</code></p></li>
<li><p><code>library(dplyr)</code> seguido de <code>read_csv("datos_bienestar.csv")</code></p></li>
</ol>
<p><strong>2. Después de importar los datos, Flor notó que los nombres de las columnas contenían espacios y caracteres especiales. ¿Qué paquete y función usó para estandarizar los nombres de las columnas?</strong></p>
<ol type="a">
<li><p><code>tidyr</code> y <code>drop_na()</code></p></li>
<li><p><code>janitor</code> y <code>clean_names()</code></p></li>
<li><p><code>dplyr</code> y <code>mutate()</code></p></li>
<li><p><code>tibble</code> y <code>glimpse()</code></p></li>
</ol>
<p><strong>3. ¿Cómo puedes contar cuántos valores faltantes (<code>NA</code>) hay en la columna <code>ingreso_mensual</code> de un dataframe llamado <code>bienestar</code>?</strong></p>
<ol type="a">
<li><p><code>sum(bienestar$ingreso_mensual == NA)</code></p></li>
<li><p><code>is.na(bienestar$ingreso_mensual)</code></p></li>
<li><p><code>sum(is.na(bienestar$ingreso_mensual))</code></p></li>
<li><p><code>measure(is.na(bienestar$ingreso_mensual))</code></p></li>
</ol>
<p><strong>4. Flor quiere trabajar únicamente con las filas donde la región sea “Norte”. ¿Qué código es correcto para este propósito?</strong></p>
<ol type="a">
<li><p><code>filter(bienestar$region == "Norte")</code></p></li>
<li><p><code>bienestar %&gt;% filter(region == "Norte")</code></p></li>
<li><p><code>bienestar %&gt;% select(region == "Norte")</code></p></li>
<li><p><code>bienestar %&gt;% filter(region = "Norte")</code></p></li>
</ol>
<p><strong>5. Flor quiere crear una nueva columna llamada <code>acceso_clasificado</code> que clasifique el acceso a servicios básicos en “Alto” si es mayor al 70% y “Bajo” si no. ¿Qué código es correcto?</strong></p>
<ol type="a">
<li><p><code>mutate(acceso_clasificado = ifelse(acceso_servicios &gt; 70, "Alto", "Bajo"))</code></p></li>
<li><p><code>mutate(acceso_servicios = ifelse(acceso_servicios &gt; 70, "Alto", "Bajo"))</code></p></li>
<li><p><code>bienestar %&gt;% mutate(acceso_clasificado = ifelse(acceso_servicios &gt; 70, "Alto", "Bajo"))</code></p></li>
<li><p><code>bienestar &lt;- mutate(acceso_clasificado = ifelse(acceso_servicios &gt; 70, "Alto", "Bajo"))</code></p></li>
</ol>
<p><strong>6. Flor quiere calcular el ingreso promedio por región. ¿Qué código es correcto?</strong></p>
<ol type="a">
<li><p><code>bienestar %&gt;% summarize(region, mean(ingreso_mensual))</code></p></li>
<li><p><code>group_by(bienestar$region) %&gt;% summarize(mean(ingreso_mensual))</code></p></li>
<li><p><code>bienestar %&gt;% group_by(region) %&gt;% summarize(ingreso_promedio = mean(ingreso_mensual))</code></p></li>
<li><p><code>group_by(bienestar) %&gt;% summarize(region, mean(ingreso_mensual))</code></p></li>
</ol>
<p><strong>7. Flor desea visualizar el ingreso promedio por región en un gráfico de barras. ¿Qué código es correcto?</strong></p>
<ol type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, aes(x = region, 
                      y = mean(ingreso_mensual))) +
  geom_col()</code></pre>
<ol start="2" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar %&gt;% 
         group_by(region) %&gt;% 
         summarise(ingreso_promedio = mean(ingreso_mensual)),
       aes(x = region, 
           y = ingreso_promedio)) +
  geom_col()</code></pre>
<ol start="3" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar %&gt;% 
         group_by(region), 
       aes(x = region, 
           y = mean(ingreso_mensual))) +
  geom_bar()</code></pre>
<ol start="4" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, 
       aes(x = region, 
           y = ingreso_mensual)) +
  geom_bar(stat = "summary", 
           fun = "mean")</code></pre>
<p><strong>8. Flor quiere crear un gráfico de dispersión para observar la relación entre el ingreso mensual y el acceso a servicios básicos, con puntos coloreados según la región. ¿Qué código es correcto?</strong></p>
<ol type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, 
       aes(x = acceso_servicios, 
           y = ingreso_mensual, 
           color = region)) +
  geom_point()</code></pre>
<ol start="2" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, 
       aes(x = ingreso_mensual, 
           y = acceso_servicios, 
           fill = region)) +
  geom_point()</code></pre>
<ol start="3" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, 
       aes(x = acceso_servicios, 
           y = ingreso_mensual)) +
  geom_point(color = region)</code></pre>
<ol start="4" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, aes(x = acceso_servicios, 
                      y = ingreso_mensual)) +
  geom_point(aes(color = region))</code></pre>
<p><strong>9. Flor quiere analizar cómo varía el ingreso mensual según el nivel educativo en cada región. Usa facetas para separar por región. ¿Qué código es correcto?</strong></p>
<ol type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, aes(x = nivel_educativo, 
                      y = ingreso_mensual, 
                      fill = nivel_educativo)) +
  geom_boxplot() +
  facet_grid(~ region)</code></pre>
<ol start="2" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, aes(x = nivel_educativo, 
                      y = ingreso_mensual, 
                      fill = nivel_educativo)) +
  geom_boxplot() +
  facet_wrap(~ region)</code></pre>
<ol start="3" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, aes(x = ingreso_mensual, 
                      y = nivel_educativo, 
                      fill = region)) +
  geom_boxplot() +
  facet_wrap(~ region)</code></pre>
<ol start="4" type="a">
<li></li>
</ol>
<pre><code>ggplot(bienestar, aes(x = nivel_educativo, 
                      y = ingreso_mensual, 
                      fill = region)) +
  geom_boxplot() +
  facet_wrap(~ region)</code></pre>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-gapminder" class="csl-entry" role="listitem">
Bryan, Jennifer. 2023. <span>«gapminder: Data from Gapminder»</span>. <a href="https://CRAN.R-project.org/package=gapminder">https://CRAN.R-project.org/package=gapminder</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <span>«ggplot2: Elegant Graphics for Data Analysis»</span>. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-tidyverse-2" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et&nbsp;al. 2019. <span>«Welcome to the <span></span>tidyverse<span></span>»</span> 4: 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-readxl" class="csl-entry" role="listitem">
Wickham, Hadley, y Jennifer Bryan. 2023. <span>«readxl: Read Excel Files»</span>. <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, y Davis Vaughan. 2023. <span>«dplyr: A Grammar of Data Manipulation»</span>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-haven" class="csl-entry" role="listitem">
Wickham, Hadley, Evan Miller, y Danny Smith. 2023. <span>«haven: Import and Export ’SPSS’, ’Stata’ and ’SAS’ Files»</span>. <a href="https://CRAN.R-project.org/package=haven">https://CRAN.R-project.org/package=haven</a>.
</div>
<div id="ref-tidyr" class="csl-entry" role="listitem">
Wickham, Hadley, Davis Vaughan, y Maximilian Girlich. 2024. <span>«tidyr: Tidy Messy Data»</span>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<button id="toc-toggle-btn" aria-label="Abrir contenido">Contenido ▤</button>
<script>
  (function () {
    const btn = document.getElementById('toc-toggle-btn');
    if (!btn) return;
    btn.addEventListener('click', function () {
      document.body.classList.toggle('toc-open');
    });
    // Cierra el drawer al tocar fuera del panel (móviles)
    document.addEventListener('click', function (e) {
      const panel = document.getElementById('quarto-margin-sidebar');
      if (!panel) return;
      const clickedInside = panel.contains(e.target) || btn.contains(e.target);
      if (!clickedInside && document.body.classList.contains('toc-open')) {
        document.body.classList.remove('toc-open');
      }
    });
  })();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./fundamentosR.html" class="pagination-link" aria-label="Fundamentos de R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Fundamentos de R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./statdesc.html" class="pagination-link" aria-label="Estadística descriptiva">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estadística descriptiva</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>