<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Comparando grupos – R para el análisis de datos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./regr.html" rel="next">
<link href="./inf.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./comp.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Comparando grupos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para el análisis de datos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Agradecimientos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estructura del libro</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fundamentos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Fundamentos de la Estadística</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fundamentosR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Fundamentos de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./integración.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Integración</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statdesc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estadística descriptiva</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probabilidad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estadística inferencial</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./comp.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Comparando grupos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regresión</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glosariofunciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Glosario de funciones y operaciones útiles en R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solucionario.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solucionario</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bilbiografía</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#comparación-entre-dos-medias" id="toc-comparación-entre-dos-medias" class="nav-link active" data-scroll-target="#comparación-entre-dos-medias"><span class="header-section-number">7.1</span> Comparación entre dos medias</a>
  <ul class="collapse">
  <li><a href="#estimación-para-la-diferencia-de-medias" id="toc-estimación-para-la-diferencia-de-medias" class="nav-link" data-scroll-target="#estimación-para-la-diferencia-de-medias"><span class="header-section-number">7.1.1</span> Estimación para la diferencia de medias</a></li>
  <li><a href="#contraste-de-hipótesis-para-la-diferencia-de-medias" id="toc-contraste-de-hipótesis-para-la-diferencia-de-medias" class="nav-link" data-scroll-target="#contraste-de-hipótesis-para-la-diferencia-de-medias"><span class="header-section-number">7.1.2</span> Contraste de hipótesis para la diferencia de medias</a></li>
  </ul></li>
  <li><a href="#comparación-entre-proporciones" id="toc-comparación-entre-proporciones" class="nav-link" data-scroll-target="#comparación-entre-proporciones"><span class="header-section-number">7.2</span> Comparación entre proporciones</a>
  <ul class="collapse">
  <li><a href="#estimación-para-la-diferencia-de-proporciones" id="toc-estimación-para-la-diferencia-de-proporciones" class="nav-link" data-scroll-target="#estimación-para-la-diferencia-de-proporciones"><span class="header-section-number">7.2.1</span> Estimación para la diferencia de proporciones</a></li>
  <li><a href="#contraste-de-hipótesis-para-la-diferencia-de-proporciones" id="toc-contraste-de-hipótesis-para-la-diferencia-de-proporciones" class="nav-link" data-scroll-target="#contraste-de-hipótesis-para-la-diferencia-de-proporciones"><span class="header-section-number">7.2.2</span> Contraste de hipótesis para la diferencia de proporciones</a></li>
  </ul></li>
  <li><a href="#comparaciones-de-dos-grupos-relacionados" id="toc-comparaciones-de-dos-grupos-relacionados" class="nav-link" data-scroll-target="#comparaciones-de-dos-grupos-relacionados"><span class="header-section-number">7.3</span> Comparaciones de dos grupos relacionados</a></li>
  <li><a href="#comparación-de-múltiples-grupos" id="toc-comparación-de-múltiples-grupos" class="nav-link" data-scroll-target="#comparación-de-múltiples-grupos"><span class="header-section-number">7.4</span> Comparación de múltiples grupos</a>
  <ul class="collapse">
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">7.4.1</span> ANOVA</a></li>
  <li><a href="#chi-cuadrado" id="toc-chi-cuadrado" class="nav-link" data-scroll-target="#chi-cuadrado"><span class="header-section-number">7.4.2</span> Chi-Cuadrado</a></li>
  </ul></li>
  <li><a href="#supuestos" id="toc-supuestos" class="nav-link" data-scroll-target="#supuestos"><span class="header-section-number">7.5</span> Supuestos</a></li>
  <li><a href="#pruebas-no-paramétricas" id="toc-pruebas-no-paramétricas" class="nav-link" data-scroll-target="#pruebas-no-paramétricas"><span class="header-section-number">7.6</span> Pruebas no paramétricas</a></li>
  <li><a href="#remuestreo-e-inferencia-con-el-paquete-infer" id="toc-remuestreo-e-inferencia-con-el-paquete-infer" class="nav-link" data-scroll-target="#remuestreo-e-inferencia-con-el-paquete-infer"><span class="header-section-number">7.7</span> Remuestreo e inferencia con el paquete infer</a>
  <ul class="collapse">
  <li><a href="#estimación-y-contraste-de-hipótesis-para-una-media" id="toc-estimación-y-contraste-de-hipótesis-para-una-media" class="nav-link" data-scroll-target="#estimación-y-contraste-de-hipótesis-para-una-media"><span class="header-section-number">7.7.1</span> Estimación y contraste de hipótesis para una media</a></li>
  <li><a href="#estimación-y-contraste-de-hipótesis-para-una-proporción" id="toc-estimación-y-contraste-de-hipótesis-para-una-proporción" class="nav-link" data-scroll-target="#estimación-y-contraste-de-hipótesis-para-una-proporción"><span class="header-section-number">7.7.2</span> Estimación y contraste de hipótesis para una proporción</a></li>
  <li><a href="#estimación-y-contraste-de-hipótesis-de-medias-entre-dos-grupos" id="toc-estimación-y-contraste-de-hipótesis-de-medias-entre-dos-grupos" class="nav-link" data-scroll-target="#estimación-y-contraste-de-hipótesis-de-medias-entre-dos-grupos"><span class="header-section-number">7.7.3</span> Estimación y contraste de hipótesis de medias entre dos grupos</a></li>
  <li><a href="#estimación-y-contraste-de-hipótesis-de-proporción-entre-dos-grupos" id="toc-estimación-y-contraste-de-hipótesis-de-proporción-entre-dos-grupos" class="nav-link" data-scroll-target="#estimación-y-contraste-de-hipótesis-de-proporción-entre-dos-grupos"><span class="header-section-number">7.7.4</span> Estimación y contraste de hipótesis de proporción entre dos grupos</a></li>
  </ul></li>
  <li><a href="#resumen-del-capítulo" id="toc-resumen-del-capítulo" class="nav-link" data-scroll-target="#resumen-del-capítulo"><span class="header-section-number">7.8</span> Resumen del capítulo</a></li>
  <li><a href="#ejercicios" id="toc-ejercicios" class="nav-link" data-scroll-target="#ejercicios"><span class="header-section-number">7.9</span> Ejercicios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Comparando grupos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>En las ciencias sociales, es común que surjan preguntas sobre cómo difieren dos grupos en relación con un aspecto particular de interés. ¿Las mujeres dedican más tiempo al trabajo no remunerado que los hombres? ¿Los votantes urbanos muestran un mayor apoyo a políticas progresistas en comparación con los votantes rurales? Cuando comparamos dos grupos, lo que buscamos es identificar si existen patrones, diferencias o similitudes que podamos entender e interpretar sobre el fenómeno que estamos estudiando. Por ejemplo, si nos interesa el tiempo promedio que hombres y mujeres dedican a actividades de ocio, nuestra atención se centrará en observar si existe una diferencia notable entre los grupos y qué podría <strong>explicar esta variación</strong>.</p>
<p>Esta comparación entre dos grupos puede involucrar diferentes tipos de variables. Por ejemplo, si estamos estudiando el tiempo de ocio (una variable cuantitativa), nos interesa la media o promedio de cada grupo. En cambio, si analizamos una pregunta sobre apoyo o rechazo a una política (una variable cualitativa o categórica), nos fijamos en las proporciones, como el porcentaje de personas que apoyan dicha política en cada grupo. En cualquiera de estos casos, lo que realmente queremos es comprender si la relación observada refleja una característica propia de los grupos o si podría haber sido producto del azar.</p>
<p>Cuando comparamos dos grupos, estamos explorando la relación entre dos tipos de variables: la variable explicativa y la variable respuesta. La variable explicativa es aquella que utilizamos para dividir o categorizar a los grupos que estamos comparando. Es la que “explica” o permite estructurar la comparación. Por ejemplo, si queremos analizar si existe una diferencia en los ingresos promedio entre hombres y mujeres, el género sería nuestra variable explicativa. En este caso, es una variable dicotómica porque tiene solo dos categorías: hombres y mujeres. Por otro lado, la variable respuesta es la característica que estamos midiendo o evaluando en cada grupo. Es la “respuesta” que queremos observar en función de las categorías de la variable explicativa. Siguiendo el ejemplo, los ingresos promedio serían la variable respuesta, ya que es el valor que estamos comparando entre hombres y mujeres.</p>
<p>Ahora, la variable respuesta puede ser de dos tipos:</p>
<ul>
<li><p>Cuantitativa: Si los ingresos promedio se expresan en términos numéricos (por ejemplo, cantidad de dinero).</p></li>
<li><p>Cualitativa: Si estamos analizando proporciones, como el porcentaje de personas que tienen ingresos por encima de cierto umbral.</p></li>
</ul>
<p>La relación entre estas dos variables es lo que define el análisis. Queremos ver cómo la variable respuesta cambia o se distribuye según las categorías de la variable explicativa. Si estamos comparando el apoyo a una política entre votantes rurales y urbanos, podemos calcular directamente las proporciones de apoyo en cada grupo y observar si son distintas. Si queremos analizar los ingresos entre hombres y mujeres, podemos calcular las medias de cada grupo y compararlas.</p>
<p>Este capítulo explora cómo comparar dos grupos cuando trabajamos con variables cuantitativas y cualitativas, pruebas con más de dos grupos y un acercamiento a herramientas no paramétricas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora, el capítulo anterior, discutimos cómo la estimación nos permite aproximarnos al verdadero valor de un parámetro poblacional, como la media o la proporción, a partir de una muestra representativa. Gracias al Teorema del Límite Central, sabemos que si tomamos múltiples muestras de una población, los estadísticos obtenidos (como la media muestral) seguirán aproximadamente una distribución normal alrededor del verdadero parámetro poblacional. Esto nos permite no solo estimar ese parámetro desconocido, sino también cuantificar la incertidumbre de la estimación mediante un intervalo de confianza.</p>
<p>Cuando comparamos dos grupos, <strong>la lógica es la misma.</strong> En lugar de trabajar con una sola media, nos interesa analizar <strong>la diferencia</strong> entre las medias o la proporciones de dos grupos. Por ello, <strong>si cada media muestral sigue una distribución aproximadamente normal, la diferencia entre ambas también lo hará</strong>.</p>
<p>Recuerda que en estadística inferencial, cuando tomamos una muestra, no estamos observando a toda la población, sino solo a una parte de ella. Esto significa que cualquier estadístico obtenido puede variar de una muestra a otra, debido a la variación aleatoria inherente al muestreo. Esto nos permite construir un intervalo de confianza para la diferencia de medias y realizar pruebas de hipótesis sobre esa diferencia. Nuestro análisis se centra en dos aspectos principales:</p>
<ul>
<li><p>Estimación: Calculamos la diferencia entre las medias de los dos grupos y <strong>construimos un intervalo de confianza que nos indique un rango plausible para esa diferencia en la población</strong>.</p></li>
<li><p>Contraste de hipótesis: <strong>Evaluamos si la diferencia observada entre los grupos es lo suficientemente grande como para considerarla estadísticamente significativa</strong>, es decir, si no se debe simplemente al azar.</p></li>
</ul>
<section id="comparación-entre-dos-medias" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="comparación-entre-dos-medias"><span class="header-section-number">7.1</span> Comparación entre dos medias</h2>
<p>Flor está investigando si existen diferencias en el tiempo de ocio semanal entre hombres y mujeres. Para ello, ha recolectado información sobre la cantidad de horas que cada persona dedica al ocio en una semana y desea comparar las medias de ambos grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ocio <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'horas_ocio.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ocio)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 200
Columns: 2
$ genero     &lt;chr&gt; "hombre", "mujer", "hombre", "hombre", "mujer", "mujer", "m…
$ horas_ocio &lt;dbl&gt; 15, 9, 13, 12, 13, 11, 13, 15, 14, 11, 14, 16, 10, 13, 13, …</code></pre>
</div>
</div>
<p>Podemos utilizar <code>describeBy</code> del paquete <code>psych</code> para realizar los resúmenes numéricos pertinentes por cada nivel (categoría) de la variable <code>genero</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(ocio<span class="sc">$</span>horas_ocio, ocio<span class="sc">$</span>genero)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
group: hombre
   vars   n  mean   sd median trimmed  mad min max range skew kurtosis   se
X1    1 100 15.73 2.47     15   15.59 2.97  11  24    13 0.58     0.35 0.25
------------------------------------------------------------ 
group: mujer
   vars   n  mean   sd median trimmed  mad min max range skew kurtosis   se
X1    1 100 12.13 2.31     12   12.11 1.48   6  17    11    0    -0.39 0.23</code></pre>
</div>
</div>
<p>Esto nos permite comparar cómo varían las horas de ocio entre ambos grupos, pero una manera aún más intuitiva de explorar estas diferencias es mediante una representación gráfica. Para ello, utilizamos un <strong>boxplot</strong>, que nos muestra la distribución del tiempo de ocio según el género.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ocio <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> genero, <span class="at">y =</span> horas_ocio, <span class="at">fill =</span> genero)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Horas de ocio semanal por género'</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Cantidad de horas'</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico muestra una diferencia en la distribución entre los grupos. La clave aquí es <em>que tan diferentes</em> son como para poder afirmar que efectivamente el género influye o <em>explica</em> la <em>variación</em> en las horas de ocio.</p>
<p>Podemos generar un resumen descriptivo con la media y la desviación estándar utilizando <code>dplyr</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>estadisticas <span class="ot">=</span> ocio <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genero) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">promedio =</span> <span class="fu">mean</span>(horas_ocio),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(horas_ocio),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>estadisticas</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  genero promedio    sd     n
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 hombre     15.7  2.47   100
2 mujer      12.1  2.31   100</code></pre>
</div>
</div>
<p>Para cuantificar esta diferencia, necesitamos calcular un estadístico de comparación, que en este caso es la diferencia de medias muestrales, representada por <span class="math inline">\(\Delta\)</span> (Delta).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>diferencia <span class="ot">=</span> <span class="fu">diff</span>(estadisticas<span class="sc">$</span>promedio)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>diferencia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.6</code></pre>
</div>
</div>
<p>Por lo que la diferencia de medias <span class="math inline">\(\Delta \bar{x}\)</span> es: <span class="math display">\[
\Delta \bar{x} = \bar{x}_{Hombres} - \bar{x}_{Mujeres} = 15.8 - 12.2 = 3.6
\]</span> La distribución de ambos grupos es la siguiente</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="estimación-para-la-diferencia-de-medias" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="estimación-para-la-diferencia-de-medias"><span class="header-section-number">7.1.1</span> Estimación para la diferencia de medias</h3>
<p><strong>Cálculo del intervalo de confianza</strong></p>
<p>De la misma forma que para construir un intervalo de confianza con una media. Para realizar un intervalo del 95% para la diferencia de medias, utilizamos la misma fórmula:</p>
<p><span class="math display">\[
\text{IC}_{\Delta \bar{x}} = \Delta \bar{x} \pm z/t \cdot \text{EE}
\]</span> Dado que estamos comparando dos grupos distintos (hombres y mujeres), cada uno con su propia media, desviación estándar y tamaño muestral, <strong>la incertidumbre en la diferencia de medias proviene de ambas muestras</strong>. Por lo tanto, el error estándar (EE) de la diferencia de medias se obtiene <strong>combinando los errores estándar individuales de cada grupo</strong>. La formula para el EE responde a la integración de ambas variables , donde:</p>
<p>Para dos estimaciones provenientes de <strong>muestras independientes</strong> (una no está relacionada con la otra, más sobre este caso en “Comparaciones de grupos relacionados”) con errores estándar estimados <span class="math inline">\(se_1\)</span> y <span class="math inline">\(se_2\)</span>, la distribución de muestreo de su diferencia tiene un error estándar estimado dado por:</p>
<p><span class="math display">\[
\text{Error estándar} = \sqrt{(se_1)^2 + (se_2)^2}.
\]</span></p>
<p>Cada estimación tiene un error de muestreo, y las variabilidades se suman para determinar el error estándar de la diferencia entre las estimaciones.</p>
<p>Recuerda que el error estándar estimado de una media muestral está dado por:</p>
<p><span class="math display">\[
se = \frac{s}{\sqrt{n}},
\]</span></p>
<p>donde <span class="math inline">\(s\)</span> es la desviación estándar muestral y <span class="math inline">\(n\)</span> es el tamaño de la muestra.</p>
<p>Por lo que si <span class="math inline">\(n_1\)</span> y <span class="math inline">\(n_2\)</span> son los tamaños de las muestras para las primera y segunda muestra, respectivamente. Y <span class="math inline">\(s_1\)</span> y <span class="math inline">\(s_2\)</span> las desviaciones estándar muestrales, que son <strong>estimaciones</strong> de las desviaciones estándar poblacionales correspondientes <span class="math inline">\(\sigma_1\)</span> y <span class="math inline">\(\sigma_2\)</span>. La diferencia entre las medias muestrales <span class="math inline">\(\bar{x}_2 - \bar{x}_1\)</span>, provenientes de muestras independientes, tiene un error estándar estimado dado por:</p>
<p><span class="math display">\[
EE = \sqrt{(se_1)^2 + (se_2)^2} = \sqrt{\left(\frac{s_1}{\sqrt{n_1}}\right)^2 + \left(\frac{s_2}{\sqrt{n_2}}\right)^2} = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}.
\]</span> Por tanto la formula <span class="math inline">\(\text{EE} = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\)</span> define el error estándar, el cual nos indica cuánto puede variar la diferencia de medias observada debido a la variabilidad muestral.</p>
<p>La podemos calcular en base al objeto <code>estadistica</code> que creamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>estadisticas</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  genero promedio    sd     n
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 hombre     15.7  2.47   100
2 mujer      12.1  2.31   100</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ee <span class="ot">=</span> <span class="fu">sqrt</span>((estadisticas<span class="sc">$</span>sd[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> estadisticas<span class="sc">$</span>n[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>          (estadisticas<span class="sc">$</span>sd[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> estadisticas<span class="sc">$</span>n[<span class="dv">2</span>]))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ee</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3377017</code></pre>
</div>
</div>
<p>Siendo <span class="math inline">\(EE = 0.337\)</span></p>
<p>Ahora definamos nuestro valor <span class="math inline">\(t\)</span>, el valor crítico para un nivel de confianza del 95% (<span class="math inline">\(z = 1.96\)</span>). Si asumimos <strong>homogeneidad de varianzas</strong>(es decir que la variación en ambos grupos de homogénea), los grados de libertad se calculan como <span class="math inline">\(gl = n_1 + n_2 - 2\)</span>, ya que combinamos la información de ambas muestras para estimar una única varianza poblacional. Recuerda que estamos comparando medias porlo que al no conocer la desviación estándar poblacional, utilizamos la <strong>distribución t de Student</strong> en lugar de la normal estándar, ya que esta ajusta la mayor incertidumbre en muestras finitas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de los grados de libertad con varianzas iguales</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> estadisticas<span class="sc">$</span>n[<span class="dv">1</span>] <span class="sc">+</span> estadisticas<span class="sc">$</span>n[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">2</span>  </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> gl)  </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.972017</code></pre>
</div>
</div>
<p>Siendo <span class="math inline">\(t = 1.972\)</span></p>
<p>Y la diferencia observada en nuestra muestra</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>diferencia <span class="ot">=</span> <span class="fu">diff</span>(estadisticas<span class="sc">$</span>promedio) </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>diferencia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.6</code></pre>
</div>
</div>
<p>Siendo <span class="math inline">\(\Delta\ \bar{x} = -3.6\)</span></p>
<p>El intervalo de confianza se define por</p>
<p><span class="math display">\[
\text{IC}_{\Delta \bar{x}} = \Delta \bar{x} \pm t \cdot \text{EE}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ic <span class="ot">=</span> <span class="fu">c</span>(diferencia <span class="sc">-</span> t <span class="sc">*</span> ee, diferencia <span class="sc">+</span> t <span class="sc">*</span>ee)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ic</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -4.265954 -2.934046</code></pre>
</div>
</div>
<p><span class="math display">\[
\text{IC}_{\Delta \bar{x}} = -3.6 \pm 0.5 = [-4.26, -2.93]
\]</span></p>
<p>Representado graficamente tenemos lo siguiente:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Las pruebas t tambien puede utilizarse para compara dos medias, con una ligera modificacion en el codigo, debemos especificar nuestra variable respuesta y explicativa utilizando <code>~</code>, se puede leer como la variable ocio esta explicada (<code>~</code>) a travez de la variable genero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>prueba_t <span class="ot">=</span> <span class="fu">t.test</span>(horas_ocio <span class="sc">~</span> genero, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> ocio)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>prueba_t<span class="sc">$</span>conf.int</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.934029 4.265971
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
<p>El intervalo de confianza <strong>[2.93, 4.27]</strong> con un <strong>95% de confianza</strong> nos dice que, si repitiésemos este estudio muchas veces, en el <strong>95% de los casos</strong> el intervalo calculado contendría la diferencia en población de medias en la población. Un punto clave es que el intervalo <strong>no incluye el 0</strong>, lo que implica que una diferencia de <strong>cero</strong> (sean iguales ambos grupos) no es una posibilidad dentro del rango estimado. Esto es relevante porque, si el intervalo incluyera el 0, significaría que la diferencia observada en la muestra podría explicarse por el azar, ya que el valor de <strong>cero</strong> indicaría que no hay una diferencia real entre los grupos en la población. Sin embargo, dado que el intervalo se encuentra completamente por encima de 0, esto sugiere que la diferencia observada <strong>no es producto del azar</strong>, y es altamente probable que los hombres de la población de estudio realmente dediquen entre <strong>2.93 y 4.27 horas más al ocio</strong> que las mujeres.</p>
</section>
<section id="contraste-de-hipótesis-para-la-diferencia-de-medias" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="contraste-de-hipótesis-para-la-diferencia-de-medias"><span class="header-section-number">7.1.2</span> Contraste de hipótesis para la diferencia de medias</h3>
<p>Cuando comparamos las medias de dos grupos, el contraste de hipótesis tiene como objetivo determinar si las medias de dos poblaciones son significativamente diferentes. Es decir, evaluamos si la diferencia observada entre las dos medias es lo suficientemente extrema como para concluir que no se debe al azar.</p>
<p><strong>Pasos del Contraste de Hipótesis para la Diferencia de Medias</strong></p>
<p>El contraste de hipótesis para la diferencia de medias entre dos grupos sigue un enfoque muy similar al contraste para una media única, pero aquí evaluamos si la diferencia observada entre las dos medias es suficientemente extrema como para concluir que no se debe al azar. A continuación, describimos los pasos intuitivos del contraste para las horas de ocio entre hombres y mujeres.</p>
<p><strong>1. Planteamiento de Hipótesis</strong></p>
<p>El primer paso es formular nuestras hipótesis estadísticas:</p>
<ul>
<li><p>Hipótesis nula (<span class="math inline">\(H_0\)</span>): No existe diferencia entre las medias de las dos poblaciones. En otras palabras: <span class="math display">\[
H_0: \mu_{Hombres} - \mu_{Mujeres} = 0
\]</span></p></li>
<li><p>Hipótesis alternativa (<span class="math inline">\(H_1\)</span>): Existe una diferencia significativa entre las medias de las dos poblaciones: <span class="math display">\[
H_1: \mu_{Hombres} - \mu_{Mujeres} \neq 0
\]</span></p></li>
</ul>
<p>El contraste de hipótesis nos permite evaluar si la diferencia observada en las horas de ocio promedio es lo suficientemente grande como para no atribuirse al azar. Bajo la hipótesis nula (<span class="math inline">\(H_0\)</span>), asumimos que <strong>el género no influye en las horas de ocio</strong>, es decir, que la diferencia de medias en la población es <strong>cero</strong> (<span class="math inline">\(\mu\_1 = \mu\_2\)</span>). Si rechazamos (<span class="math inline">\(H_0\)</span>), concluimos que el género sí tiene un efecto significativo.</p>
<p>En nuestro caso, hemos planteado una <strong>prueba bilateral</strong>, donde la hipótesis alternativa (<span class="math inline">\(H_A\)</span>) simplemente indica que <strong>existe una diferencia entre los grupos</strong>, sin especificar la dirección:</p>
<p><span class="math display">\[
H_A: \mu_1 \neq \mu_2
\]</span></p>
<p>Esto significa que estamos interesados en detectar <strong>cualquier</strong> diferencia, ya sea que un grupo tenga más o menos horas de ocio que el otro. Sin embargo, también podríamos haber planteado una <strong>prueba unilateral</strong>, en la que la hipótesis alternativa especifique una dirección concreta de la diferencia. Esto se hace cuando hay una expectativa teórica o evidencia previa que sugiera que un grupo debería tener <strong>más</strong> o <strong>menos</strong> horas de ocio que el otro.</p>
<p><strong>Prueba unilateral derecha:</strong></p>
<p><span class="math display">\[
H_A: \mu_1 &gt; \mu_2
\]</span></p>
<p>En este caso, solo nos interesa saber si <strong>el grupo 1 dedica significativamente más horas al ocio que el grupo 2</strong>. Se rechaza <span class="math inline">\(H_0\)</span> únicamente si la diferencia observada es suficientemente <strong>positiva</strong>.</p>
<p><strong>Prueba unilateral izquierda:</strong></p>
<p><span class="math display">\[
H_A: \mu_1 &lt; \mu_2
\]</span></p>
<p>Aquí, estamos evaluando si <strong>el grupo 1 dedica significativamente menos horas al ocio que el grupo 2</strong>. Se rechaza <span class="math inline">\(H_0\)</span> solo si la diferencia observada es suficientemente <strong>negativa</strong>.</p>
<p><strong>Lo recomendable es usar la prueba bilateral</strong>, especialmente en estudios exploratorios, donde no hay certeza sobre la dirección del efecto. Esto nos asegura que cualquier diferencia significativa, sea positiva o negativa, será detectada correctamente.</p>
<p><strong>2. Estadísticas Descriptivas</strong></p>
<p>Podemos establecer las característica de cada grupo</p>
<p><strong>Tamaños de las Muestras</strong></p>
<p>Primero, calculamos el número de observaciones por grupo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>n_hombres <span class="ot">=</span> ocio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genero <span class="sc">==</span> <span class="st">"hombre"</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>n_mujeres <span class="ot">=</span> ocio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genero <span class="sc">==</span> <span class="st">"mujer"</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>n_hombres</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>n_mujeres  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
</div>
<p><span class="math display">\[
n_{Hombres} = 100 \quad \text{y} \quad n_{Mujeres} = 100
\]</span></p>
<p><strong>Medias y Desviaciones Estándar</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ocio <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genero) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">promedio =</span> <span class="fu">mean</span>(horas_ocio),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(horas_ocio)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  genero promedio    sd
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 hombre     15.7  2.47
2 mujer      12.1  2.31</code></pre>
</div>
</div>
<p>Por lo que:</p>
<ul>
<li><p><span class="math inline">\(\bar{x}_{Hombres} = 15.8\)</span>, <span class="math inline">\(s_{Hombres} = 2.47\)</span></p></li>
<li><p><span class="math inline">\(\bar{x}_{Mujeres} = 12.2\)</span>, <span class="math inline">\(s_{Mujeres} = 2.31\)</span></p></li>
</ul>
<p>La diferencia observada entre las medias es:</p>
<p><span class="math display">\[
\Delta \bar{x} = \bar{x}_{Hombres} - \bar{x}_{Mujeres} = 15.8 - 12.2 = 3.6
\]</span></p>
<p><strong>3. Nivel de Significancia</strong></p>
<p>Definimos un nivel de significancia de:</p>
<p><span class="math display">\[
\alpha = 0.05
\]</span></p>
<p>Como en el anterior capítulo. Esto significa que aceptaremos hasta un 5% de probabilidad de cometer un error al rechazar <span class="math inline">\(H_0\)</span> si en realidad es verdadera.</p>
<p><strong>4. Realización de la Prueba</strong></p>
<p>Para evaluar si la diferencia observada (<span class="math inline">\(\Delta \bar{x} = 3.6\)</span>) es significativa, calculamos el estadístico <span class="math inline">\(t\)</span> y comparamos su valor con una distribución <span class="math inline">\(t\)</span></p>
<p><strong>Cálculo del Error Estándar</strong></p>
<p>El Error Estándar (<span class="math inline">\(EE\)</span>) mide cuánto esperaríamos que varíe la diferencia de medias entre muestras si <span class="math inline">\(H_0\)</span> fuera cierta. Ya lo habíamos calculado en la estimación:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ee</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3377017</code></pre>
</div>
</div>
<p><span class="math display">\[
\text{EE} \approx 0.338
\]</span></p>
<p><strong>Cálculo del Estadístico t</strong></p>
<p>El <strong>estadístico</strong> <span class="math inline">\(t\)</span> nos permite cuantificar cuán lejos está la diferencia observada entre medias (<span class="math inline">\(\Delta \bar{x}\)</span>) de lo que esperaríamos bajo la hipótesis nula (<span class="math inline">\(H_0\)</span>), en términos de <strong>errores estándar</strong> (<span class="math inline">\(EE\)</span>). Como bajo <span class="math inline">\(H_0\)</span> asumimos que no hay diferencia real entre los grupos, el valor esperado es <strong>0</strong>, por lo que el estadístico <span class="math inline">\(t\)</span> se calcula como:</p>
<p><span class="math display">\[
t = \frac{\Delta \bar{x} - 0}{EE} = \frac{\Delta \bar{x}}{EE}
\]</span></p>
<p>Este valor nos indica cuántas veces el <strong>error estándar</strong> cabe en la diferencia observada.</p>
<p><span class="math display">\[
t = \frac{\Delta \bar{x} - 0}{\text{EE}}
\]</span></p>
<p>Sustituyendo:</p>
<p><span class="math display">\[
t = \frac{3.6}{0.338} \approx 10.66
\]</span></p>
<p>El valor <span class="math inline">\(t = 10.66\)</span> indica que la diferencia observada (<span class="math inline">\(3.6\)</span>) está a 10.66 <span class="math inline">\(EE\)</span> de distancia de lo esperado bajo <span class="math inline">\(H_0\)</span>. Recuerda que este estadístico se compara con el <strong>valor crítico</strong> <span class="math inline">\(t_{\alpha/2}\)</span> de la distribución t con los grados de libertad cque calculamos, para determinar si se encuentra en la <strong>zona de rechazo</strong>. Aquí una representación gráfica, nota como el valor observado se encuentra en el area de rechazo.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico muestra la <strong>distribución nula</strong> y la región de rechazo para el contraste de hipótesis. La diferencia de medias observada <span class="math inline">\(\Delta \bar{x} = -3.6\)</span> está claramente fuera del <strong>intervalo de confianza</strong> <span class="math inline">\([-0.66, 0.66]\)</span>, lo que indica que el resultado es altamente improbable bajo <span class="math inline">\(H_0\)</span>. Esto se alinea con el valor <span class="math inline">\(t = 10.66\)</span>, que nos dice que la diferencia observada está <strong>10.66 errores estándar</strong> alejada de lo esperado bajo <span class="math inline">\(H_0\)</span>. Como el valor observado cae en la <strong>zona de rechazo</strong>, hay evidencia suficiente para rechazar <span class="math inline">\(H_0\)</span> y concluir que la diferencia entre los grupos es <strong>estadísticamente significativa</strong>.</p>
<p>Felizmente R puede hacer todo el cálculo por nosotros con la función <code>t.test()</code>, en este caso para la diferencia de muestras. Vamos a utilizar <code>~</code> para indicar la relación (se peude leer como <code>horas_ocio</code> es explicada por <code>genero</code>).</p>
<p>Nota: A partir de ahora usaremos uso del paquete <code>broom</code> y su función <code>tidy()</code>, el cual ordena los resultados de las pruebas estadísticas en tibble de forma ordenada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>prueba_t <span class="ot">=</span> <span class="fu">t.test</span>(horas_ocio <span class="sc">~</span> genero, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> ocio, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(prueba_t)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  estimate estimate1 estimate2 statistic  p.value parameter conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1      3.6      15.7      12.1      10.7 3.04e-21      197.     2.93      4.27
# ℹ 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
</div>
</div>
<p>La prueba nos proporciona el <strong>p-valor</strong>, que representa la probabilidad de obtener una diferencia tan extrema como la observada si la hipótesis nula <span class="math inline">\(H_0\)</span> fuera cierta. Del capítulo anterior, sabemos que el valor está directamente relacionado con el <strong>estadístico t</strong>, ya que <strong>a mayor valor absoluto de t, menor será el p-valor, lo que indica que la diferencia observada es menos probable bajo</strong> <span class="math inline">\(H_0\)</span>. En este caso, el <strong>p-valor es menor que</strong> <span class="math inline">\(\alpha = 0.05\)</span> (<span class="math inline">\(2.2e-16\)</span>), por lo que rechazamos <span class="math inline">\(H_0\)</span> y concluimos que la diferencia en las horas de ocio entre hombres y mujeres es <strong>estadísticamente significativa</strong>.</p>
<p>Además, esta conclusión ya se podía intuir desde la construcción del <strong>intervalo de confianza</strong>, donde observamos que los hombres tienen entre <strong>2.9 y 4.2 horas más de ocio semanal</strong> que las mujeres y, crucialmente, el intervalo <strong>no incluía el 0</strong>, lo que indicaba una diferencia significativa. El contraste de hipótesis nos ayuda a formalizar esta interpretación, permitiéndonos afirmar que esta diferencia <strong>no puede atribuirse únicamente al azar</strong>, lo que sugiere que el <strong>género influye en las horas de ocio</strong>.</p>
</section>
</section>
<section id="comparación-entre-proporciones" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="comparación-entre-proporciones"><span class="header-section-number">7.2</span> Comparación entre proporciones</h2>
<p>Cuando trabajamos con <strong>variables cualitativas o categóricas</strong>, como el género, la preferencia electoral o la afiliación política, las comparaciones entre dos grupos se centran en analizar <strong>las proporciones</strong> asociadas a cada categoría. En lugar de comparar medias como en el caos anterior, aquí nos interesa evaluar si <strong>la proporción de individuos que pertenecen a una categoría específica difiere entre los grupos</strong>.</p>
<p>Recuerda que la <strong>proporción muestral</strong> (<span class="math inline">\(\hat{p}\)</span>) es una estimación del porcentaje de individuos que pertenecen a una categoría específica en la población. Se calcula como:</p>
<p><span class="math display">\[
\hat{p} = \frac{x}{n}
\]</span></p>
<p>donde:<br>
- <span class="math inline">\(x\)</span> es el número de <strong>éxitos</strong> (individuos que apoyan la política ambiental).<br>
- <span class="math inline">\(n\)</span> es el <strong>tamaño total de la muestra</strong> en cada grupo.</p>
<p>Flor está investigando si existe una diferencia en el nivel de apoyo a una <strong>política ambiental</strong> entre personas que viven en zonas <strong>urbanas</strong> y <strong>rurales</strong>. Para ello, ha recolectado datos sobre el porcentaje de personas de cada grupo que han expresado estar a favor de la medida. El objetivo es comparar estas proporciones y determinar si la diferencia observada en la muestra es <strong>estadísticamente significativa</strong> o si simplemente podría explicarse por la variabilidad del muestreo.</p>
<p>Así como en la comparación de medias analizamos si la diferencia entre los promedios de dos grupos es significativa, aquí evaluamos si <strong>la diferencia entre proporciones</strong> (<span class="math inline">\(\Delta p\)</span>)es lo suficientemente grande como para no atribuirse al azar.</p>
<p>Si definimos las proporciones muestrales de apoyo como:</p>
<p><span class="math display">\[
\hat{p}_{urbana} = \frac{x_{urbana}}{n_{urbana}}, \quad \hat{p}_{rural} = \frac{x_{rural}}{n_{rural}}
\]</span></p>
<p>entonces, la <strong>diferencia de proporciones muestrales</strong> se calcula como:</p>
<p><span class="math display">\[
\Delta p = \hat{p}_{urbana} - \hat{p}_{rural}
\]</span></p>
<p>Si <span class="math inline">\(\Delta p\)</span> es <strong>cercano a cero</strong>, indicaría que ambos grupos tienen un nivel de apoyo similar. Si es <strong>positivo o negativo y lo suficientemente grande</strong>, podríamos sospechar que la zona de residencia influye en la opinión sobre la política ambiental.</p>
<p>Para explorar estos datos, primero carga el conjunto de datos y examina su estructura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>votantes <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"votantes.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(votantes)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 350
Columns: 2
$ zona  &lt;chr&gt; "urbana", "urbana", "urbana", "urbana", "urbana", "urbana", "urb…
$ apoyo &lt;chr&gt; "sí", "no", "sí", "no", "no", "sí", "sí", "no", "sí", "sí", "no"…</code></pre>
</div>
</div>
<p>Visualizamos las proporciones de cada grupo, al ser variables categóricas utilizaremos una gráfico de barras apilado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>votantes <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(zona, apoyo) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proporcion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> zona, <span class="at">y =</span> proporcion, <span class="at">fill =</span> apoyo)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Esto permite realizar barras apiladas</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Proporción de apoyo por zona"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proporción"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Zona"</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Apoyo"</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Efectivamente hay una diferencia, realicemos un intervalo de confianza y evaluemos su significancia.</p>
<section id="estimación-para-la-diferencia-de-proporciones" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="estimación-para-la-diferencia-de-proporciones"><span class="header-section-number">7.2.1</span> Estimación para la diferencia de proporciones</h3>
<p>Al comparar proporciones entre dos grupos, estamos interesados en la diferencia entre ellas. La diferencia muestral de proporciones se calcula como:</p>
<p><span class="math display">\[
\Delta {p} = \hat{p}_1 - \hat{p}_2
\]</span></p>
<p>En este caso, las proporciones observadas para las zonas urbanas y rurales son</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular las proporciones de apoyo en cada zona</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>proporciones <span class="ot">=</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(zona) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">apoyo_si =</span> <span class="fu">sum</span>(apoyo <span class="sc">==</span> <span class="st">"sí"</span>),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">proporcion_apoyo =</span> apoyo_si <span class="sc">/</span> total</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>proporciones</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  zona   total apoyo_si proporcion_apoyo
  &lt;chr&gt;  &lt;int&gt;    &lt;int&gt;            &lt;dbl&gt;
1 rural    150       70            0.467
2 urbana   200      141            0.705</code></pre>
</div>
</div>
<p><span class="math display">\[
\hat{p}_1 = 0.705 \quad \text{(proporción de apoyo en zonas urbanas)}
\]</span></p>
<p><span class="math display">\[
\hat{p}_2 = 0.467 \quad \text{(proporción de apoyo en zonas rurales)}
\]</span></p>
<p><strong>Intervalo de Confianza para la Diferencia de Proporciones</strong></p>
<p>El intervalo de confianza para la diferencia de proporciones se calcula de manera similar al de la diferencia de medias, con la fórmula:</p>
<p><span class="math display">\[
\text{IC}_{\Delta \hat{p}} = \Delta \hat{p} \pm z \cdot \text{EE},
\]</span></p>
<p>donde <span class="math inline">\(\text{EE}\)</span> es el error estándar estimado, dado por:</p>
<p><span class="math display">\[
\text{EE} = \sqrt{\frac{\hat{p}_1(1 - \hat{p}_1)}{n_1} + \frac{\hat{p}_2(1 - \hat{p}_2)}{n_2}},
\]</span></p>
<p>y <span class="math inline">\(z\)</span> es el valor crítico para el nivel de confianza deseado (por ejemplo, <span class="math inline">\(z = 1.96\)</span> para un 95% de confianza).</p>
<p>Podemos calcularlo manualmente en R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporción de apoyo en zonas urbanas</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>prop_urbanos <span class="ot">=</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(zona <span class="sc">==</span> <span class="st">"urbana"</span>, apoyo <span class="sc">==</span> <span class="st">"sí"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>() <span class="sc">/</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(zona <span class="sc">==</span> <span class="st">"urbana"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporción de apoyo en zonas rurales</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>prop_rurales <span class="ot">=</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(zona <span class="sc">==</span> <span class="st">"rural"</span>, apoyo <span class="sc">==</span> <span class="st">"sí"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>() <span class="sc">/</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(zona <span class="sc">==</span> <span class="st">"rural"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>prop_urbanos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.705</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>prop_rurales</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4666667</code></pre>
</div>
</div>
<p>En este caso:</p>
<p><span class="math display">\[
n_1 = 200, \quad n_2 = 150
\]</span></p>
<p>La diferencia muestral</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>diferencia_prop <span class="ot">=</span> prop_urbanos <span class="sc">-</span> prop_rurales</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>diferencia_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2383333</code></pre>
</div>
</div>
<p>Por lo tanto, la diferencia muestral de proporciones es:</p>
<p><span class="math display">\[
\Delta \hat{p} = 0.705 - 0.467 = 0.238
\]</span> Cálculo del error estándar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>n_urbanos <span class="ot">=</span> votantes <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(zona <span class="sc">==</span> <span class="st">"urbana"</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>n_rurales <span class="ot">=</span> votantes <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(zona <span class="sc">==</span> <span class="st">"rural"</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>ee <span class="ot">=</span> <span class="fu">sqrt</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  (prop_urbanos <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prop_urbanos) <span class="sc">/</span> n_urbanos) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  (prop_rurales <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prop_rurales) <span class="sc">/</span> n_rurales)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>ee</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05195319</code></pre>
</div>
</div>
<p>El error estándar calculado es:</p>
<p><span class="math display">\[
\text{EE} = \sqrt{\frac{0.705 \cdot (1 - 0.705)}{200} + \frac{0.467 \cdot (1 - 0.467)}{150}} = 0.05195
\]</span></p>
<p>Por lo que el intervalo de confianza</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Siendo</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de confianza</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ic <span class="ot">=</span> <span class="fu">c</span>(diferencia_prop <span class="sc">-</span> z <span class="sc">*</span> ee, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>        diferencia_prop <span class="sc">+</span> z <span class="sc">*</span> ee)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>ic</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1365069 0.3401597</code></pre>
</div>
</div>
<p><span class="math display">\[
\text{IC}_{\Delta \hat{p}} = 0.238 \pm 1.96 \cdot 0.05195
\]</span></p>
<p>Por lo que:</p>
<p><span class="math display">\[
\text{IC}_{\Delta \hat{p}} = [0.136, 0.340]
\]</span></p>
<p>Como siempre, podemos calcular todo ello directamente en R, aunque primero debemos generar una tabla con los resultados por grupo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">=</span> <span class="fu">table</span>(votantes<span class="sc">$</span>zona, votantes<span class="sc">$</span>apoyo)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>tabla</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
          no  sí
  rural   80  70
  urbana  59 141</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>prueba_prop <span class="ot">=</span> <span class="fu">prop.test</span>(tabla, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>prueba_prop<span class="sc">$</span>conf.int</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1306736 0.3459931
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
<p><strong>Interpretación</strong></p>
<p>El intervalo de confianza indica que, con un 95% de confianza, la diferencia en las proporciones poblacionales de apoyo entre las zonas urbanas y rurales está entre <span class="math inline">\(13.6\)</span> y <span class="math inline">\(34.0\%\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="contraste-de-hipótesis-para-la-diferencia-de-proporciones" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="contraste-de-hipótesis-para-la-diferencia-de-proporciones"><span class="header-section-number">7.2.2</span> Contraste de hipótesis para la diferencia de proporciones</h3>
<p>El contraste de hipótesis para la diferencia de proporciones entre dos grupos sigue una estructura similar al de medias, pero evalúa si la diferencia observada entre las proporciones muestrales es suficientemente extrema como para concluir que no se debe al azar. Aquí aplicamos este análisis al ejemplo del apoyo en zonas urbanas y rurales.</p>
<p><strong>1. Planteamiento de Hipótesis</strong></p>
<p>El primer paso es formular nuestras hipótesis estadísticas:</p>
<ul>
<li><p>Hipótesis nula (<span class="math inline">\(H_0\)</span>): No existe diferencia en las proporciones poblacionales. Es decir: <span class="math display">\[
H_0: \pi_1 - \pi_2 = 0
\]</span></p></li>
<li><p>Hipótesis alternativa (<span class="math inline">\(H_1\)</span>): Existe una diferencia significativa en las proporciones poblacionales: <span class="math display">\[
H_1: \pi_1 - \pi_2 \neq 0
\]</span></p></li>
</ul>
<p>Bajo <span class="math inline">\(H_0\)</span>, las proporciones de apoyo entre zonas urbanas y rurales son iguales. Si rechazamos <span class="math inline">\(H_0\)</span>, concluimos que hay una diferencia significativa entre las proporciones.</p>
<p><strong>2. Estadísticas Descriptivas</strong></p>
<p>Para realizar el contraste de hipótesis, primero presentamos las características de cada grupo.</p>
<p>Sabemos realizar la estimación que:</p>
<ul>
<li><p>Proporción de apoyo en zonas urbanas (<span class="math inline">\(\hat{p}_1\)</span>): <span class="math display">\[
\hat{p}_1 = 0.705
\]</span></p></li>
<li><p>Proporción de apoyo en zonas rurales (<span class="math inline">\(\hat{p}_2\)</span>): <span class="math display">\[
\hat{p}_2 = 0.467
\]</span></p></li>
</ul>
<p>La diferencia observada entre las proporciones es: <span class="math display">\[
\Delta \hat{p} = \hat{p}_1 - \hat{p}_2 = 0.705 - 0.467 = 0.238.
\]</span></p>
<p>Las muestras de cada grupo son:</p>
<p><span class="math display">\[
n_1 = 200, \quad n_2 = 150.
\]</span></p>
<p><strong>3. Nivel de Significancia</strong></p>
<p>Definimos un nivel de significancia de: <span class="math display">\[
\alpha = 0.05,
\]</span> lo que significa que aceptamos hasta un 5% de probabilidad de cometer un error al rechazar <span class="math inline">\(H_0\)</span> si en realidad es verdadera.</p>
<p><strong>4. Realización de la Prueba</strong></p>
<p>Para evaluar si la diferencia observada <span class="math inline">\(\Delta \hat{p} = 0.238\)</span> es significativa, calculamos el estadístico <span class="math inline">\(z\)</span> bajo <span class="math inline">\(H_0\)</span>, es decir, bajo la presunción de <span class="math inline">\(H_0\)</span> de que <span class="math inline">\(\pi_1 = \pi_2\)</span></p>
<p>Cálculo de la Estimación Combinada <span class="math inline">\((\hat{\pi})\)</span></p>
<p>Para la realicación de la prueba debemos estimar el valor común de las proporciones poblacionales utilizando la proporción combinada para toda la muestra. Esta proporción <span class="math inline">\((\hat{\pi})\)</span> se calcula como:</p>
<p><span class="math display">\[
\hat{\pi} = \frac{\text{Éxitos totales}}{\text{Tamaño total de la muestra}}.
\]</span></p>
<p>Dado que los datos son los siguientes:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Zona</th>
<th>Sí (<span class="math inline">\(x\)</span>)</th>
<th>No (<span class="math inline">\(n - x\)</span>)</th>
<th>Total (<span class="math inline">\(n\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rural</td>
<td>70</td>
<td>80</td>
<td>150</td>
</tr>
<tr class="even">
<td>Urbana</td>
<td>141</td>
<td>59</td>
<td>200</td>
</tr>
</tbody>
</table>
<ul>
<li>Éxitos en zonas rurales: <span class="math inline">\(x_1 = 70\)</span>.</li>
<li>Éxitos en zonas urbanas: <span class="math inline">\(x_2 = 141\)</span>.</li>
<li>Tamaño total de la muestra: <span class="math inline">\(n_1 + n_2 = 150 + 200 = 350\)</span>.</li>
</ul>
<p>Sustituyendo en la fórmula:</p>
<p><span class="math display">\[
\hat{\pi} = \frac{x_1 + x_2}{n_1 + n_2} = \frac{70 + 141}{150 + 200} = \frac{211}{350} \approx 0.603.
\]</span></p>
<p>La proporción combinada (<span class="math inline">\(\hat{\pi}\)</span>) indica que, bajo la hipótesis nula, el apoyo total se distribuye igualmente entre las dos zonas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>pi_combinada <span class="ot">=</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(zona) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">exitos =</span> <span class="fu">sum</span>(apoyo <span class="sc">==</span> <span class="st">"sí"</span>),   </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>()                    </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">exitos_totales =</span> <span class="fu">sum</span>(exitos),  </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_muestra =</span> <span class="fu">sum</span>(total),   </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pi =</span> exitos_totales <span class="sc">/</span> total_muestra  </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(pi) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por lo que:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>pi_combinada</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6028571</code></pre>
</div>
</div>
<p><span class="math display">\[
\hat{\pi} = 0.603.
\]</span></p>
<p>Cálculo del Error Estándar bajo <span class="math inline">\(H_0\)</span> (<span class="math inline">\(se_0\)</span>)</p>
<p>El error estándar bajo <span class="math inline">\(H_0\)</span> se calcula como:</p>
<p><span class="math display">\[
se_0 = \sqrt{\hat{\pi} (1 - \hat{\pi}) \left(\frac{1}{n_1} + \frac{1}{n_2}\right)}.
\]</span> Siendo <span class="math inline">\(\hat{\pi}\)</span> es la porción combinada.</p>
<p>Sustituyendo: <span class="math display">\[
se_0 = \sqrt{0.603 \cdot (1 - 0.603) \left(\frac{1}{200} + \frac{1}{150}\right)} = \sqrt{0.603 \cdot 0.397 \cdot 0.01167} = 0.0528.
\]</span></p>
<p>En R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>se_nula <span class="ot">=</span> <span class="fu">sqrt</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  pi_combinada <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pi_combinada) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> n_urbanos <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n_rurales)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>se_nula</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05285109</code></pre>
</div>
</div>
<p>Cálculo del Estadístico <span class="math inline">\(z\)</span></p>
<p>El estadístico <span class="math inline">\(z\)</span> mide cuántos errores estándar separan la diferencia observada (<span class="math inline">\(\Delta \hat{p}\)</span>) del valor esperado bajo <span class="math inline">\(H_0\)</span> (que es 0):</p>
<p><span class="math display">\[
z = \frac{\Delta \hat{p} - 0}{se_0}.
\]</span></p>
<p>Sustituyendo: <span class="math display">\[
z = \frac{0.238}{0.0528} \approx 4.51.
\]</span></p>
<ol start="5" type="1">
<li>Zonas de Rechazo</li>
</ol>
<p>Bajo <span class="math inline">\(H_0\)</span>, las zonas de rechazo se definen como:</p>
<p><span class="math display">\[
p_0 \pm z \cdot se_0.
\]</span> Sabemos que <span class="math inline">\(z\)</span> es igual a</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>z_alpha</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
</div>
<p>Sustituyendo <span class="math inline">\(p_0 = 0\)</span>, <span class="math inline">\(z_{\alpha/2} = 1.96\)</span>, y <span class="math inline">\(se_0 = 0.0528\)</span>: <span class="math display">\[
[-1.96 \cdot 0.0528, 1.96 \cdot 0.0528] = [-0.1035, 0.1035].
\]</span> En R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Límites de las zonas de rechazo</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>lim_inf <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="sc">-</span> z_alpha <span class="sc">*</span> se_nula</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>lim_sup <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="sc">+</span> z_alpha <span class="sc">*</span> se_nula</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>lim_inf</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1035862</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>lim_sup</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1035862</code></pre>
</div>
</div>
<p>Dado que el valor observado (<span class="math inline">\(0.238\)</span>) está fuera de este intervalo, cae en la <strong>zona de rechazo</strong>.</p>
<p>Nuevamente, esto se puede hacer facilmente en R utilizando la tabla de contingencia ya creada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>prueba_prop <span class="ot">=</span> <span class="fu">prop.test</span>(tabla, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(prueba_prop)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 9
  estimate1 estimate2 statistic   p.value parameter conf.low conf.high method   
      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1     0.533     0.295      19.4 0.0000109         1    0.131     0.346 2-sample…
# ℹ 1 more variable: alternative &lt;chr&gt;</code></pre>
</div>
</div>
<p>El estadístico <span class="math inline">\(z = 4.51\)</span> corresponde a un valor <span class="math inline">\(p\)</span> extremadamente pequeño (<span class="math inline">\(p \approx 0.000008\)</span>), menor que <span class="math inline">\(\alpha = 0.05\)</span>. Por lo tanto rechazamos <span class="math inline">\(H_0\)</span> y podemos concluir que existe una diferencia significativa en las proporciones de apoyo entre zonas urbanas y rurales.</p>
<p>La interpretación gráfica es la siguiente:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Este análisis nos permite afirmar que las diferencias observadas no son atribuibles al azar, con un nivel de confianza del 95%.</p>
</section>
</section>
<section id="comparaciones-de-dos-grupos-relacionados" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="comparaciones-de-dos-grupos-relacionados"><span class="header-section-number">7.3</span> Comparaciones de dos grupos relacionados</h2>
<p>Imagina que Flor ahora está interesada en si existe una <strong>diferencia en el rendimiento de un grupo de estudiantes antes y después de una intervención educativa</strong>. Para ello, ha recopilado datos sobre el puntaje de los mismos estudiantes <strong>antes y después del programa</strong>, permitiendo analizar si hubo una mejora significativa en sus resultados.</p>
<p>Este es un caso de <strong>muestras relacionadas</strong> o pareadas, ya que cada observación en la primera condición (antes de la intervención) tiene una <strong>relación directa</strong> con una observación en la segunda condición (después de la intervención). A diferencia de la comparación entre grupos independientes, aquí no estamos viendo si dos poblaciones son distintas, sino si <strong>hay un cambio dentro de la misma población en dos momentos distintos</strong>.</p>
<p>Flor está investigando si un <strong>programa de refuerzo educativo</strong> mejora el rendimiento de los estudiantes en una evaluación estandarizada. Para ello, ha diseñado un estudio donde mide el desempeño de un grupo de estudiantes <strong>antes y después de recibir el programa de apoyo</strong>. En este caso, se utiliza una <strong>prueba estandarizada</strong> con una escala de <strong>0 a 100 puntos</strong>. El diseño del estudio es de <strong>muestras pareadas</strong> porque cada estudiante tiene <strong>dos mediciones</strong>:<br>
- <strong>antes:</strong> Puntaje en la prueba antes de recibir el programa de refuerzo.<br>
- <strong>después:</strong> Puntaje en la misma prueba, aplicada nuevamente tras la intervención.</p>
<p>Este enfoque permite analizar si el programa tuvo un impacto real en el rendimiento de los estudiantes, comparando los puntajes de cada individuo en dos momentos distintos. En lugar de comparar <strong>grupos independientes</strong>, aquí evaluamos el <strong>cambio dentro de los mismos estudiantes</strong>, lo que hace que el análisis sea más preciso y reduzca la variabilidad causada por diferencias individuales. Por tanto, Flor está evaluando si la diferencia observada en los puntajes antes y después del programa <strong>es estadísticamente significativa</strong> y si puede atribuirse al programa de refuerzo educativo en lugar del azar.</p>
<p>Carga los datos y observa su estructura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>rendimiento <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'rendimiento.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(rendimiento)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 50
Columns: 3
$ estudiante &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …
$ antes      &lt;dbl&gt; 41, 45, 67, 49, 50, 69, 54, 33, 40, 43, 63, 52, 53, 49, 41,…
$ después    &lt;dbl&gt; 53, 56, 78, 67, 60, 88, 57, 47, 35, 32, 76, 60, 62, 55, 32,…</code></pre>
</div>
</div>
<p>Para entender la distribución de los puntajes antes y después de la intervención, utilizamos <code>describeBy</code> del paquete <code>psych</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(rendimiento, <span class="at">group =</span> <span class="cn">NULL</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           vars  n  mean    sd median trimmed   mad min max range  skew
estudiante    1 50 25.50 14.58   25.5   25.50 18.53   1  50    49  0.00
antes         2 50 48.38 11.14   47.0   48.12 10.38  24  74    50  0.17
después       3 50 57.68 14.24   60.0   57.88 11.86  28  88    60 -0.14
           kurtosis   se
estudiante    -1.27 2.06
antes         -0.53 1.58
después       -0.53 2.01</code></pre>
</div>
</div>
<p>Fíjate en los valores de la <strong>media, mediana y desviación estándar</strong> en los puntajes <strong>antes y después</strong> de la intervención. La media pasó de <strong>48.38 a 57.68</strong>, lo que sugiere una mejora en el rendimiento de los estudiantes. La <strong>mediana</strong> aumentó de <strong>47 a 60</strong>, lo que indica que más de la mitad de los estudiantes tienen puntajes más altos después del programa. Sin embargo, la <strong>desviación estándar también aumentó</strong> (de <strong>11.14 a 14.24</strong>), lo que nos dice que los puntajes después de la intervención son más dispersos. Esto podría deberse a que algunos estudiantes mejoraron, mientras que otros se mantuvieron iguales o incluso bajaron su rendimiento. Pero la verdadera pregunta es <strong>¿qué tan diferente es este cambio?</strong> ¿Es suficiente para concluir que el programa realmente tuvo un efecto o pudo haber ocurrido por azar? Para responder esto, necesitamos un análisis estadístico más riguroso.</p>
<p>Podemos visualizar la diferencia de manera más intuitiva con un <strong>boxplot pareado</strong>, donde observamos cómo cambian los valores antes y después para cada estudiante.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>rendimiento <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(antes, después), <span class="at">names_to =</span> <span class="st">"momento"</span>, <span class="at">values_to =</span> <span class="st">"puntaje"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> momento, <span class="at">y =</span> puntaje, <span class="at">fill =</span> momento)) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de puntajes antes y después del programa"</span>, </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Puntaje"</span>) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que efectivamente hay una diferencia. La clave aquí es determinar <strong>qué tan grande es la diferencia y si puede atribuirse al azar o a un efecto real del programa</strong>.</p>
<p>Dado que estamos trabajando con <strong>muestras pareadas</strong>, en lugar de comparar las medias de dos grupos independientes, calculamos <strong>las diferencias dentro de cada individuo</strong></p>
<p><span class="math display">\[
d_i = \text{después}_i - \text{antes}_i
\]</span></p>
<p>Luego, analizamos la media y la dispersión de estas diferencias:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>rendimiento <span class="ot">=</span> rendimiento <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diferencia =</span> después <span class="sc">-</span> antes)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>estadisticas <span class="ot">=</span> rendimiento <span class="sc">%&gt;%</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">promedio =</span> <span class="fu">mean</span>(diferencia),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(diferencia),</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>estadisticas</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  promedio    sd     n
     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1      9.3  7.85    50</code></pre>
</div>
</div>
<p>Esto nos da la diferencia promedio observada en los puntajes tras la intervención.</p>
<p>Para evaluar si el efecto de la intervención es significativo, construimos un <strong>intervalo de confianza del 95%</strong> para la diferencia de medias pareadas. La fórmula sigue la misma lógica que en el caso de muestras independientes, pero ahora el <strong>error estándar</strong> se basa únicamente en la distribución de las diferencias pareadas:</p>
<p><span class="math display">\[
\text{Error estándar} = \frac{s_d}{\sqrt{n}}
\]</span></p>
<p>donde <span class="math inline">\(s_d\)</span> es la desviación estándar de las diferencias y <span class="math inline">\(n\)</span> es el número de pares de observaciones.</p>
<p>Aquí tienes el resto del código con la notación LaTeX correctamente aplicada:</p>
<p>Por lo que</p>
<p><span class="math display">\[
\text{Error estándar} = \frac{7.85}{\sqrt{50}} = 1.1
\]</span></p>
<p>Calculamos el error estándar en R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>ee <span class="ot">=</span> estadisticas<span class="sc">$</span>sd <span class="sc">/</span> <span class="fu">sqrt</span>(estadisticas<span class="sc">$</span>n)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>ee</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.109973</code></pre>
</div>
</div>
<p>Por lo que <span class="math inline">\(EE = 1.1\)</span></p>
<p>Ahora obtenemos el <strong>valor crítico</strong> <span class="math inline">\(t\)</span> para un intervalo de confianza del 95%, utilizando la distribución <span class="math inline">\(t\)</span> de Student con <span class="math inline">\(n-1\)</span> grados de libertad:</p>
<p><span class="math display">\[
gl = n - 1 = 50 - 1 = 49
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> estadisticas<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>  </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> gl)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.009575</code></pre>
</div>
</div>
<p>Por lo que el <strong>valor crítico</strong> <span class="math inline">\(t\)</span> es aproximadamente <span class="math inline">\(t_{0.975, 49} = 2.009\)</span></p>
<p>Finalmente, construimos el <strong>intervalo de confianza</strong> para la diferencia de medias:</p>
<p><span class="math display">\[
IC = \bar{d} \pm t \cdot EE
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>ic <span class="ot">=</span> <span class="fu">c</span>(estadisticas<span class="sc">$</span>promedio <span class="sc">-</span> t <span class="sc">*</span> ee, estadisticas<span class="sc">$</span>promedio <span class="sc">+</span> t <span class="sc">*</span> ee)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>ic</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7.069425 11.530575</code></pre>
</div>
</div>
<p>Lo que nos da un intervalo de confianza de:</p>
<p><span class="math display">\[
IC = (5.2, 10.1)
\]</span></p>
<p>Esto significa que, con un <strong>95% de confianza</strong>, podemos decir que la <strong>media de las diferencias individuales</strong> en la población (<span class="math inline">\(\bar{d}\)</span>) se encuentra dentro de este rango. Como el intervalo <strong>no incluye el 0</strong>, esto sugiere que la diferencia observada en los puntajes <strong>no se debe al azar</strong>, sino que hay evidencia de que el programa tuvo un efecto real en el rendimiento de los estudiantes. Pero realicemos un contraste de hipótesis para complementar el analisis.</p>
<p>El <strong>t-test para muestras pareadas</strong> nos permite evaluar si la diferencia observada es <strong>estadísticamente significativa</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>prueba_pareada <span class="ot">=</span> <span class="fu">t.test</span>(rendimiento<span class="sc">$</span>antes, </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                        rendimiento<span class="sc">$</span>después, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Indicamos que los datos están relacionados</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">paired =</span> <span class="cn">TRUE</span>,  </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mu =</span> <span class="dv">0</span>, </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alternative =</span> <span class="st">"two.sided"</span>, </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(prueba_pareada)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  estimate statistic  p.value parameter conf.low conf.high method    alternative
     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;      
1     -9.3     -8.38 5.07e-11        49    -11.5     -7.07 Paired t… two.sided  </code></pre>
</div>
</div>
<p>Analizando el resultado de la prueba vemos que el <strong>estadístico t</strong> es <strong>-8.38</strong>, lo que indica que la diferencia entre los puntajes antes y después es mucho mayor de lo que esperaríamos por azar (la diferencia observada esta mas de 8 errores estándar lejos de la media de <span class="math inline">\(H_0:\text{No hay diferencia}(\bar d= 0)\)</span>). Además, el <strong>p-valor es 5.07e-11</strong>, es decir, prácticamente <strong>cero</strong>, lo que nos permite rechazar la hipótesis nula <span class="math inline">\(H_0\)</span> con un altísimo nivel de confianza.</p>
<p>Dado que el <strong>p-valor es menor que</strong> <span class="math inline">\(\alpha = 0.05\)</span>, tenemos evidencia suficiente para concluir que la intervención educativa <strong>tuvo un impacto significativo en el rendimiento de los estudiantes</strong>. La consistencia entre la prueba de hipótesis y el intervalo de confianza refuerza la conclusión de que el efecto no es producto del azar, sino una diferencia real en la población.</p>
</section>
<section id="comparación-de-múltiples-grupos" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="comparación-de-múltiples-grupos"><span class="header-section-number">7.4</span> Comparación de múltiples grupos</h2>
<p>Perfecto, ya sabemos que cuando queremos comparar <strong>dos grupos</strong>, utilizamos pruebas como el <strong>t-test</strong> para evaluar si hay diferencias significativas en sus medias. Pero, ¿qué sucede cuando tenemos <strong>más de dos grupos</strong>?</p>
<section id="anova" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="anova"><span class="header-section-number">7.4.1</span> ANOVA</h3>
<p>Cuando comparamos variación en las medias de los dinstitnos grupos, la prueba de <strong>ANOVA (Análisis de Varianza)</strong> es la herramienta adecuada. Las pruebas ANOVA siguen la misma lógica e untición matemática vista en las anteriores pruebas pero los cálculos matemáticos son algo más complejas y están fuera del propósito del libro, aunque te animo a revisarlas por ti mismo.</p>
<p>Imagina que Flor está investigando si existe una <strong>diferencia en la satisfacción laboral</strong> entre distintos sectores económicos. Para ello, ha recopilado datos de empleados en cinco sectores: <strong>Tecnología, Finanzas, Educación, Salud y Manufactura</strong>. Su objetivo es determinar si el nivel de satisfacción laboral varía significativamente entre los grupos.</p>
<p>Para medir la satisfacción, cada empleado calificó su experiencia laboral en una escala de <strong>0 a 10</strong>, donde:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Puntuación</strong></th>
<th><strong>Nivel de Satisfacción</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0 - 2</td>
<td>Muy insatisfecho</td>
</tr>
<tr class="even">
<td>3 - 4</td>
<td>Insatisfecho</td>
</tr>
<tr class="odd">
<td>5 - 6</td>
<td>Neutral</td>
</tr>
<tr class="even">
<td>7 - 8</td>
<td>Satisfecho</td>
</tr>
<tr class="odd">
<td>9 - 10</td>
<td>Muy satisfecho</td>
</tr>
</tbody>
</table>
<p>ANOVA nos permite comparar las <strong>medias de tres o más grupos</strong> y determinar si al menos uno de ellos es significativamente diferente de los demás. En lugar de realizar múltiples t-tests (lo que aumentaría el riesgo de error tipo I), ANOVA evalúa si la <strong>variabilidad entre los grupos</strong> es mayor que la <strong>variabilidad dentro de cada grupo</strong>, lo que indicaría que las diferencias observadas <strong>no se deben al azar</strong>.</p>
<p>En pruebas anteriores vimos que, cuando comparamos <strong>dos grupos</strong>, usamos la <strong>distribución t</strong> para evaluar la diferencia entre sus medias. La distribución <span class="math inline">\(t\)</span> es útil para comparar dos muestras porque se basa en la diferencia de medias y la variabilidad dentro de cada grupo. En lugar de eso, ANOVA utiliza la <strong>distribución F</strong>, que compara la <strong>variabilidad entre los grupos</strong> con la <strong>variabilidad dentro de los grupos</strong> en una sola prueba.</p>
<p>El <strong>estadístico F</strong> se define como:</p>
<p><span class="math display">\[
F = \frac{\text{Variabilidad entre grupos}}{\text{Variabilidad dentro de los grupos}}
\]</span><br>
</p>
<p>¿Pero por qué nos interesa comparar la <strong>variabilidad entre los grupos</strong> con la <strong>variabilidad dentro de los grupos</strong>? Porque esto nos dice si las diferencias observadas son reales o simplemente producto del azar. Si la variabilidad entre los grupos es similar a la variabilidad dentro de ellos, significa que las diferencias en las medias no son mayores que las fluctuaciones normales que ocurren dentro de cada grupo. En otras palabras, aunque haya cierta dispersión en los datos, esta dispersión es comparable en todos los grupos, por lo que no hay razones para pensar que alguno de ellos sea realmente diferente. Sin embargo, si la variabilidad entre los grupos es mucho mayor que la variabilidad dentro de ellos, entonces estamos viendo diferencias que van más allá de la variación esperada dentro de cada grupo. Esto nos sugiere que al menos un grupo tiene una media que se aleja significativamente de los demás. Esa es la clave del ANOVA.</p>
<p>La distribución F tiene características particulares que la hacen adecuada para comparar varianzas y analizar relaciones entre grupos.Por un lado, la distribución F <strong>siempre toma valores positivos</strong>. Esto ocurre porque se construye a partir de la razón de dos varianzas, y una varianza nunca puede ser negativa. Por esta razón, su forma es asimétrica y se extiende hacia la derecha, lo que significa que valores grandes de F indican una mayor diferencia entre los grupos analizados.</p>
<p>Otra propiedad importante es que la forma de la distribución F <strong>cambia según los grados de libertad</strong>. En cada prueba ANOVA, hay dos conjuntos de grados de libertad: uno asociado a la variabilidad entre los grupos y otro a la variabilidad dentro de los grupos. A medida que aumentan los grados de libertad, la distribución F se va pareciendo más a una distribución normal, pero sigue siendo asimétrica.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/F-distribution_pdf.svg.png" class="img-fluid figure-img"></p>
<figcaption>Extraído de: https://es.wikipedia.org/wiki/Distribución_F</figcaption>
</figure>
</div>
<p>La distribución F nos permite determinar qué tan extremo debe ser un valor F para rechazar la hipótesis nula. Valores bajos de F indican que las diferencias entre los grupos no son mayores que las diferencias dentro de ellos, mientras que valores altos sugieren que al menos un grupo es significativamente distinto. Por eso, en las pruebas ANOVA, cuando obtenemos un F suficientemente grande, podemos concluir que hay diferencias estadísticamente significativas entre los grupos analizados.</p>
<p>El primer paso es formular nuestras hipótesis estadísticas:</p>
<ul>
<li><strong>Hipótesis nula</strong> (<span class="math inline">\(H_0\)</span>): No existe diferencia en la satisfacción laboral entre los sectores. Es decir:</li>
</ul>
<p><span class="math display">\[
    H_0: \mu_1 = \mu_2 = \mu_3 = \mu_4 = \mu_5
\]</span></p>
<ul>
<li><strong>Hipótesis alternativa</strong> (<span class="math inline">\(H_1\)</span>): Al menos un sector tiene una media de satisfacción diferente:</li>
</ul>
<p><span class="math display">\[
    H_1: \text{Al menos un } \mu_i \text{ es diferente}
\]</span></p>
<p>Bajo (<span class="math inline">\(H_0\)</span>), los niveles de satisfacción en los distintos sectores son iguales. Si rechazamos (<span class="math inline">\(H_0\)</span>), concluimos que existe una diferencia significativa en la satisfacción laboral entre <strong>al menos un grupo</strong>.</p>
<p>Cargamos los datos de la encuesta</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>satisfaccion <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'base_satisfaccion.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(satisfaccion)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 2
$ sector             &lt;chr&gt; "Educación", "Educación", "Educación", "Educación",…
$ nivel_satisfaccion &lt;dbl&gt; 7, 9, 0, 9, 5, 4, 5, 9, 0, 10, 6, 7, 6, 2, 9, 7, 4,…</code></pre>
</div>
</div>
<p>Antes de realizar la prueba ANOVA, exploramos las características de cada grupo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas descriptivas por sector</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>satisfaccion <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">media =</span> <span class="fu">mean</span>(nivel_satisfaccion),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">desviacion =</span> <span class="fu">sd</span>(nivel_satisfaccion),</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  sector      media desviacion     n
  &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
1 Educación    4.9        2.89    30
2 Finanzas     4.03       2.74    30
3 Manufactura  2.4        1.40    30
4 Salud        5.97       2.46    30
5 Tecnología   4.93       2.50    30</code></pre>
</div>
</div>
<p>Para visualizar las diferencias en satisfacción laboral entre sectores, podemos utilizar un <strong>boxplot</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(satisfaccion, <span class="fu">aes</span>(<span class="at">x =</span> sector, </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> nivel_satisfaccion, </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> sector)) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de la satisfacción laboral por sector"</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sector Económico"</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nivel de Satisfacción"</span>) <span class="sc">+</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que los niveles de satisfacción varían entre los sectores, pero ¿son estas diferencias lo suficientemente grandes como para concluir que el sector influye en la satisfacción laboral? En otras palabras, ¿la variabilidad en la satisfacción está asociada al sector o varía de forma independiente? En ANOVA, el concepto de <strong>independencia</strong> significa que, si no hay relación entre el sector y la satisfacción laboral, la variabilidad en los niveles de satisfacción sería similar tanto dentro de cada sector como entre ellos. En este caso, diríamos que la satisfacción laboral es <strong>independiente</strong> del sector, ya que pertenecer a uno u otro no influye en la percepción de satisfacción.</p>
<p>Por el contrario, si los niveles de satisfacción son muy distintos entre sectores pero relativamente homogéneos dentro de cada uno, significa que la satisfacción <strong>depende</strong> del sector económico. Es decir, el sector en el que una persona trabaja influye en su nivel de satisfacción laboral, y las diferencias observadas no pueden atribuirse únicamente al azar.</p>
<p><strong>ANOVA</strong> nos permite responder esta cuestión: <strong>¿las diferencias en satisfacción laboral reflejan un efecto real del sector o simplemente variaciones dentro de los grupos?</strong> Si encontramos diferencias significativas, concluimos que la satisfacción <strong>no es independiente</strong> del sector y que existe una relación que merece un análisis más detallado.</p>
<p>Utilizamos la función <code>aov()</code> que realiza un <strong>ANOVA</strong>. Esta función ajusta un modelo estadístico donde la variable repsuesta (satisfacción laboral) se compara entre los niveles de la variable explicativa (sector económico). Al ejecutar <code>summary()</code>, obtenemos una tabla con los resultados del análisis, incluyendo el <strong>estadístico F</strong> y su <strong>p-valor</strong>, que nos indican si existe una diferencia significativa entre los grupos. Fíjate en el Pr(&gt;F)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar ANOVA de una vía para comparar la satisfacción laboral entre sectores</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>anova_resultado <span class="ot">=</span> <span class="fu">aov</span>(nivel_satisfaccion <span class="sc">~</span> sector, </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> satisfaccion)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el resumen del ANOVA con el estadístico F y el p-valor</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_resultado)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
sector        4  213.4   53.34   8.853 2.01e-06 ***
Residuals   145  873.7    6.03                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Podmeos usar <code>tidy()</code> de la misma forma</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(anova_resultado)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  term         df sumsq meansq statistic     p.value
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 sector        4  213.  53.3       8.85  0.00000201
2 Residuals   145  874.   6.03     NA    NA         </code></pre>
</div>
</div>
<p>El <strong>p-valor de 2.1e-06</strong> indica los mismo que anteriores pruebas, es decir, <strong>la probabilidad de obtener una variabilidad entre los sectores tan grande como la observada si en realidad no hubiera ninguna diferencia real en la satisfacción laboral</strong> (es decir, si la hipótesis nula fuera cierta). Dado que este valor es mucho menor que 0.05, rechazamos la hipótesis nula con un alto nivel de confianza. Esto significa que la satisfacción laboral <strong>no varía de manera independiente del sector económico, sino que existe una diferencia significativa entre al menos uno de los sectores</strong>, lo que sugiere que el sector de trabajo influye en el nivel de satisfacción.</p>
<p>Ojo, el resultado del ANOVA nos indica que <strong>existen diferencias significativas en la satisfacción laboral entre los sectores</strong>, pero no nos dice <strong>qué sectores son distintos entre sí</strong> ni <strong>cómo esas diferencias afectan al resto de los grupos</strong>. ANOVA solo nos informa que al menos un sector tiene una media diferente, pero no nos especifica cuáles ni en qué dirección.</p>
<p>Para profundizar en estos resultados, necesitamos una <strong>prueba post-hoc</strong>, como la <strong>prueba de Tukey</strong>, que compara todas las combinaciones posibles de sectores y ajusta los valores p para evitar aumentar el error tipo I. Esto es clave porque, en algunos casos, una diferencia extrema en un grupo puede estar impulsando el resultado global del ANOVA y, al mismo tiempo, influir en las diferencias entre otros sectores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>tukey <span class="ot">=</span> <span class="fu">TukeyHSD</span>(anova_resultado)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(tukey)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   term   contrast            null.value estimate conf.low conf.high adj.p.value
   &lt;chr&gt;  &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1 sector Finanzas-Educación           0  -0.867    -2.62      0.884 0.649      
 2 sector Manufactura-Educac…          0  -2.50     -4.25     -0.749 0.00116    
 3 sector Salud-Educación              0   1.07     -0.684     2.82  0.448      
 4 sector Tecnología-Educaci…          0   0.0333   -1.72      1.78  1.000      
 5 sector Manufactura-Finanz…          0  -1.63     -3.38      0.117 0.0800     
 6 sector Salud-Finanzas               0   1.93      0.183     3.68  0.0225     
 7 sector Tecnología-Finanzas          0   0.900    -0.851     2.65  0.616      
 8 sector Salud-Manufactura            0   3.57      1.82      5.32  0.000000907
 9 sector Tecnología-Manufac…          0   2.53      0.783     4.28  0.000954   
10 sector Tecnología-Salud             0  -1.03     -2.78      0.717 0.481      </code></pre>
</div>
</div>
<p>Para interpretar los resultados, observamos cuatro elementos clave. La columna <strong>diff</strong> muestra la diferencia promedio en satisfacción entre los sectores comparados; un valor positivo indica que el primer sector tiene mayor satisfacción que el segundo, mientras que un valor negativo indica lo contrario. Las columnas <strong>lwr y upr</strong> representan el intervalo de confianza del 95%, lo que significa que, si este intervalo incluye el cero, la diferencia entre los sectores no es estadísticamente significativa. Finalmente, la columna <strong>p adj</strong> nos indica si la diferencia observada es lo suficientemente grande como para ser considerada significativa, siendo relevante cuando es menor a 0.05.</p>
<p>En nuestra muestra, los resultados muestran que <strong>manufactura tiene una satisfacción laboral significativamente menor</strong> en comparación con Educación, Finanzas, Salud y Tecnología, ya que sus diferencias de medias son negativas y tienen p-valores menores a 0.05. En cambio, entre los otros sectores no hay diferencias significativas, esto nos puede hacer sospechar que la variabilidad detectada en el ANOVA se debe principalmente a Manufactura, mientras que el resto de los sectores presentan niveles de satisfacción comparables.</p>
<p>Para verificar si la variabilidad detectada en el ANOVA se debe principalmente a <strong>manufactura</strong>, realizamos nuevamente la prueba excluyendo este sector y comparando únicamente <strong>Tecnología, Finanzas, Educación y Salud</strong>. S</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar la base de datos excluyendo el sector Manufactura</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>satisfaccion_sin_manufactura <span class="ot">=</span> satisfaccion <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector <span class="sc">!=</span> <span class="st">"Manufactura"</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar ANOVA de una vía sin Manufactura</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>anova_sin_manufactura <span class="ot">=</span> <span class="fu">aov</span>(nivel_satisfaccion <span class="sc">~</span> sector, </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> satisfaccion_sin_manufactura)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(anova_sin_manufactura)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  term         df sumsq meansq statistic p.value
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 sector        3  56.3  18.8       2.67  0.0511
2 Residuals   116 816.    7.04     NA    NA     </code></pre>
</div>
</div>
<p>El nuevo ANOVA sin <strong>Manufactura</strong> muestra que <strong>ya no hay diferencias significativas</strong> en la satisfacción laboral entre los sectores restantes (<strong>Tecnología, Finanzas, Educación y Salud</strong>). El <strong>p-valor de 0.51</strong> muy superior al umbral de 0.05, lo que significa que no hay suficiente evidencia para decir que estos sectores tienen niveles de satisfacción distintos. En otras palabras, cualquier diferencia observada entre ellos es pequeña y puede explicarse simplemente por variaciones dentro de los grupos, sin que el sector tenga un efecto real sobre la satisfacción laboral.</p>
<p>¿Ves lo importante que es complementar un ANOVA con otras pruebas? Si solo nos hubiéramos quedado con el primer resultado, podríamos haber pensado que <strong>todos los sectores</strong> tenían diferencias significativas en la satisfacción laboral. Sin embargo, al hacer la prueba sin Manufactura, el ANOVA nos dice algo muy diferente: <strong>las diferencias son menores</strong>. Esto confirma que <strong>la variabilidad detectada en el primer ANOVA se debía principalmente a Manufactura</strong>, que tenía niveles de satisfacción claramente más bajos.</p>
<p>Esto nos ayuda a evitar errores de interpretación. Si hubiéramos concluido que <strong>todos los sectores eran diferentes</strong>, habríamos exagerado el efecto del sector en la satisfacción laboral. Aquí es donde las pruebas post-hoc como Tukey son clave, porque nos permiten entender <strong>qué sectores están generando las diferencias en el ANOVA</strong> y evitar conclusiones erróneas.</p>
<p>El ejemplo que hemos descrito es el de un <strong>ANOVA de un solo factor</strong>, que se utiliza para comparar las medias de tres o más grupos basados en un solo factor. Este tipo de ANOVA permite determinar si existe una diferencia significativa entre las medias de los grupos. Existen otros tipos de ANOVA, como la <strong>ANOVA de dos factores</strong>, que evalúa la interacción entre dos factores, y la <strong>ANOVA de medidas repetidas</strong>, que se usa cuando se mide la misma variable en los mismos sujetos en diferentes condiciones. Sugiero le eches un vistazo a estos métodos ya que son importantes en algunos contextos más complejos.</p>
</section>
<section id="chi-cuadrado" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="chi-cuadrado"><span class="header-section-number">7.4.2</span> Chi-Cuadrado</h3>
<p>De acuerdo, si la prueba ANOVA nos permite comparar medias entre tres o más grupos cuando los datos son numéricos.¿Qué ocurre cuando queremos analizar proporciones en grupos diferentes? En estos casos, la prueba de Chi-cuadrado es la herramienta adecuada.</p>
<p>Flor ahora está investigando si <strong>el nivel educativo</strong> de una persona influye en el <strong>tipo de empleo</strong> que obtiene. Para ello, ha recopilado datos de 500 personas y ha clasificado su educación en tres categorías:</p>
<ul>
<li><strong>Básica</strong>: Primaria o secundaria incompleta.<br>
</li>
<li><strong>Media</strong>: Secundaria completa o educación técnica.<br>
</li>
<li><strong>Superior</strong>: Educación universitaria o posgrado.</li>
</ul>
<p>También ha registrado el <strong>tipo de empleo</strong> de cada persona:</p>
<ul>
<li><strong>Informal</strong>: Trabajo sin beneficios ni contrato legal.<br>
</li>
<li><strong>Formal</strong>: Trabajo con contrato y beneficios laborales.</li>
</ul>
<p>El objetivo de Flor es determinar si <strong>la distribución de empleo formal e informal varía según el nivel educativo</strong>.</p>
<p>Si la educación <strong>no influye</strong> en el tipo de empleo, esperaríamos que las proporciones de empleados formales e informales sean <strong>similares en todos los niveles educativos</strong>. Sin embargo, si hay una relación, podríamos ver que, por ejemplo, las personas con educación superior tienen más empleo formal que aquellas con educación básica. a prueba de <strong>Chi-cuadrado de independencia</strong> nos ayuda a responder la pregunta:</p>
<blockquote class="blockquote">
<p>¿Existe una relación entre el nivel educativo y el tipo de empleo, o las diferencias observadas podrían explicarse solo por azar?</p>
</blockquote>
<p>Para hacerlo, la prueba compara las <strong>frecuencias observadas</strong> con las <strong>frecuencias esperadas</strong>. Las <strong>frecuencias observadas</strong> son simplemente los datos de nuestra muestra, es decir, cuántas personas en cada nivel educativo tienen empleo formal o informal. Pero, ¿qué pasaría si el nivel educativo no tuviera ninguna relación con el tipo de empleo? En ese caso, las proporciones de empleo formal e informal deberían ser <strong>aproximadamente las mismas en todos los niveles educativos</strong>. Estas son las <strong>frecuencias esperadas</strong>, es decir, cuántas personas en cada categoría deberíamos ver si no existiera ninguna relación entre las variables. Si las frecuencias observadas son muy diferentes de las esperadas, significa que el tipo de empleo varía según el nivel educativo y que existe una asociación entre ambas variables. La prueba de <strong>Chi-cuadrado</strong> compara estas diferencias y nos dice si son lo suficientemente grandes como para descartar que se deban al azar.</p>
<p>La hipótesis nula <span class="math inline">\((H_0)\)</span> plantea que <strong>no hay relación</strong> entre el nivel educativo y el tipo de empleo:</p>
<p><span class="math display">\[
H_0: \text{El tipo de empleo es independiente del nivel educativo}
\]</span></p>
<p>La hipótesis alternativa <span class="math inline">\((H_1)\)</span> establece que sí existe una relación:</p>
<p><span class="math display">\[
H_1: \text{El tipo de empleo depende del nivel educativo}
\]</span></p>
<p>Si rechazamos <span class="math inline">\(H_0\)</span>, significa que el nivel educativo influye en la probabilidad de obtener empleo formal o informal.</p>
<p>Importa los datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>edu_emp <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"educacion_emp.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(edu_emp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 500
Columns: 2
$ nivel_educativo &lt;chr&gt; "Media", "Superior", "Básica", "Superior", "Superior",…
$ tipo_empleo     &lt;chr&gt; "Formal", "Formal", "Informal", "Formal", "Formal", "F…</code></pre>
</div>
</div>
<p>Para visualizar mejor la distribución, utilizamos un <strong>gráfico de barras apiladas</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>edu_emp <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nivel_educativo, <span class="at">fill =</span> tipo_empleo)) <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución del tipo de empleo según nivel educativo"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Nivel Educativo"</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporción"</span>,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tipo de empleo"</span>) <span class="sc">+</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Podemos observar una tendencia: a medida que aumenta el nivel educativo, la frecuencia de empleo informal se reduce y el empleo formal se vuelve más común. Sin embargo, ¿esta diferencia es lo suficientemente significativa? Es decir, ¿es suficiente para afirmar que el nivel educativo y el tipo de empleo están relacionados, o podría tratarse solo de una variación aleatoria en los datos? Para responder a esta pregunta, utilizamos la prueba de <strong>Chi-cuadrado</strong>, que nos permite evaluar si la distribución del empleo formal e informal varía significativamente según el nivel educativo.</p>
<p>La prueba de <strong>Chi-cuadrado</strong> mide cuánto difieren las frecuencias observadas de las frecuencias esperadas bajo la hipótesis nula. Se calcula con la fórmula:</p>
<p><span class="math display">\[
\chi^2 = \sum \frac{(O - E)^2}{E}
\]</span><br>
Donde:</p>
<ul>
<li><p><span class="math inline">\(O\)</span> son las <strong>frecuencias observadas</strong> (datos reales).</p></li>
<li><p><span class="math inline">\(E\)</span> son las <strong>frecuencias esperadas</strong> bajo la hipótesis de independencia.</p></li>
</ul>
<p>Al igual que ANOVA utiliza la <strong>distribución F</strong> para comparar <strong>varianzas entre grupos</strong>, la <strong>prueba de Chi-cuadrado</strong> (<span class="math inline">\(\chi^2\)</span>) se basa en la <strong>distribución Chi-cuadrado</strong> para comparar <strong>frecuencias observadas y esperadas</strong>. Esta distribución <strong>siempre toma valores positivos</strong>, porque está basada en la suma de cuadrados de las diferencias entre frecuencias observadas y esperadas. Además, la forma de la distribución <span class="math inline">\(\chi^2\)</span> depende del <strong>número de grados de libertad</strong> (<span class="math inline">\(k\)</span>), que en este caso están determinados por el número de categorías en la tabla de contingencia. Cuando hay pocos grados de libertad, la distribución es altamente asimétrica y sesgada hacia la derecha. A medida que los grados de libertad aumentan, la distribución se va pareciendo más a una normal, lo que permite que los valores críticos sean más estables.</p>
<p>En la prueba de Chi-cuadrado para tablas de contingencia, el estadístico <span class="math inline">\(\chi^2\)</span> mide <strong>qué tan grandes son las diferencias entre las frecuencias observadas y las frecuencias esperadas bajo la hipótesis nula</strong>. Si las diferencias son pequeñas, el estadístico <span class="math inline">\(\chi^2\)</span> tomará valores bajos, lo que sugiere que los grupos tienen distribuciones similares. Pero si las diferencias son grandes, el valor de <span class="math inline">\(\chi^2\)</span> será alto, lo que indica que al menos una de las categorías se aleja de lo esperado. La región de rechazo se encuentra en la <strong>cola derecha de la distribución</strong>, ya que valores altos de <span class="math inline">\(\chi^2\)</span> implican una mayor discrepancia entre lo observado y lo esperado.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Chi-square_pdf.svg.png" class="img-fluid figure-img"></p>
<figcaption>Extraído de: https://en.wikipedia.org/wiki/Chi-squared_distribution</figcaption>
</figure>
</div>
<p>En R, realizamos la prueba con <code>chisq.test()</code> volviendo los datos una tabla primero:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>tabla_educacion <span class="ot">=</span> <span class="fu">table</span>(edu_emp)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>prueba_chi <span class="ot">=</span> <span class="fu">chisq.test</span>(tabla_educacion)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(prueba_chi)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic p.value parameter method                    
      &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                     
1      10.3 0.00585         2 Pearson's Chi-squared test</code></pre>
</div>
</div>
<p>La prueba nos arroja una serie de estadísticos, interpétemoslos:</p>
<p><span class="math display">\[
\chi^2 = 10.3, \quad p\text{-valor} = 0.00585, \quad \text{k} = 2
\]</span></p>
<ul>
<li><span class="math inline">\(\chi^2 = 10.3\)</span> es el <strong>estadístico de Chi-cuadrado</strong>, que mide cuánto difieren las frecuencias observadas de las esperadas. Un valor mayor indica una mayor discrepancia entre lo que observamos en la muestra y lo que esperaríamos si las variables fueran independientes.<br>
</li>
<li><span class="math inline">\(p\text{-valor} = 0.00585\)</span> representa la probabilidad de obtener una diferencia tan extrema entre lo observado y lo esperado <strong>si en realidad no hubiera relación</strong> entre el nivel educativo y el tipo de empleo.<br>
</li>
<li><span class="math inline">\(\text{k} = 2\)</span> son los <strong>grados de libertad</strong>, que dependen del número de categorías en cada variable y determinan la forma de la distribución de Chi-cuadrado. Se calculan como:</li>
</ul>
<p><span class="math display">\[
  \text{k} = (\text{número de filas} - 1) \times (\text{número de columnas} - 1)
\]</span></p>
<p>En este caso, tenemos 3 niveles educativos y 2 tipos de empleo, por lo que:</p>
<p><span class="math display">\[
  \text{k} = (3-1) \times (2-1) = 2
\]</span><br>
</p>
<p>El <strong>p-valor de 0.00585</strong> es menor que <strong>0.05</strong>. Por lo tanto, <strong>rechazamos la hipótesis nula</strong> y concluimos que <strong>el nivel educativo y el tipo de empleo no son independientes</strong>. Es decir, el hecho de que una persona tenga empleo formal o informal en nuestra población de estudio <strong>es altamente improbable que sea debido al azar</strong>, sino que está influenciado por su nivel educativo. En an análisis descriptivos observamos que en los niveles <strong>medio y superior</strong>, hay una mayor proporción de empleo formal en comparación con el nivel básico, lo que nos indica que <strong>a mayor nivel educativo, mayor es la probabilidad de acceder a un empleo formal</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Ilustración_sin_título.png" class="img-fluid figure-img" width="488"></p>
<figcaption>Comparar múltiples grupos requiere atención al detalle</figcaption>
</figure>
</div>
</section>
</section>
<section id="supuestos" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="supuestos"><span class="header-section-number">7.5</span> Supuestos</h2>
<p>Los supuestos de estos tipos de pruebas guardan estrecha similitud con las pruebas para una muestra o proporción, con algunos ajustes necesarios:</p>
<p><strong>Muestreo Aleatorio e Independencia de las Observaciones</strong></p>
<p>En la comparación de grupos, el supuesto de muestreo aleatorio y la independencia de las observaciones sigue siendo importante. Es necesario garantizar que las observaciones dentro de cada grupo sean independientes, lo que significa que el valor de una observación no debe influir en el valor de otra dentro del mismo grupo. Además, debe asegurarse que los grupos sean independientes entre sí, es decir, que no haya influencia o relación directa entre las muestras de los grupos comparados. En el ejemplo del estudio de zonas rurales y urbanas, es importante verificar que los participantes de una zona no pertenezcan o tengan algún tipo de relación con la otra (por ejemplo, alguien que vive en zona rural pero trabaja en zona urbana). La falta de independencia puede sesgar los resultados y hacer que las inferencias no sean confiables.</p>
<p><strong>Tamaño Suficiente de la Muestra</strong></p>
<p>El tamaño de la muestra es un factor esencial y en este caso, deben ser suficiente en cada grupo individual. El Teorema del Límite Central (TLC) garantiza que las distribuciones muestrales se aproximen a una normalidad cuando el tamaño de la muestra sea grande (<span class="math inline">\(n &gt; 30\)</span>), pero este criterio debe cumplirse para cada grupo. Si uno de los grupos tiene un tamaño de muestra pequeño, los resultados pueden ser menos confiables.</p>
<p><strong>Normalidad de la Distribución</strong></p>
<p>En la comparación de grupos, este supuesto debe cumplirse no solo para cada grupo individual, sino también para la distribución de las diferencias entre los grupos. Si los tamaños de muestra son pequeños (<span class="math inline">\(n \leq 30\)</span>), es necesario verificar explícitamente la normalidad de los datos en cada grupo.</p>
<p><strong>Homogeneidad de Varianzas</strong></p>
<p>Adicionalmente, tenemos un supuesto específico de la comparación de grupo. La homogeneidad de las varianzas. Este supuesto establece que la variabilidad dentro de cada grupo debe ser similar. Si las varianzas son significativamente diferentes, el grupo con mayor variabilidad tendrá un impacto desproporcionado en el cálculo del estadístico. Las pruebas que asumen homogeneidad pueden arrojar resultados sesgados.</p>
</section>
<section id="pruebas-no-paramétricas" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="pruebas-no-paramétricas"><span class="header-section-number">7.6</span> Pruebas no paramétricas</h2>
<p>Ya vimos que cuando la <strong>prueba de normalidad no se cumple</strong> o cuando las <strong>varianzas son muy desiguales</strong>, las pruebas paramétricas como el <strong>t-test</strong>, el <strong>z-test de proporciones</strong> o el <strong>ANOVA</strong> pueden generar resultados poco confiables. En estos casos, podemos recurrir a <strong>pruebas no paramétricas</strong>, que son más flexibles y robustas frente a distribuciones desconocidas, datos asimétricos o la presencia de valores atípicos.</p>
<p>Las pruebas no paramétricas <strong>no requieren que los datos sigan una distribución normal</strong>, y en lugar de trabajar directamente con los valores originales, suelen basarse en <strong>rangos, conteos o permutaciones</strong> para evaluar diferencias entre grupos o muestras. Estas pruebas son especialmente útiles en estudios con <strong>muestras pequeñas</strong>, donde la normalidad no puede asumirse con certeza.</p>
<p>Aquí las principales <strong>alternativas no paramétricas</strong> para el análisis de <strong>medias y proporciones</strong>, incluyendo una alternativa para <strong>ANOVA</strong>, que nos permitirá comparar más de dos grupos sin depender de la normalidad de los datos.</p>
<p><strong>1. Medias en una Muestra: Prueba de Wilcoxon Signed-Rank</strong><br>
La prueba de Wilcoxon Signed-Rank se usa como alternativa a la prueba <span class="math inline">\(t\)</span>-test para una muestra cuando no se cumple la normalidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'alturas.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>wilcoxon <span class="ot">=</span> <span class="fu">wilcox.test</span>(muestra<span class="sc">$</span>alturas, </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">mu =</span> <span class="dv">170</span>, </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(wilcoxon)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic p.value method                                           alternative
      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                                            &lt;chr&gt;      
1     30851   0.942 Wilcoxon signed rank test with continuity corre… two.sided  </code></pre>
</div>
</div>
<p><strong>2. Comparación de Medias entre Dos Grupos: Prueba de Mann-Whitney U (Wilcoxon Rank-Sum Test)</strong><br>
La prueba de Mann-Whitney U se usa como alternativa al <span class="math inline">\(t\)</span>-test para muestras independientes cuando no se cumple la normalidad o la homogeneidad de varianzas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>wilcoxon_2 <span class="ot">=</span> <span class="fu">wilcox.test</span>(horas_ocio <span class="sc">~</span> genero, </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> ocio)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(wilcoxon_2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic  p.value method                                          alternative
      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                                           &lt;chr&gt;      
1      8563 2.08e-18 Wilcoxon rank sum test with continuity correct… two.sided  </code></pre>
</div>
</div>
<p><strong>3. Comparación de Medias entre Más de Dos Grupos: Prueba de Kruskal-Wallis</strong><br>
Cuando queremos comparar más de dos grupos y el ANOVA no es adecuado porque la normalidad o la homogeneidad de varianzas no se cumplen, usamos la <strong>prueba de Kruskal-Wallis</strong>. Esta prueba no paramétrica evalúa si hay diferencias significativas en la distribución de los grupos, basándose en rangos en lugar de valores absolutos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>kruskal <span class="ot">=</span> <span class="fu">kruskal.test</span>(nivel_satisfaccion <span class="sc">~</span> sector, <span class="at">data =</span> satisfaccion)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(kruskal)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic    p.value parameter method                      
      &lt;dbl&gt;      &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                       
1      30.1 0.00000478         4 Kruskal-Wallis rank sum test</code></pre>
</div>
</div>
<p>Al igual que el ANOVA, Kruskal-Wallis solo nos dice si hay diferencias entre los grupos, pero no nos indica cuáles son diferentes entre sí. Para ello, realizamos una <strong>comparación post-hoc</strong>, como la <strong>prueba de Dunn</strong>, que es equivalente a la prueba de Tukey en ANOVA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)  <span class="co"># Para la prueba de Dunn</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dunnTest</span>(nivel_satisfaccion <span class="sc">~</span> sector, <span class="at">data =</span> satisfaccion, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Comparison          Z      P.unadj        P.adj
1      Educación - Finanzas  1.2193784 2.227006e-01 1.000000e+00
2   Educación - Manufactura  3.6058333 3.111528e-04 3.111528e-03
3    Finanzas - Manufactura  2.3864549 1.701169e-02 1.701169e-01
4         Educación - Salud -1.5720417 1.159409e-01 1.000000e+00
5          Finanzas - Salud -2.7914201 5.247732e-03 5.247732e-02
6       Manufactura - Salud -5.1778750 2.244275e-07 2.244275e-06
7    Educación - Tecnología -0.1300073 8.965607e-01 1.000000e+00
8     Finanzas - Tecnología -1.3493856 1.772131e-01 1.000000e+00
9  Manufactura - Tecnología -3.7358405 1.870892e-04 1.870892e-03
10       Salud - Tecnología  1.4420344 1.492927e-01 1.000000e+00</code></pre>
</div>
</div>
<p><strong>4. Proporción en una Muestra: Prueba Binomial</strong><br>
Cuando analizamos una proporción en una muestra, la prueba binomial se usa como alternativa al <span class="math inline">\(z\)</span>-test de proporciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>apoyo <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'apoyo.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>binom <span class="ot">=</span> <span class="fu">binom.test</span>(<span class="dv">210</span>, </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>           <span class="dv">350</span>, </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">p =</span> <span class="fl">0.6</span>, </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(binom)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  estimate statistic p.value parameter conf.low conf.high method     alternative
     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
1      0.6       210       1       350    0.547     0.652 Exact bin… two.sided  </code></pre>
</div>
</div>
<p><strong>5. Comparación de Proporciones entre Dos Grupos: Prueba de Fisher o Chi-Cuadrado</strong><br>
Cuando se comparan proporciones en dos grupos, las pruebas de Fisher o Chi-cuadrado son alternativas al <span class="math inline">\(z\)</span>-test de proporciones.</p>
<p>Queremos comparar la proporción de apoyo entre zonas urbanas y rurales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Fisher</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fisher.test</span>(tabla)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  estimate    p.value conf.low conf.high method                      alternative
     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;      
1     2.72 0.00000910     1.71      4.35 Fisher's Exact Test for Co… two.sided  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Chi-cuadrado</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>(tabla)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic   p.value parameter method                                          
      &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                                           
1      19.4 0.0000109         1 Pearson's Chi-squared test with Yates' continui…</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Situación</strong></th>
<th><strong>Prueba Paramétrica</strong></th>
<th><strong>Alternativa No Paramétrica</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Media en una muestra</td>
<td>t-test para una muestra</td>
<td>Wilcoxon Signed-Rank Test</td>
</tr>
<tr class="even">
<td>Medias entre dos grupos</td>
<td>t-test para muestras independientes</td>
<td>Mann-Whitney U (Wilcoxon Rank-Sum)</td>
</tr>
<tr class="odd">
<td>Medias entre más de dos grupos</td>
<td>ANOVA</td>
<td>Kruskal-Wallis Test + Prueba de Dunn</td>
</tr>
<tr class="even">
<td>Proporción en una muestra</td>
<td>z-test de proporciones</td>
<td>Prueba Binomial</td>
</tr>
<tr class="odd">
<td>Proporciones entre grupos</td>
<td>z-test de diferencia de proporciones</td>
<td>Fisher o Chi-Cuadrado</td>
</tr>
</tbody>
</table>
</section>
<section id="remuestreo-e-inferencia-con-el-paquete-infer" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="remuestreo-e-inferencia-con-el-paquete-infer"><span class="header-section-number">7.7</span> Remuestreo e inferencia con el paquete infer</h2>
<p>Hasta ahora, hemos trabajado con pruebas paramétricas como la <strong>prueba t, prueba z o ANOVA</strong>, todas basadas en <strong>distribuciones teóricas</strong> como la normal, t de Student o F. Estas pruebas son herramientas muy útiles y prácticas, pero como ya sabemos, dependen de determinados <strong>supuestos</strong> (normalidad, independencia, tamaño de muestra suficiente). Cuando estos supuestos no se cumplen, sus resultados pueden volverse poco confiables.</p>
<p>Además de las pruebas no paramétricas, ¿existe otra forma de estimar parámetros y evaluar la significancia estadística sin depender de distribuciones teóricas? Sabemos que, gracias al <strong>Teorema del Límite Central (TLC)</strong>, los estadísticos de muestra tienden a seguir ciertas distribuciones, pero ¿qué pasaría si, en lugar de asumirlo, <strong>nosotros mismos generamos esas distribuciones a partir de nuestros datos</strong>? Es decir, en vez de basarnos en modelos teóricos predefinidos, podríamos replicar el proceso de muestreo una y otra vez y observar empíricamente cómo se comportan los estadísticos. <strong>Esto es justamente lo que hacen los métodos basados en simulaciones</strong> .</p>
<p>En lugar de suponer una forma específica para la distribución de los datos, estos métodos generan una <strong>distribución empírica</strong> a partir de los datos observados mediante un proceso conocido como <strong>re-muestreo</strong> <span class="citation" data-cites="cetinkaya2021modern">(<a href="references.html#ref-cetinkaya2021modern" role="doc-biblioref">Çetinkaya-Rundel y Hardin 2021</a>)</span>. En este enfoque, en lugar de confiar en distribuciones teóricas como la normal, generamos un número elevado de muestras simuladas y construimos nuestra propia distribución a partir de los datos. Esto nos permite calcular probabilidades, intervalos de confianza y contrastes de hipótesis sin depender estrictamente de los supuestos. El el paquete <code>infer</code> <span class="citation" data-cites="infer">(<a href="references.html#ref-infer" role="doc-biblioref">Couch et&nbsp;al. 2021</a>)</span> existen 3 diferentes formas de aplicar este enfoque, cada una con una utilidad particular: <strong>bootstrap</strong>, <strong>permutación</strong> y <strong>simulación binomial (draw)</strong>.</p>
<p><strong>Bootstrap: Estimación sin supuestos de normalidad</strong></p>
<p>El <strong>método bootstrap</strong> nos permite estimar la variabilidad de un estadístico de interés (media, mediana, proporción, etc.) a partir de múltiples muestras obtenidas <strong>con reemplazo</strong> de los datos originales. La idea es simple: si nuestra muestra es representativa de la población, podemos usarla para generar nuevas muestras y calcular el estadístico de interés muchas veces, obteniendo así una distribución empírica de sus valores.</p>
<p>El bootstrap es particularmente útil para construir <strong>intervalos de confianza</strong> sin asumir normalidad, lo que lo hace ideal cuando el tamaño muestral es pequeño o cuando la distribución de los datos es desconocida. En términos simples, en lugar de confiar en la teoría para estimar la variabilidad de nuestros datos, usamos los propios datos para generar la información que necesitamos.</p>
<p><strong>Permutación: Pruebas de hipótesis sin distribuciones teóricas</strong></p>
<p>El <strong>método de permutación</strong> se usa en pruebas de hipótesis cuando queremos evaluar si dos grupos son realmente diferentes o si la diferencia observada es producto del azar. Para ello, redistribuimos aleatoriamente los valores observados entre los grupos y calculamos la diferencia esperada en cada reordenamiento. Esto nos permite generar una <strong>distribución nula</strong>, es decir, una distribución de diferencias bajo la suposición de que <strong>no hay efecto real</strong>.</p>
<p>Si la diferencia observada en nuestros datos es mucho mayor que las diferencias obtenidas en las permutaciones aleatorias, entonces podemos concluir que es poco probable que se deba al azar, lo que nos da evidencia para rechazar la hipótesis nula.</p>
<p><strong>Draw: Simulación de pruebas para proporciones</strong></p>
<p>Cuando queremos evaluar hipótesis sobre una proporción, el método <strong>draw</strong> nos permite generar una distribución empírica basada en simulaciones de datos bajo la hipótesis nula. En este caso, en lugar de reorganizar los datos existentes (como en la permutación), generamos nuevos valores aleatorios siguiendo un modelo binomial que representa el escenario nulo.</p>
<p>Para poder relizar todo esot haremos uso del paquete <strong><code>infer</code></strong>. <code>infer</code> son da una seride de herrmientas y metodología que facilita la implementación de estos métodos sin necesidad de escribir código complejo. Nos permite realizar pruebas estadísticas. El análisis con <strong>infer</strong> sigue un proceso estructurado:</p>
<ol type="1">
<li><p><strong>Definición del problema:</strong> Con la función <code>specify()</code>, se <strong>establece qué variable o relación entre variables se analizará</strong>. Esto puede incluir, por ejemplo, la evaluación de una media poblacional (<span class="math inline">\(\mu\)</span>), una proporción (<span class="math inline">\(p\)</span>) o una diferencia entre grupos (<span class="math inline">\(\mu\_1 - \mu\_2\)</span>).</p></li>
<li><p><strong>Planteamiento de la hipótesis nula:</strong> En caso estemos haciendo una prueba de significancia, la función <code>hypothesize()</code> <strong>formaliza la hipótesis nula</strong> (<span class="math inline">\(H_0\)</span>). En el caso de una prueba de una muestra, <span class="math inline">\(H_0\)</span> puede establecer que la media de la población es igual a un valor dado (<span class="math inline">\(H_0: \mu = \mu_0\)</span>). En una prueba de dos grupos, <span class="math inline">\(H_0\)</span> podría declarar que no hay diferencia en las medias entre ellos (<span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>). Este argumento se utiliza si se desea hacer un contraste de hipótesis.</p></li>
<li><p><strong>Simulación de datos bajo (H0):</strong> Con la función <code>generate()</code>, se <strong>generan datos simulados</strong> que reflejan el escenario donde <span class="math inline">\(H_0\)</span> es verdadera. Para pruebas de hipótesis, esto implica generar una distribución nula a través de permutaciones de los datos observados. Para estimación, el bootstrap genera múltiples muestras con reemplazo a partir de los datos originales. Este argumento es el que genera las múltiples muestras.</p></li>
<li><p><strong>Cálculo de la estadística de interés:</strong> Finalmente, la función <code>calculate()</code> e<strong>valúa una estadística específica</strong> (como una media, proporción, diferencia, o estadístico t o z) en las distribuciones simuladas. Esto permite comparar el valor observado en los datos con la distribución nula para calcular un p-valor o construir intervalos de confianza.</p></li>
</ol>
<p>Utilizaremos los ejemplos que llevamos usando estos dos capítulos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="estimación-y-contraste-de-hipótesis-para-una-media" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="estimación-y-contraste-de-hipótesis-para-una-media"><span class="header-section-number">7.7.1</span> Estimación y contraste de hipótesis para una media</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'alturas.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para estimar un <strong>intervalo de confianza del 95%</strong> para la media de la población, utilizamos la técnica de <strong>bootstrap</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>dist_bootstrap_media <span class="ot">=</span> muestra <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> alturas) <span class="sc">%&gt;%</span>       <span class="co"># Definimos la variable de interés</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"bootstrap"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>  <span class="co"># Generamos muestras bootstrap</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"mean"</span>)              <span class="co"># Calculamos la media en cada muestra</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora, obtenemos los <strong>percentiles 2.5% y 97.5%</strong> de la distribución que acabamos de generar usando <code>pull()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>ic_bootstrap <span class="ot">=</span> dist_bootstrap_media <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>),  <span class="co"># Límite inferior (percentil 2.5%)</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)   <span class="co"># Límite superior (percentil 97.5%)</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>ic_lower <span class="ot">=</span> ic_bootstrap <span class="sc">%&gt;%</span> <span class="fu">pull</span>(lower)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>ic_upper <span class="ot">=</span> ic_bootstrap <span class="sc">%&gt;%</span> <span class="fu">pull</span>(upper)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>media_observada <span class="ot">=</span> <span class="fu">mean</span>(muestra<span class="sc">$</span>alturas)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>ic_lower</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5% 
169.3135 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>ic_upper</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   97.5% 
171.2978 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>media_observada</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170.2981</code></pre>
</div>
</div>
<p>El <strong>intervalo de confianza del 95%</strong> obtenido mediante bootstrap es:</p>
<p><span class="math display">\[
IC_{95\%} = [169.28, 171.32]
\]</span></p>
<p>Esto significa que, con un <strong>95% de confianza</strong>, podemos afirmar que la media poblacional <span class="math inline">\(\mu\)</span> se encuentra dentro de este rango.</p>
<p>Lo podemos ver gráficamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar la distribución bootstrap con el IC</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic <span class="ot">=</span> dist_bootstrap_media <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_bootstrap<span class="sc">$</span>lower, </span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_bootstrap<span class="sc">$</span>upper, </span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(muestra<span class="sc">$</span>alturas), </span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución bootstrap de la media"</span>,</span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Líneas rojas: Intervalo de confianza (95%) | Línea verde: Media observada"</span>,</span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Media Bootstrap"</span>,</span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora, queremos investigar si la altura promedio (<span class="math inline">\(\mu\)</span>) de una población es diferente de 170 cm. Bajo la hipótesis nula (<span class="math inline">\(H_0\)</span>), suponemos que la media poblacional es exactamente 170 (<span class="math inline">\(H_0: \mu = 170\)</span>). En <code>infer</code>, seguimos estos pasos:</p>
<p>Generamos la distribución nula</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>dist_nula_media <span class="ot">=</span> muestra <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> alturas) <span class="sc">%&gt;%</span>                  <span class="co"># Definimos la variable de interés</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>, <span class="at">mu =</span> <span class="dv">170</span>) <span class="sc">%&gt;%</span>        <span class="co"># Hipótesis nula: media = 170</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"bootstrap"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>   <span class="co"># Generamos muestras bootstrap</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"mean"</span>)                         <span class="co"># Calculamos la media</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lo podemos ver gráficamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula <span class="ot">=</span> dist_nula_media <span class="sc">%&gt;%</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat, )) <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"lightgray"</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Distribución nula de la media (reps = 10000)'</span>) <span class="sc">+</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>g_dist_nula</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Calcular la media observada</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>media_observada <span class="ot">=</span> <span class="fu">mean</span>(muestra<span class="sc">$</span>alturas)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>media_observada</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170.2981</code></pre>
</div>
</div>
<p>Calcular el p-valor</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>p_valor_media <span class="ot">=</span> dist_nula_media <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat <span class="sc">-</span> <span class="dv">170</span>) <span class="sc">&gt;=</span> <span class="fu">abs</span>(media_observada <span class="sc">-</span> <span class="dv">170</span>))</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>p_valor_media</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1   0.561</code></pre>
</div>
</div>
<p>Visualmente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar la distribución nula con el valor observado</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>g_dist_nula <span class="ot">=</span> dist_nula_media <span class="sc">%&gt;%</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, </span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(muestra<span class="sc">$</span>alturas), </span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">170</span>, </span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución nula de la media"</span>,</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Línea azul: Media esperada bajo H0 (170 cm) | Línea roja: Media observada"</span>,</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Media Bootstrap"</span>,</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>g_dist_nula</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Graficamos la distribución nula con las zonas de rechazo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos los límites de la zona de rechazo</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>zona_rechazo <span class="ot">=</span> dist_nula_media <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>),</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>zona_rechazo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  lower upper
  &lt;dbl&gt; &lt;dbl&gt;
1  169.  171.</code></pre>
</div>
</div>
<p><span class="math display">\[
\text{Zona de Rechazo} = \left[169, 171\right]
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo <span class="ot">=</span> dist_nula_media <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(muestra<span class="sc">$</span>alturas), </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">170</span>, </span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>lower, </span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>upper, </span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución nula con la zona de rechazo"</span>,</span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Líneas púrpuras: Zona de rechazo (IC 95%)|Línea roja: Media observada"</span>,</span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Media Bootstrap"</span>,</span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimación-y-contraste-de-hipótesis-para-una-proporción" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="estimación-y-contraste-de-hipótesis-para-una-proporción"><span class="header-section-number">7.7.2</span> Estimación y contraste de hipótesis para una proporción</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>apoyo <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'apoyo.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Queremos estimar un <strong>intervalo de confianza del 95%</strong> para la proporción de apoyo al <strong>Partido A</strong> en la población. Para ello, utilizamos la técnica de bootstrap, generando múltiples muestras a partir de los datos observados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>dist_bootstrap_prop <span class="ot">=</span> apoyo <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> apoyo, <span class="at">success =</span> <span class="st">"A"</span>) <span class="sc">%&gt;%</span>   <span class="co"># Definimos la variable de interés</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"bootstrap"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>  <span class="co"># Generamos muestras bootstrap</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"prop"</span>)                        <span class="co"># Calculamos la proporción en cada muestra</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Extraemos los datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>ic_bootstrap <span class="ot">=</span> dist_bootstrap_prop <span class="sc">%&gt;%</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>),  <span class="co"># Límite inferior (percentil 2.5%)</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)   <span class="co"># Límite superior (percentil 97.5%)</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>ic_lower <span class="ot">=</span> ic_bootstrap <span class="sc">%&gt;%</span> <span class="fu">pull</span>(lower)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>ic_upper <span class="ot">=</span> ic_bootstrap <span class="sc">%&gt;%</span> <span class="fu">pull</span>(upper)</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>prop_observada <span class="ot">=</span> <span class="fu">mean</span>(apoyo<span class="sc">$</span>apoyo <span class="sc">==</span> <span class="st">"A"</span>)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>ic_lower</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5% 
0.5485714 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>ic_upper</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    97.5% 
0.6514286 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>prop_observada</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
<p><span class="math display">\[
IC_{95\%} = [0.548, 0.651]
\]</span> Visualmente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic_prop <span class="ot">=</span> dist_bootstrap_prop <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, </span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_lower, </span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_upper, </span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> prop_observada, </span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución bootstrap de la proporción"</span>,</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Líneas rojas: Intervalo de confianza (95%) | Línea verde: Proporción observada"</span>,</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proporción Bootstrap"</span>,</span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora, queremos determinar si la proporción de apoyo al partido A (<span class="math inline">\(p\)</span>) es diferente de 50%. Bajo la hipótesis nula (<span class="math inline">\(H_0\)</span>), asumimos que la proporción poblacional es exactamente 0.5 (<span class="math inline">\(H_0: p = 0.5\)</span>). En <code>infer</code>, seguimos estos pasos:</p>
<p>Generamos la distribución nula factorizando la variable apoyo previamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>apoyo<span class="sc">$</span>apoyo <span class="ot">=</span> <span class="fu">factor</span>(apoyo<span class="sc">$</span>apoyo) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Al ser una proporción, generamos la hipoteiss nula usando <code>draw</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>dist_nula_prop <span class="ot">=</span> apoyo <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> apoyo, <span class="at">success =</span> <span class="st">"A"</span>) <span class="sc">%&gt;%</span>    <span class="co"># Definimos la variable de éxito</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>, <span class="at">p =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span>        <span class="co"># Hipótesis nula: proporción = 0.6</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"draw"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>       <span class="co"># Generamos la distribución nula</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"prop"</span>)                        <span class="co"># Calculamos la proporción</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizamos la distribución nula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula_prop <span class="ot">=</span> dist_nula_prop <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución nula de la proporción"</span>,</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Generada mediante simulaciones (reps = 10,000)"</span>,</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proporción Simulada"</span>,</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>g_dist_nula_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Calculamos la proporción observada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>prop_observada <span class="ot">=</span> <span class="fu">mean</span>(apoyo<span class="sc">$</span>apoyo <span class="sc">==</span> <span class="st">"sí"</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>prop_observada</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Calculamos el p-valor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>p_valor_prop <span class="ot">=</span> dist_nula_prop <span class="sc">%&gt;%</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat <span class="sc">-</span> <span class="fl">0.6</span>) <span class="sc">&gt;=</span> <span class="fu">abs</span>(prop_observada <span class="sc">-</span> <span class="fl">0.6</span>))</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>p_valor_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
</div>
</div>
<p>Visualizamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>zona_rechazo <span class="ot">=</span> dist_nula_prop <span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>), </span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>zona_rechazo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  lower upper
  &lt;dbl&gt; &lt;dbl&gt;
1 0.449 0.551</code></pre>
</div>
</div>
<p><span class="math display">\[
\text{Zona de Rechazo} = \left[0.449, 0.554\right]
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo_prop <span class="ot">=</span> dist_nula_prop <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, </span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> prop_observada, </span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>lower, </span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>upper, </span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución Nula con Zona de Rechazo"</span>,</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Líneas púrpuras: Zona de rechazo (IC 95%)|Línea roja: Proporción observada"</span>,</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Proporción Simulada"</span>,</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimación-y-contraste-de-hipótesis-de-medias-entre-dos-grupos" class="level3" data-number="7.7.3">
<h3 data-number="7.7.3" class="anchored" data-anchor-id="estimación-y-contraste-de-hipótesis-de-medias-entre-dos-grupos"><span class="header-section-number">7.7.3</span> Estimación y contraste de hipótesis de medias entre dos grupos</h3>
<p>Queremos estimar un <strong>intervalo de confianza del 95%</strong> para la diferencia de medias en las horas de ocio entre <strong>hombres y mujeres</strong>. Usamos <code>bootstrap</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>dist_bootstrap_dif_media <span class="ot">=</span> ocio <span class="sc">%&gt;%</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(horas_ocio <span class="sc">~</span> genero) <span class="sc">%&gt;%</span>                <span class="co"># Definimos la relación entre variables</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"bootstrap"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>  <span class="co"># Generamos muestras bootstrap</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in means"</span>, </span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"hombre"</span>, <span class="st">"mujer"</span>))  <span class="co"># Calculamos la diferencia en medias</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora, extraemos los <strong>percentiles 2.5% y 97.5%</strong> para construir el intervalo de confianza:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>ic_bootstrap_dif_media <span class="ot">=</span> dist_bootstrap_dif_media <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>),  <span class="co"># Límite inferior</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)   <span class="co"># Límite superior</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>ic_lower <span class="ot">=</span> ic_bootstrap_dif_media <span class="sc">%&gt;%</span> <span class="fu">pull</span>(lower)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>ic_upper <span class="ot">=</span> ic_bootstrap_dif_media <span class="sc">%&gt;%</span> <span class="fu">pull</span>(upper)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>dif_media_observada <span class="ot">=</span> <span class="fu">mean</span>(ocio<span class="sc">$</span>horas_ocio[ocio<span class="sc">$</span>genero <span class="sc">==</span> <span class="st">"hombre"</span>]) <span class="sc">-</span> </span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mean</span>(ocio<span class="sc">$</span>horas_ocio[ocio<span class="sc">$</span>genero <span class="sc">==</span> <span class="st">"mujer"</span>])</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>ic_lower</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2.5% 
2.95086 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>ic_upper</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   97.5% 
4.254522 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>dif_media_observada</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.6</code></pre>
</div>
</div>
<p>El <strong>intervalo de confianza del 95%</strong> obtenido mediante bootstrap es:</p>
<p><span class="math display">\[
IC_{95\%} = [2.94, 4.27]
\]</span></p>
<p>Visualizamos la distribución bootstrap con el intervalo de confianza:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic_dif_media <span class="ot">=</span> dist_bootstrap_dif_media <span class="sc">%&gt;%</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_lower, </span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_upper, </span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> dif_media_observada, </span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución bootstrap de la diferencia de medias"</span>,</span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Líneas rojas: Intervalo de confianza (95%)|Línea verde: Diferencia observada"</span>,</span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diferencia de Medias Bootstrap"</span>,</span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic_dif_media</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora, queremos evaluar si la diferencia de medias observada es lo suficientemente grande como para considerarla <strong>estadísticamente significativa</strong>. Bajo la hipótesis nula (<span class="math inline">\(H_0\)</span>), asumimos que no hay diferencia entre las medias (<span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>). En <code>infer</code>, seguimos estos pasos:</p>
<p>Generamos la <strong>distribución nula</strong> usando <strong>permutaciones</strong>, ya que estamos evaluando la independencia entre las variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>dist_nula_dif_media <span class="ot">=</span> ocio <span class="sc">%&gt;%</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(horas_ocio <span class="sc">~</span> genero) <span class="sc">%&gt;%</span>                <span class="co"># Relación entre variables</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">%&gt;%</span>          <span class="co"># Hipótesis nula: independencia</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"permute"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>    <span class="co"># Generamos permutaciones</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in means"</span>, </span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"hombre"</span>, <span class="st">"mujer"</span>))  <span class="co"># Calculamos la diferencia en medias</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizamos la distribución nula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula_dif_media <span class="ot">=</span> dist_nula_dif_media <span class="sc">%&gt;%</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución Nula de la diferencia de medias"</span>,</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Generada mediante permutaciones (reps = 10,000)"</span>,</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diferencia Simulada"</span>,</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>g_dist_nula_dif_media</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Calculamos la diferencia de medias observada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>dif_media_obs <span class="ot">=</span> <span class="fu">mean</span>(ocio<span class="sc">$</span>horas_ocio[ocio<span class="sc">$</span>genero <span class="sc">==</span> <span class="st">"hombre"</span>]) <span class="sc">-</span> </span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ocio<span class="sc">$</span>horas_ocio[ocio<span class="sc">$</span>genero <span class="sc">==</span> <span class="st">"mujer"</span>])</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>dif_media_obs</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.6</code></pre>
</div>
</div>
<p>Calculamos el p-valor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>p_valor_dif_media <span class="ot">=</span> dist_nula_dif_media <span class="sc">%&gt;%</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat) <span class="sc">&gt;=</span> <span class="fu">abs</span>(dif_media_obs))</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>p_valor_dif_media</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
</div>
</div>
<p>Ahora, definimos la <strong>zona de rechazo</strong>, que representa los valores extremos de la distribución nula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>zona_rechazo <span class="ot">=</span> dist_nula_dif_media <span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>), </span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>zona_rechazo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  lower upper
  &lt;dbl&gt; &lt;dbl&gt;
1 -0.84  0.82</code></pre>
</div>
</div>
<p><span class="math display">\[
\text{Zona de Rechazo} = \left[-0.84, 0.84\right]
\]</span></p>
<p>Finalmente, graficamos la distribución nula con la <strong>zona de rechazo</strong> y la <strong>diferencia observada</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo_dif_media <span class="ot">=</span> dist_nula_dif_media <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> dif_media_obs, </span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>lower, </span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>upper, </span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución Nula con Zona de Rechazo"</span>,</span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Líneas púrpuras: Zona de rechazo (IC 95%) | Línea roja: Diferencia observada"</span>,</span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diferencia Simulada"</span>,</span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo_dif_media</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimación-y-contraste-de-hipótesis-de-proporción-entre-dos-grupos" class="level3" data-number="7.7.4">
<h3 data-number="7.7.4" class="anchored" data-anchor-id="estimación-y-contraste-de-hipótesis-de-proporción-entre-dos-grupos"><span class="header-section-number">7.7.4</span> Estimación y contraste de hipótesis de proporción entre dos grupos</h3>
<p>Queremos estimar un <strong>intervalo de confianza del 95%</strong> para la diferencia de proporciones en el apoyo al <strong>Partido A</strong> entre votantes de zonas urbanas y rurales. Usamos <code>bootstrap</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>dist_bootstrap_dif_prop <span class="ot">=</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(apoyo <span class="sc">~</span> zona, <span class="at">success =</span> <span class="st">"sí"</span>) <span class="sc">%&gt;%</span>       <span class="co"># Definimos la relación entre variables</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"bootstrap"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>  <span class="co"># Generamos muestras bootstrap</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in props"</span>, </span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"urbana"</span>, <span class="st">"rural"</span>))         <span class="co"># Calculamos la diferencia en proporciones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora, extraemos los <strong>percentiles 2.5% y 97.5%</strong> para construir el intervalo de confianza:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>ic_bootstrap_dif_prop <span class="ot">=</span> dist_bootstrap_dif_prop <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>),  <span class="co"># Límite inferior</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)   <span class="co"># Límite superior</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>ic_lower <span class="ot">=</span> ic_bootstrap_dif_prop <span class="sc">%&gt;%</span> <span class="fu">pull</span>(lower)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>ic_upper <span class="ot">=</span> ic_bootstrap_dif_prop <span class="sc">%&gt;%</span> <span class="fu">pull</span>(upper)</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>dif_prop_observada <span class="ot">=</span> <span class="fu">mean</span>(votantes<span class="sc">$</span>apoyo[votantes<span class="sc">$</span>zona <span class="sc">==</span> <span class="st">"urbana"</span>] <span class="sc">==</span> <span class="st">"sí"</span>) <span class="sc">-</span> </span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mean</span>(votantes<span class="sc">$</span>apoyo[votantes<span class="sc">$</span>zona <span class="sc">==</span> <span class="st">"rural"</span>] <span class="sc">==</span> <span class="st">"sí"</span>)</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>ic_lower</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5% 
0.1375324 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>ic_upper</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   97.5% 
0.340112 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>dif_prop_observada</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2383333</code></pre>
</div>
</div>
<p>El <strong>intervalo de confianza del 95%</strong> obtenido mediante bootstrap es:</p>
<p><span class="math display">\[
IC_{95\%} = [0.13, 0.34]
\]</span></p>
<p>Visualizamos la distribución bootstrap con el intervalo de confianza:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic_dif_prop <span class="ot">=</span> dist_bootstrap_dif_prop <span class="sc">%&gt;%</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, </span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_lower, </span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ic_upper, </span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> dif_prop_observada, </span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución bootstrap de la diferencia de proporciones"</span>,</span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Líneas rojas: Intervalo de confianza (95%) | Línea verde: Diferencia observada"</span>,</span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diferencia de Proporciones Bootstrap"</span>,</span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>g_bootstrap_ic_dif_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora, queremos evaluar si la diferencia de proporciones observada es lo suficientemente grande como para considerarla <strong>estadísticamente significativa</strong>. Bajo la hipótesis nula (<span class="math inline">\(H_0\)</span>), asumimos que no hay diferencia entre las proporciones (<span class="math inline">\(H_0: p_1 = p_2\)</span>). En <code>infer</code>, seguimos estos pasos:</p>
<p>Generamos la <strong>distribución nula</strong> usando <strong>permutaciones</strong>, ya que estamos evaluando la independencia entre las variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>dist_nula_dif_prop <span class="ot">=</span> votantes <span class="sc">%&gt;%</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(apoyo <span class="sc">~</span> zona, <span class="at">success =</span> <span class="st">"sí"</span>) <span class="sc">%&gt;%</span>       <span class="co"># Relación entre variables</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">%&gt;%</span>          <span class="co"># Hipótesis nula: independencia</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">type =</span> <span class="st">"permute"</span>, <span class="at">reps =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span>    <span class="co"># Generamos permutaciones</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in props"</span>, </span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"urbana"</span>, <span class="st">"rural"</span>))         <span class="co"># Calculamos la diferencia en proporciones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizamos la distribución nula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula_dif_prop <span class="ot">=</span> dist_nula_dif_prop <span class="sc">%&gt;%</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.015</span>, </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución Nula de la diferencia de proporciones"</span>,</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Generada mediante permutaciones (reps = 10,000)"</span>,</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diferencia Simulada"</span>,</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>g_dist_nula_dif_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Calculamos la diferencia de proporciones observada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>dif_prop_obs <span class="ot">=</span> <span class="fu">mean</span>(votantes<span class="sc">$</span>apoyo[votantes<span class="sc">$</span>zona <span class="sc">==</span> <span class="st">"urbana"</span>] <span class="sc">==</span> <span class="st">"sí"</span>) <span class="sc">-</span> </span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(votantes<span class="sc">$</span>apoyo[votantes<span class="sc">$</span>zona <span class="sc">==</span> <span class="st">"rural"</span>] <span class="sc">==</span> <span class="st">"sí"</span>)</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>dif_prop_obs</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2383333</code></pre>
</div>
</div>
<p>Calculamos el p-valor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>p_valor_dif_prop <span class="ot">=</span> dist_nula_dif_prop <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat) <span class="sc">&gt;=</span> <span class="fu">abs</span>(dif_prop_obs))</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>p_valor_dif_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
</div>
</div>
<p>Ahora, definimos la <strong>zona de rechazo</strong>, que representa los valores extremos de la distribución nula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>zona_rechazo <span class="ot">=</span> dist_nula_dif_prop <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.025</span>), </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">quantile</span>(stat, <span class="fl">0.975</span>)</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>zona_rechazo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  lower  upper
  &lt;dbl&gt;  &lt;dbl&gt;
1  -0.1 0.0983</code></pre>
</div>
</div>
<p><span class="math display">\[
\text{Zona de Rechazo} = \left[-0.1, 0.09\right]
\]</span></p>
<p>Finalmente, graficamos la distribución nula con la <strong>zona de rechazo</strong> y la <strong>diferencia observada</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo_dif_prop <span class="ot">=</span> dist_nula_dif_prop <span class="sc">%&gt;%</span> </span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.015</span>, </span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgray"</span>, </span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> dif_prop_obs, </span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>lower, </span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> zona_rechazo<span class="sc">$</span>upper, </span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución Nula con Zona de Rechazo"</span>,</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Líneas púrpuras: Zona de rechazo (IC 95%) | Línea roja: Diferencia observada"</span>,</span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diferencia Simulada"</span>,</span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-25"><a href="#cb195-25" aria-hidden="true" tabindex="-1"></a>g_dist_nula_rechazo_dif_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comp_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resumen-del-capítulo" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="resumen-del-capítulo"><span class="header-section-number">7.8</span> Resumen del capítulo</h2>
<p>En las ciencias sociales, la comparación entre grupos permite identificar patrones y diferencias en fenómenos de interés. Para ello, se analizan variables cuantitativas (como medias) y cualitativas (como proporciones), siempre considerando si la relación observada es significativa o producto del azar.</p>
<p>Cuando se comparan dos grupos, se diferencian la <strong>variable explicativa</strong> (criterio de clasificación) y la <strong>variable respuesta</strong> (lo que se mide). Dependiendo del tipo de variable respuesta, se aplican distintas herramientas estadísticas.</p>
<p>En el caso de <strong>comparación de medias</strong>, se utilizan intervalos de confianza y pruebas t para evaluar diferencias significativas. La estimación del error estándar permite cuantificar la variabilidad en la diferencia de medias, y el contraste de hipótesis determina si esta diferencia es estadísticamente relevante.</p>
<p>Para <strong>comparaciones de proporciones</strong>, se emplean pruebas z, intervalos de confianza y pruebas de Chi-cuadrado. Se verifica si la distribución de proporciones entre grupos varía de manera significativa, permitiendo determinar si una diferencia observada es real o producto del azar.</p>
<p>Cuando se analizan <strong>grupos relacionados</strong> (como mediciones antes y después en los mismos individuos), se utilizan pruebas pareadas como la <strong>prueba t para muestras dependientes</strong>, que permite evaluar si un cambio dentro del mismo grupo es estadísticamente significativo.</p>
<p>Para <strong>comparaciones entre múltiples grupos</strong>, se aplica <strong>ANOVA</strong>, que analiza si existen diferencias entre tres o más grupos en términos de medias. Si el resultado es significativo, se recurre a pruebas post-hoc como <strong>Tukey</strong> para identificar cuáles grupos difieren. En el caso de variables cualitativas con múltiples categorías, la <strong>prueba de Chi-cuadrado</strong> evalúa la independencia entre dos variables, permitiendo determinar si la distribución de una variable depende de la otra.</p>
<p>Si no se cumplen los supuestos de normalidad o homogeneidad de varianzas, se aplican <strong>pruebas no paramétricas</strong> como <strong>Wilcoxon, Mann-Whitney, Kruskal-Wallis y la prueba de Dunn</strong>, que permiten comparar grupos sin asumir una distribución específica de los datos. Además, los métodos de <strong>remuestreo</strong>, como <strong>bootstrap</strong> y <strong>permutación</strong>, ofrecen alternativas para estimar intervalos de confianza y realizar pruebas de hipótesis sin depender de distribuciones teóricas. Estos métodos, implementados en el paquete <code>infer</code>, permiten obtener resultados estadísticamente robustos en distintos contextos.</p>
</section>
<section id="ejercicios" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="ejercicios"><span class="header-section-number">7.9</span> Ejercicios</h2>
<p><strong>1: Un investigador realiza una prueba</strong> <span class="math inline">\(t\)</span> <strong>de Student para comparar dos grupos y obtiene un valor de</strong> <span class="math inline">\(t = 2.5\)</span>. <strong>Sabiendo que el valor crítico para un nivel de significancia de</strong> <span class="math inline">\(\alpha = 0.05\)</span> <strong>es</strong> <span class="math inline">\(t_\text{crítrico} = 2.0\)</span>, <strong>¿cuál es la conclusión correcta?</strong></p>
<ol type="A">
<li><p>No podemos concluir nada sin conocer los grados de libertad.</p></li>
<li><p>Se acepta la hipótesis nula porque el valor crítico es menor.</p></li>
<li><p>Se rechaza la hipótesis nula porque el valor de ( t ) supera el valor crítico.</p></li>
<li><p>El valor crítico indica que la diferencia entre grupos no es significativa.</p></li>
</ol>
<p><strong>2: Si en una prueba</strong> <span class="math inline">\(Z\)</span> <strong>obtenemos un valor de</strong> <span class="math inline">\(Z = -1.96\)</span> <strong>con un nivel de significancia del</strong> <span class="math inline">\(5\%\)</span>, <strong>¿qué indica este resultado?</strong></p>
<ol type="A">
<li><p>Estamos justo en el límite del rechazo de la hipótesis nula.</p></li>
<li><p>No hay evidencia para rechazar la hipótesis nula.</p></li>
<li><p>El valor <span class="math inline">\(Z\)</span> nos dice que la diferencia es altamente significativa.</p></li>
<li><p>Se debe hacer otra prueba porque el valor <span class="math inline">\(Z\)</span> no es válido.</p></li>
</ol>
<p><strong>3: Flor se ha empeñado en evaluar si existe una diferencia en la puntuación promedio de los estudiantes al utilizar dos métodos de enseñanza distintos. Su objetivo es determinar si uno de los métodos conduce a un mejor o peor desempeño académico en comparación con el otro. Para ello, debe establecer correctamente la hipótesis nula y la hipótesis alternativa. Recordemos que la hipótesis nula representa la ausencia de diferencia entre las medias poblacionales, mientras que la hipótesis alternativa indica que sí hay una diferencia significativa. ¿Cuál de las siguientes opciones es la correcta?</strong></p>
<ol type="A">
<li><p>La hipótesis nula establece que hay una diferencia entre los métodos, mientras que la hipótesis alternativa afirma que no hay diferencia.<br>
<span class="math inline">\(H_0: \mu_1 \neq \mu_2\)</span> y <span class="math inline">\(H_a: \mu_1 = \mu_2\)</span></p></li>
<li><p>La hipótesis nula indica que no hay diferencia en la puntuación promedio entre ambos métodos, mientras que la hipótesis alternativa sostiene que sí existe una diferencia. <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span> y <span class="math inline">\(H_a: \mu_1 \neq \mu_2\)</span></p></li>
<li><p>La hipótesis nula y la alternativa se formulan en términos de medias muestrales en lugar de medias poblacionales. <span class="math inline">\(H_0: \bar{X}_1 = \bar{X}_2\)</span> y <span class="math inline">\(H_a: \bar{X}_1 \neq \bar{X}_2\)</span></p></li>
<li><p>La hipótesis nula afirma que el primer método es mejor que el segundo, mientras que la hipótesis alternativa establece que el segundo método es superior al primero.<br>
<span class="math inline">\(H_0: \mu_1 &gt; \mu_2\)</span> y <span class="math inline">\(H_a: \mu_1 &lt; \mu_2\)</span></p></li>
</ol>
<p><strong>4.Se quiere quiere comparar las medias de dos grupos diferentes con distribución normal y varianzas desconocidas. ¿Qué prueba se debería usar?</strong><br>
A. ANOVA</p>
<p>B. Prueba de Chi-cuadrado.<br>
C. Prueba Z para dos proporciones.<br>
D. Prueba t para muestras independientes.</p>
<p><strong>5: Flor está investigando si el nivel de confianza en el gobierno varía según el grupo etario de la población. Para ello, realiza una encuesta donde clasifica la confianza en tres niveles (alta, media, baja) y agrupa a los encuestados en tres rangos de edad (jóvenes, adultos y adultos mayores). ¿Qué prueba estadística es la más adecuada para analizar si existe una relación entre estas variables?</strong></p>
<ol type="A">
<li><p>Prueba de Chi-cuadrado.</p></li>
<li><p>Prueba <span class="math inline">\(t\)</span> de muestras emparejadas.</p></li>
<li><p>ANOVA de un solo factor.</p></li>
<li><p>Prueba <span class="math inline">\(Z\)</span> para una muestra.</p></li>
</ol>
<p><strong>6: Un economista quiere analizar si la reciente reforma laboral ha afectado la cantidad promedio de horas trabajadas por semana en tres sectores: industria, comercio y servicios. Para ello, recopila datos de registros laborales en empresas de cada sector y desea determinar si existen diferencias significativas en la cantidad de horas trabajadas entre los grupos. ¿Qué prueba estadística es la más adecuada para este análisis?</strong></p>
<ol type="A">
<li><p>Prueba <span class="math inline">\(t\)</span> de Student.</p></li>
<li><p>ANOVA.</p></li>
<li><p>Prueba de Chi-cuadrado.</p></li>
<li><p>Prueba de McNemar.</p></li>
</ol>
<p><strong>7: Un investigador en psicología quiere evaluar el impacto de una terapia en los niveles de ansiedad de un grupo de pacientes. Para ello, mide la ansiedad de cada paciente antes y después del tratamiento ¿Qué prueba estadística es la más adecuada para este análisis?</strong></p>
<ol type="A">
<li><p>Prueba <span class="math inline">\(t\)</span> de muestras emparejadas.</p></li>
<li><p>Prueba de Wilcoxon.</p></li>
<li><p>Prueba de Chi-cuadrado.</p></li>
<li><p>Prueba de McNemar.</p></li>
</ol>
<p><strong>8.Si se quiere evaluar si la distribución de una variable en dos muestras independientes no normales es diferente, ¿qué prueba es la más adecuada?</strong></p>
<p>A) Prueba Z para dos muestras.</p>
<p>B) Prueba t de Student.<br>
C) Prueba U de Mann-Whitney.</p>
<p>D) Prueba de Chi-cuadrado.</p>
<p><strong>9.¿Cuál es el supuesto de homogeneidad de varianzas en una prueba t o ANOVA?</strong><br>
</p>
<p>A) Que la media de los grupos sea la misma.</p>
<p>B) Que las varianzas de los grupos sean iguales.</p>
<p>C) Que la distribución de los datos sea normal en todos los casos.</p>
<p>D) Que siempre se rechace la hipótesis nula.</p>
<p><strong>10. ¿Cuál es la principal ventaja de los métodos de permutación y bootstrapping en inferencia estadística?</strong></p>
<ol type="A">
<li>Permiten estimar distribuciones sin asumir normalidad.**<br>
</li>
<li>Solo se pueden aplicar en estudios con más de 1000 observaciones.<br>
</li>
<li>Siempre proporcionan valores p más pequeños que las pruebas paramétricas.<br>
</li>
<li>No dependen de los datos originales, solo de los intervalos de confianza.</li>
</ol>
<p><strong>11: Para estimar la diferencia entre dos medias poblacionales con un intervalo de confianza, recordemos que un intervalo se construye tomando la estimación puntual más un margen de error. ¿Cuál de las siguientes expresiones es la correcta?</strong></p>
<ol type="A">
<li><p><span class="math inline">\(\Delta \hat{p} \pm z \times \sqrt{\frac{\hat{p}_1 (1 - \hat{p}_1)}{n_1} + \frac{\hat{p}_2 (1 - \hat{p}_2)}{n_2}}\)</span></p></li>
<li><p><span class="math inline">\(\frac{s}{\sqrt{n}}\)</span></p></li>
<li><p><span class="math inline">\(\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\)</span></p></li>
<li><p><span class="math inline">\(\Delta \bar{X} \pm t \times \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\)</span></p></li>
</ol>
<p><strong>12: Un investigador quiere analizar si existe una diferencia en el rendimiento académico entre estudiantes que asisten a clases presenciales y aquellos que estudian de manera virtual. Para ello, aplica una prueba</strong> <span class="math inline">\(t\)</span> <strong>para comparar las medias de ambos grupos y obtiene un valor</strong> <span class="math inline">\(p = 0.03\)</span>. <strong>Si ha establecido un nivel de significancia de</strong> <span class="math inline">\(\alpha = 0.05\)</span>, <strong>¿cuál es la interpretación correcta de este resultado?</strong></p>
<ol type="A">
<li><p>Se rechaza la hipótesis nula, lo que sugiere que hay evidencia suficiente para afirmar una diferencia entre los grupos.</p></li>
<li><p>No se rechaza la hipótesis nula, ya que el valor <span class="math inline">\(p\)</span> es menor que <span class="math inline">\(0.05\)</span>.</p></li>
<li><p>Se concluye que la diferencia entre grupos es exactamente <span class="math inline">\(3\%\)</span>.</p></li>
<li><p>Este resultado indica una diferencia estadísticamente significativa, pero no necesariamente una diferencia de gran magnitud.</p></li>
</ol>
<p><strong>13: Un grupo de nutricionistas está evaluando el impacto de una nueva dieta en la pérdida de peso. Para ello, miden el peso de un grupo de participantes antes de iniciar la dieta y nuevamente después de cuatro semanas siguiendo el plan alimenticio. Si el objetivo es determinar si hubo un cambio significativo en el peso promedio tras el tratamiento, ¿qué prueba estadística es la más adecuada?</strong></p>
<ol type="A">
<li><p>Prueba <span class="math inline">\(t\)</span> para muestras independientes.</p></li>
<li><p>Prueba <span class="math inline">\(t\)</span> para muestras relacionadas (pareadas).</p></li>
<li><p>Prueba de Chi-cuadrado.</p></li>
<li><p>ANOVA de un factor.</p></li>
</ol>
<p><strong>14: Un estudio analiza la proporción de personas que aprueban una política pública en dos regiones distintas. Se obtiene un intervalo de confianza del 95% para la diferencia de proporciones que va de -0.02 a 0.10. ¿Cuál es la interpretación correcta?</strong><br>
A) No hay evidencia concluyente de que la proporción de aprobación difiera entre las regiones.<br>
B) Hay evidencia de que una región tiene mayor aprobación que la otra.<br>
C) Se debe rechazar la hipótesis nula porque el intervalo incluye valores positivos.<br>
D) Se debe realizar una prueba ANOVA para confirmar el resultado.</p>
<p><strong>15: Un estudio analiza la relación entre nivel educativo (primaria, secundaria y universitaria) y la preferencia por un candidato político. ¿Qué prueba estadística es más adecuada para evaluar la asociación entre estas variables?</strong><br>
</p>
<p>A) Prueba t de Student.<br>
B) Prueba de correlación de Pearson.</p>
<p>C) ANOVA de un factor.</p>
<p>D) Prueba de chi-cuadrado.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-cetinkaya2021modern" class="csl-entry" role="listitem">
Çetinkaya-Rundel, Mine, y Joanna Hardin. 2021. <em>Introduction to Modern Statistics</em>.
</div>
<div id="ref-infer" class="csl-entry" role="listitem">
Couch, Simon P., Andrew P. Bray, Chester Ismay, Evgeni Chasnovski, Benjamin S. Baumer, y Mine Çetinkaya-Rundel. 2021. <span>«<span></span>infer<span></span>: An <span></span>R<span></span> package for tidyverse-friendly statistical inference»</span> 6: 3661. <a href="https://doi.org/10.21105/joss.03661">https://doi.org/10.21105/joss.03661</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<button id="toc-toggle-btn" aria-label="Abrir contenido">Contenido ▤</button>
<script>
  (function () {
    const btn = document.getElementById('toc-toggle-btn');
    if (!btn) return;
    btn.addEventListener('click', function () {
      document.body.classList.toggle('toc-open');
    });
    // Cierra el drawer al tocar fuera del panel (móviles)
    document.addEventListener('click', function (e) {
      const panel = document.getElementById('quarto-margin-sidebar');
      if (!panel) return;
      const clickedInside = panel.contains(e.target) || btn.contains(e.target);
      if (!clickedInside && document.body.classList.contains('toc-open')) {
        document.body.classList.remove('toc-open');
      }
    });
  })();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./inf.html" class="pagination-link" aria-label="Estadística inferencial">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estadística inferencial</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./regr.html" class="pagination-link" aria-label="Regresión">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regresión</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>